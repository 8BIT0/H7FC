ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"Srv_Upgrade.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.SrvUpgrade_SetFileInfo,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	SrvUpgrade_SetFileInfo:
  26              	.LFB153:
  27              		.file 1 "Service/Srv_Upgrade.c"
   1:Service/Srv_Upgrade.c **** /*
   2:Service/Srv_Upgrade.c ****  *  Auther: 8_B!T0
   3:Service/Srv_Upgrade.c ****  *  Noticed: this file use to upgrade App / Bootloader / Module Firmware 
   4:Service/Srv_Upgrade.c ****  *  When at bootloader use this file can upgrade App and Module Firmware
   5:Service/Srv_Upgrade.c ****  *  When at app use this file can upgrade Bootloader and Module Firmware
   6:Service/Srv_Upgrade.c ****  *  
   7:Service/Srv_Upgrade.c ****  *                      F ------- Y ------ I
   8:Service/Srv_Upgrade.c ****  *                      still in developping
   9:Service/Srv_Upgrade.c ****  */
  10:Service/Srv_Upgrade.c **** #include "Srv_Upgrade.h"
  11:Service/Srv_Upgrade.c **** #include "util.h"
  12:Service/Srv_Upgrade.c **** #include "../System/storage/Storage.h"
  13:Service/Srv_Upgrade.c **** #include "Bsp_Flash.h"
  14:Service/Srv_Upgrade.c **** #include "Srv_FileAdapter.h"
  15:Service/Srv_Upgrade.c **** #include "shell_port.h"
  16:Service/Srv_Upgrade.c **** #include "HW_Def.h"
  17:Service/Srv_Upgrade.c **** #include "debug_util.h"
  18:Service/Srv_Upgrade.c **** 
  19:Service/Srv_Upgrade.c **** #define FIRMWARE_WAITTING_TIMEOUT   60000   /* unit: ms */
  20:Service/Srv_Upgrade.c **** #define FIRMWARE_COMMU_TIMEOUT      1000    /* unit: ms */
  21:Service/Srv_Upgrade.c **** #define DEFAULT_WINDOW_SIZE         100     /* unit: ms */
  22:Service/Srv_Upgrade.c **** 
  23:Service/Srv_Upgrade.c **** const uint8_t AppVer[3] = {0, 0, 17};
  24:Service/Srv_Upgrade.c **** #if defined MATEKH743_V1_5
  25:Service/Srv_Upgrade.c **** const uint8_t HWVer[3] = {0, 0, 1};
  26:Service/Srv_Upgrade.c **** #elif defined BATEAT32F435_AIO
  27:Service/Srv_Upgrade.c **** const uint8_t HWVer[3] = {0, 0, 2};
  28:Service/Srv_Upgrade.c **** #elif defined CCRC_AT32_20
  29:Service/Srv_Upgrade.c **** const uint8_t HWVer[3] = {0, 0, 3};
  30:Service/Srv_Upgrade.c **** #endif
  31:Service/Srv_Upgrade.c **** 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 2


  32:Service/Srv_Upgrade.c **** #define AppBref "First Version of H7FC"
  33:Service/Srv_Upgrade.c **** #define AppCompileData __DATA__
  34:Service/Srv_Upgrade.c **** #define FIRMWARE_MAX_READ_SIZE (4 Kb)
  35:Service/Srv_Upgrade.c **** 
  36:Service/Srv_Upgrade.c **** #define UpgradeInfo_Sec  "Upgrade_Info"
  37:Service/Srv_Upgrade.c **** 
  38:Service/Srv_Upgrade.c **** #define UPGERADE_INFO(fmt,...) Debug_Print(&DebugPort, "[ UPGRADE INFO ] ", fmt, ##__VA_ARGS__)
  39:Service/Srv_Upgrade.c **** 
  40:Service/Srv_Upgrade.c **** typedef void (*Application_Func)(void);
  41:Service/Srv_Upgrade.c **** 
  42:Service/Srv_Upgrade.c **** static uint8_t upgrade_buf[FIRMWARE_MAX_READ_SIZE] = {0};
  43:Service/Srv_Upgrade.c **** 
  44:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Write_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
  45:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
  46:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
  47:Service/Srv_Upgrade.c **** 
  48:Service/Srv_Upgrade.c **** typedef enum
  49:Service/Srv_Upgrade.c **** {
  50:Service/Srv_Upgrade.c ****     UpgradeParam_None = 0,
  51:Service/Srv_Upgrade.c ****     UpgradeParam_InValid,
  52:Service/Srv_Upgrade.c ****     UpgradeParam_Valid,
  53:Service/Srv_Upgrade.c **** } SrvUpgrade_ParamValid_List;
  54:Service/Srv_Upgrade.c **** 
  55:Service/Srv_Upgrade.c **** typedef struct
  56:Service/Srv_Upgrade.c **** {
  57:Service/Srv_Upgrade.c ****     bool access;
  58:Service/Srv_Upgrade.c ****     uint16_t size;
  59:Service/Srv_Upgrade.c ****     uint16_t total_size;
  60:Service/Srv_Upgrade.c ****     uint8_t *p_buf;
  61:Service/Srv_Upgrade.c **** } SrvUpgrade_Stream_TypeDef;
  62:Service/Srv_Upgrade.c **** 
  63:Service/Srv_Upgrade.c **** typedef struct
  64:Service/Srv_Upgrade.c **** {
  65:Service/Srv_Upgrade.c ****     bool init_state;
  66:Service/Srv_Upgrade.c **** 
  67:Service/Srv_Upgrade.c ****     SrvUpgrade_Stage_List PollingState;
  68:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List PortDataState;
  69:Service/Srv_Upgrade.c **** 
  70:Service/Srv_Upgrade.c ****     uint32_t discard_time;
  71:Service/Srv_Upgrade.c **** 
  72:Service/Srv_Upgrade.c ****     uint32_t rec_timeout;
  73:Service/Srv_Upgrade.c ****     uint32_t rec_time;
  74:Service/Srv_Upgrade.c ****     
  75:Service/Srv_Upgrade.c ****     Storage_ItemSearchOut_TypeDef UpgradeInfo_SO;
  76:Service/Srv_Upgrade.c ****     
  77:Service/Srv_Upgrade.c ****     SrvFileAdapterObj_TypeDef *adapter_obj;
  78:Service/Srv_Upgrade.c ****     bool info_update;
  79:Service/Srv_Upgrade.c ****     FileInfo_TypeDef FileInfo;
  80:Service/Srv_Upgrade.c **** 
  81:Service/Srv_Upgrade.c ****     SrvUpgrade_Stream_TypeDef proc_stream[2];
  82:Service/Srv_Upgrade.c **** 
  83:Service/Srv_Upgrade.c ****     uint8_t LogOut_Info[1024];
  84:Service/Srv_Upgrade.c ****     uint16_t LogOut_Info_size;
  85:Service/Srv_Upgrade.c **** } SrvUpgradeMonitor_TypeDef;
  86:Service/Srv_Upgrade.c **** 
  87:Service/Srv_Upgrade.c **** typedef struct
  88:Service/Srv_Upgrade.c **** {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 3


  89:Service/Srv_Upgrade.c ****     uint32_t read_addr;
  90:Service/Srv_Upgrade.c ****     uint32_t read_size;
  91:Service/Srv_Upgrade.c **** 
  92:Service/Srv_Upgrade.c ****     uint32_t write_addr;
  93:Service/Srv_Upgrade.c ****     uint32_t write_size;
  94:Service/Srv_Upgrade.c **** 
  95:Service/Srv_Upgrade.c ****     uint32_t remain_size;
  96:Service/Srv_Upgrade.c **** } FlashMonitor_TypeDef;
  97:Service/Srv_Upgrade.c **** 
  98:Service/Srv_Upgrade.c **** /* internal virable */
  99:Service/Srv_Upgrade.c **** static SrvUpgradeMonitor_TypeDef Monitor = {
 100:Service/Srv_Upgrade.c ****     .init_state = false,
 101:Service/Srv_Upgrade.c **** };
 102:Service/Srv_Upgrade.c **** 
 103:Service/Srv_Upgrade.c **** /* internal function */
 104:Service/Srv_Upgrade.c **** static void SrvUpgrade_Collect_Info(const char *format, ...);
 105:Service/Srv_Upgrade.c **** static void SrvUpgrade_CheckUpgrade_OnBootUp(void);
 106:Service/Srv_Upgrade.c **** 
 107:Service/Srv_Upgrade.c **** /* external function */
 108:Service/Srv_Upgrade.c **** static bool SrvUpgrade_Init(void);
 109:Service/Srv_Upgrade.c **** static SrvUpgrade_Stage_List SrvUpgrade_StatePolling(uint32_t sys_time, SrvFileAdapter_Send_Func se
 110:Service/Srv_Upgrade.c **** static uint16_t SrvUpgrade_Get_Info(uint8_t *p_info, uint16_t len);
 111:Service/Srv_Upgrade.c **** static void SrvUpgrade_ClearLog(void);
 112:Service/Srv_Upgrade.c **** static bool SrvUpgrade_PushData(uint32_t sys_time, uint8_t *p_buf, uint16_t len);
 113:Service/Srv_Upgrade.c **** static void SrvUpgrade_SetFileInfo(const FileInfo_TypeDef info);
 114:Service/Srv_Upgrade.c **** 
 115:Service/Srv_Upgrade.c **** /* external function */
 116:Service/Srv_Upgrade.c **** SrvUpgrade_TypeDef SrvUpgrade = {
 117:Service/Srv_Upgrade.c ****     .init = SrvUpgrade_Init,
 118:Service/Srv_Upgrade.c ****     .polling = SrvUpgrade_StatePolling,
 119:Service/Srv_Upgrade.c ****     .get_log = SrvUpgrade_Get_Info,
 120:Service/Srv_Upgrade.c ****     .clear_log = SrvUpgrade_ClearLog,
 121:Service/Srv_Upgrade.c ****     .push_data = SrvUpgrade_PushData,
 122:Service/Srv_Upgrade.c ****     .set_fileinfo = SrvUpgrade_SetFileInfo,
 123:Service/Srv_Upgrade.c **** };
 124:Service/Srv_Upgrade.c **** 
 125:Service/Srv_Upgrade.c **** static bool SrvUpgrade_Init(void)
 126:Service/Srv_Upgrade.c **** {
 127:Service/Srv_Upgrade.c ****     if (sizeof(upgrade_buf) % 2)
 128:Service/Srv_Upgrade.c ****         return false;
 129:Service/Srv_Upgrade.c **** 
 130:Service/Srv_Upgrade.c ****     /* reset file info */
 131:Service/Srv_Upgrade.c ****     Monitor.info_update = false;
 132:Service/Srv_Upgrade.c ****     memset(&Monitor.FileInfo, 0, sizeof(Monitor.FileInfo));
 133:Service/Srv_Upgrade.c **** 
 134:Service/Srv_Upgrade.c ****     /* get data from storage */
 135:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 136:Service/Srv_Upgrade.c **** 
 137:Service/Srv_Upgrade.c ****     memset(Monitor.LogOut_Info, 0, sizeof(Monitor.LogOut_Info));
 138:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 139:Service/Srv_Upgrade.c ****     
 140:Service/Srv_Upgrade.c ****     /* set stream */
 141:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].access = false;
 142:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].size = 0;
 143:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].total_size = sizeof(upgrade_buf) / 2;
 144:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].p_buf = upgrade_buf;
 145:Service/Srv_Upgrade.c **** 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 4


 146:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].access = false;
 147:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].size = 0;
 148:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].total_size = sizeof(upgrade_buf) / 2;
 149:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].p_buf = &upgrade_buf[sizeof(upgrade_buf) / 2];
 150:Service/Srv_Upgrade.c **** 
 151:Service/Srv_Upgrade.c ****     Monitor.init_state = true;
 152:Service/Srv_Upgrade.c ****     Monitor.PollingState = Stage_Init;
 153:Service/Srv_Upgrade.c ****     Monitor.PortDataState = PortProc_None;
 154:Service/Srv_Upgrade.c ****     
 155:Service/Srv_Upgrade.c ****     /* 
 156:Service/Srv_Upgrade.c ****      * whatever on boot or app
 157:Service/Srv_Upgrade.c ****      * check upgrade on boot up
 158:Service/Srv_Upgrade.c ****      */
 159:Service/Srv_Upgrade.c ****     SrvUpgrade_CheckUpgrade_OnBootUp();
 160:Service/Srv_Upgrade.c ****     return true;
 161:Service/Srv_Upgrade.c **** }
 162:Service/Srv_Upgrade.c **** 
 163:Service/Srv_Upgrade.c **** static void SrvUpgrade_CheckUpgrade_OnBootUp(void)
 164:Service/Srv_Upgrade.c **** {
 165:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 166:Service/Srv_Upgrade.c ****     uint32_t file_size = 0;
 167:Service/Srv_Upgrade.c ****     uint16_t update_size = 0;
 168:Service/Srv_Upgrade.c ****     uint32_t addr_offset = 0;
 169:Service/Srv_Upgrade.c **** 
 170:Service/Srv_Upgrade.c ****     memset(&Monitor.UpgradeInfo_SO, 0, sizeof(Monitor.UpgradeInfo_SO));
 171:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 172:Service/Srv_Upgrade.c **** 
 173:Service/Srv_Upgrade.c ****     /* check upgrade enable control first */
 174:Service/Srv_Upgrade.c ****     Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 175:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 176:Service/Srv_Upgrade.c ****     {
 177:Service/Srv_Upgrade.c ****         Storage.get(Para_Boot, Monitor.UpgradeInfo_SO.item, (uint8_t *)(&Info), sizeof(SrvUpgradeIn
 178:Service/Srv_Upgrade.c **** 
 179:Service/Srv_Upgrade.c ****         /* read parameter section */
 180:Service/Srv_Upgrade.c ****         /* read boot firmware info */
 181:Service/Srv_Upgrade.c ****         if (Info.CTLReg.bit.Boot)
 182:Service/Srv_Upgrade.c ****         {
 183:Service/Srv_Upgrade.c ****             /* check hardware version */
 184:Service/Srv_Upgrade.c ****             if (memcmp(Info.BF_Info.HW_Ver, HWVer, sizeof(HWVer)) == 0)
 185:Service/Srv_Upgrade.c ****             {
 186:Service/Srv_Upgrade.c ****                 /* check boot upgrade */
 187:Service/Srv_Upgrade.c ****                 file_size = Info.BF_Info.File_Size;
 188:Service/Srv_Upgrade.c ****             }
 189:Service/Srv_Upgrade.c ****         }
 190:Service/Srv_Upgrade.c ****         
 191:Service/Srv_Upgrade.c ****         while (file_size)
 192:Service/Srv_Upgrade.c ****         {
 193:Service/Srv_Upgrade.c ****             update_size = file_size;
 194:Service/Srv_Upgrade.c ****             if (file_size > 1024)
 195:Service/Srv_Upgrade.c ****                 update_size = 1024;
 196:Service/Srv_Upgrade.c **** 
 197:Service/Srv_Upgrade.c ****             /* read firmware from storage */
 198:Service/Srv_Upgrade.c ****             memset(upgrade_buf, 0, update_size);
 199:Service/Srv_Upgrade.c ****             Storage.read_firmware(Firmware_Boot, addr_offset, upgrade_buf, update_size);
 200:Service/Srv_Upgrade.c **** 
 201:Service/Srv_Upgrade.c ****             SrvOsCommon.enter_critical();
 202:Service/Srv_Upgrade.c ****             /* write firmware to boot flash */
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 5


 203:Service/Srv_Upgrade.c ****             Storage.write_firmware(Internal_Flash, Firmware_Boot, addr_offset, upgrade_buf, update_
 204:Service/Srv_Upgrade.c ****             SrvOsCommon.exit_critical();
 205:Service/Srv_Upgrade.c **** 
 206:Service/Srv_Upgrade.c ****             file_size -= update_size;
 207:Service/Srv_Upgrade.c ****             addr_offset += update_size;
 208:Service/Srv_Upgrade.c **** 
 209:Service/Srv_Upgrade.c ****             if (file_size == 0)
 210:Service/Srv_Upgrade.c ****             {
 211:Service/Srv_Upgrade.c ****                 /* clear upgrade flag */
 212:Service/Srv_Upgrade.c ****                 Info.CTLReg.bit.Boot = false;
 213:Service/Srv_Upgrade.c ****                 Storage.update(Para_Boot, Monitor.UpgradeInfo_SO.item.data_addr, (uint8_t *)(&Info)
 214:Service/Srv_Upgrade.c ****             }
 215:Service/Srv_Upgrade.c ****         }
 216:Service/Srv_Upgrade.c ****     }
 217:Service/Srv_Upgrade.c ****     else
 218:Service/Srv_Upgrade.c ****     {
 219:Service/Srv_Upgrade.c ****         memcpy(Info.AF_Info.HW_Ver, HWVer, sizeof(Info.AF_Info.HW_Ver));
 220:Service/Srv_Upgrade.c ****         memcpy(Info.BF_Info.HW_Ver, HWVer, sizeof(Info.AF_Info.HW_Ver));
 221:Service/Srv_Upgrade.c ****         Storage.create(Para_Boot, UpgradeInfo_Sec, (uint8_t *)(&Info), sizeof(SrvUpgradeInfo_TypeDe
 222:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 223:Service/Srv_Upgrade.c ****     }
 224:Service/Srv_Upgrade.c **** 
 225:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr == 0)
 226:Service/Srv_Upgrade.c ****     {
 227:Service/Srv_Upgrade.c ****         Monitor.init_state = false;
 228:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_UpgradeInfo_Error;
 229:Service/Srv_Upgrade.c ****     }
 230:Service/Srv_Upgrade.c **** }
 231:Service/Srv_Upgrade.c **** 
 232:Service/Srv_Upgrade.c **** static SrvUpgrade_PortDataProc_List SrvUpgrade_PortProcPolling(uint32_t sys_time)
 233:Service/Srv_Upgrade.c **** {
 234:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List ret;
 235:Service/Srv_Upgrade.c ****     Adapter_Polling_State adapter_state; 
 236:Service/Srv_Upgrade.c **** 
 237:Service/Srv_Upgrade.c ****     if (Monitor.adapter_obj == NULL)
 238:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 239:Service/Srv_Upgrade.c **** 
 240:Service/Srv_Upgrade.c ****     for (uint8_t i = 0; i < 2; i ++)
 241:Service/Srv_Upgrade.c ****     {
 242:Service/Srv_Upgrade.c ****         if (!Monitor.proc_stream[i].access && Monitor.proc_stream[i].size)
 243:Service/Srv_Upgrade.c ****         {
 244:Service/Srv_Upgrade.c ****             Monitor.proc_stream[i].access = true;
 245:Service/Srv_Upgrade.c **** 
 246:Service/Srv_Upgrade.c ****             if (SrvFileAdapter.push_to_stream(Monitor.proc_stream[i].p_buf, Monitor.proc_stream[i].
 247:Service/Srv_Upgrade.c ****             {
 248:Service/Srv_Upgrade.c ****                 memset(Monitor.proc_stream[i].p_buf, 0, Monitor.proc_stream[i].size);
 249:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 250:Service/Srv_Upgrade.c ****             }
 251:Service/Srv_Upgrade.c **** 
 252:Service/Srv_Upgrade.c ****             Monitor.proc_stream[i].access = false;
 253:Service/Srv_Upgrade.c ****         }
 254:Service/Srv_Upgrade.c ****     }
 255:Service/Srv_Upgrade.c ****     
 256:Service/Srv_Upgrade.c ****     switch((uint8_t) Monitor.PortDataState)
 257:Service/Srv_Upgrade.c ****     {
 258:Service/Srv_Upgrade.c ****         case PortProc_None:
 259:Service/Srv_Upgrade.c ****             Monitor.rec_timeout = sys_time + FIRMWARE_COMMU_TIMEOUT;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 6


 260:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 261:Service/Srv_Upgrade.c ****             Monitor.PortDataState = PortProc_Deal_Pack;
 262:Service/Srv_Upgrade.c ****             adapter_state = SrvFileAdapter.polling(sys_time, Monitor.adapter_obj);
 263:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 264:Service/Srv_Upgrade.c ****             
 265:Service/Srv_Upgrade.c ****             /* check adapter state */
 266:Service/Srv_Upgrade.c ****             switch ((uint8_t)adapter_state)
 267:Service/Srv_Upgrade.c ****             {
 268:Service/Srv_Upgrade.c ****                 case Adapter_Proc_Done: ret = ProtProc_Finish; break;
 269:Service/Srv_Upgrade.c ****                 case Adapter_Proc_Failed: ret = PortProc_Deal_Error; break;
 270:Service/Srv_Upgrade.c ****                 default: break;
 271:Service/Srv_Upgrade.c ****             }
 272:Service/Srv_Upgrade.c ****             break;
 273:Service/Srv_Upgrade.c **** 
 274:Service/Srv_Upgrade.c ****         case PortProc_Deal_Error:
 275:Service/Srv_Upgrade.c ****             Monitor.PortDataState = PortProc_None;
 276:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Error;
 277:Service/Srv_Upgrade.c ****             break;
 278:Service/Srv_Upgrade.c **** 
 279:Service/Srv_Upgrade.c ****         default:
 280:Service/Srv_Upgrade.c ****             ret = PortProc_Unknown;
 281:Service/Srv_Upgrade.c ****             break;
 282:Service/Srv_Upgrade.c ****     }
 283:Service/Srv_Upgrade.c **** 
 284:Service/Srv_Upgrade.c ****     /* check for time out */
 285:Service/Srv_Upgrade.c ****     if ((ret != ProtProc_Finish) && (sys_time >= Monitor.rec_timeout))
 286:Service/Srv_Upgrade.c ****     {
 287:Service/Srv_Upgrade.c ****         Monitor.info_update = false;
 288:Service/Srv_Upgrade.c ****         Monitor.PortDataState = PortProc_None;
 289:Service/Srv_Upgrade.c ****         ret = PortProc_Deal_TimeOut;
 290:Service/Srv_Upgrade.c ****     }
 291:Service/Srv_Upgrade.c **** 
 292:Service/Srv_Upgrade.c ****     return ret;
 293:Service/Srv_Upgrade.c **** }
 294:Service/Srv_Upgrade.c **** 
 295:Service/Srv_Upgrade.c **** static SrvUpgrade_Stage_List SrvUpgrade_On_PortProc_Finish(void)
 296:Service/Srv_Upgrade.c **** {
 297:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 298:Service/Srv_Upgrade.c ****     FileInfo_TypeDef rec_file_info;
 299:Service/Srv_Upgrade.c **** 
 300:Service/Srv_Upgrade.c ****     memset(&rec_file_info, 0, sizeof(rec_file_info));
 301:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 302:Service/Srv_Upgrade.c **** 
 303:Service/Srv_Upgrade.c ****     /* all file data received */
 304:Service/Srv_Upgrade.c ****     /* update upgrade info to storage */
 305:Service/Srv_Upgrade.c ****     Storage.get(Para_Boot, Monitor.UpgradeInfo_SO.item, (uint8_t *)&Info, sizeof(SrvUpgradeInfo_Typ
 306:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 307:Service/Srv_Upgrade.c **** 
 308:Service/Srv_Upgrade.c ****     if (Monitor.FileInfo.File_Type == FileType_APP)
 309:Service/Srv_Upgrade.c ****     {
 310:Service/Srv_Upgrade.c ****         SrvUpgrade_Collect_Info("\tApp firmware receive finished\r\n");
 311:Service/Srv_Upgrade.c **** 
 312:Service/Srv_Upgrade.c ****         if (memcmp(Info.AF_Info.HW_Ver, HWVer, sizeof(Info.AF_Info.HW_Ver)) != 0)
 313:Service/Srv_Upgrade.c ****         {
 314:Service/Srv_Upgrade.c ****             SrvUpgrade_Collect_Info("App firmware hardware version error\r\n");
 315:Service/Srv_Upgrade.c ****             return Stage_Upgrade_Error;
 316:Service/Srv_Upgrade.c ****         }
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 7


 317:Service/Srv_Upgrade.c ****         
 318:Service/Srv_Upgrade.c ****         /* update app firmware info */
 319:Service/Srv_Upgrade.c ****         Info.CTLReg.bit.App = true;
 320:Service/Srv_Upgrade.c ****         Info.AF_Info = rec_file_info;
 321:Service/Srv_Upgrade.c ****     }
 322:Service/Srv_Upgrade.c ****     else if (Monitor.FileInfo.File_Type == FileType_Boot)
 323:Service/Srv_Upgrade.c ****     {
 324:Service/Srv_Upgrade.c ****         SrvUpgrade_Collect_Info("\tBoot firmware receive finished\r\n");
 325:Service/Srv_Upgrade.c ****         
 326:Service/Srv_Upgrade.c ****         if (memcmp(Info.BF_Info.HW_Ver, HWVer, sizeof(Info.BF_Info.HW_Ver)) != 0)
 327:Service/Srv_Upgrade.c ****         {
 328:Service/Srv_Upgrade.c ****             SrvUpgrade_Collect_Info("Boot firmware hardware version error\r\n");
 329:Service/Srv_Upgrade.c ****             return Stage_Upgrade_Error;
 330:Service/Srv_Upgrade.c ****         }
 331:Service/Srv_Upgrade.c ****         
 332:Service/Srv_Upgrade.c ****         /* update boot firmware info */
 333:Service/Srv_Upgrade.c ****         Info.CTLReg.bit.Boot = true;
 334:Service/Srv_Upgrade.c ****         Info.BF_Info = rec_file_info;    /* check for firmware upgrade */
 335:Service/Srv_Upgrade.c ****     }
 336:Service/Srv_Upgrade.c **** 
 337:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tFile size: %d\r\n", rec_file_info.File_Size);
 338:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tHW: %d.%d.%d\r\n", rec_file_info.HW_Ver[0], rec_file_info.HW_Ver[1],
 339:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tSW: %d.%d.%d\r\n", rec_file_info.SW_Ver[0], rec_file_info.SW_Ver[1],
 340:Service/Srv_Upgrade.c ****     Storage.update(Para_Boot, Monitor.UpgradeInfo_SO.item.data_addr, (uint8_t *)&Info, sizeof(SrvUp
 341:Service/Srv_Upgrade.c **** 
 342:Service/Srv_Upgrade.c ****     /* destory adapter obj */
 343:Service/Srv_Upgrade.c ****     SrvFileAdapter.destory(Monitor.adapter_obj);
 344:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 345:Service/Srv_Upgrade.c **** 
 346:Service/Srv_Upgrade.c ****     /* upgrade App */
 347:Service/Srv_Upgrade.c ****     return Stage_Reboot;
 348:Service/Srv_Upgrade.c **** }
 349:Service/Srv_Upgrade.c **** 
 350:Service/Srv_Upgrade.c **** static SrvUpgrade_Stage_List SrvUpgrade_StatePolling(uint32_t sys_time, SrvFileAdapter_Send_Func se
 351:Service/Srv_Upgrade.c **** {
 352:Service/Srv_Upgrade.c ****     uint8_t i = 0;
 353:Service/Srv_Upgrade.c ****     
 354:Service/Srv_Upgrade.c ****     if ((Monitor.FileInfo.File_Type == FileType_None) || (Monitor.FileInfo.File_Type > FileType_Boo
 355:Service/Srv_Upgrade.c ****     {
 356:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_FileInfo_Error;
 357:Service/Srv_Upgrade.c ****     }
 358:Service/Srv_Upgrade.c ****     else
 359:Service/Srv_Upgrade.c ****     {
 360:Service/Srv_Upgrade.c ****         /* check file info */
 361:Service/Srv_Upgrade.c ****         if (Monitor.info_update && (Monitor.adapter_obj == NULL))
 362:Service/Srv_Upgrade.c ****         {
 363:Service/Srv_Upgrade.c ****             Monitor.adapter_obj = SrvFileAdapter.create(Monitor.FileInfo.Adapter_Type, Monitor.File
 364:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 365:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_Adapter_Error;
 366:Service/Srv_Upgrade.c ****         }
 367:Service/Srv_Upgrade.c ****     }
 368:Service/Srv_Upgrade.c **** 
 369:Service/Srv_Upgrade.c ****     if (Monitor.adapter_obj && send)
 370:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 371:Service/Srv_Upgrade.c **** 
 372:Service/Srv_Upgrade.c ****     switch ((uint8_t) Monitor.PollingState)
 373:Service/Srv_Upgrade.c ****     {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 8


 374:Service/Srv_Upgrade.c ****         case Stage_Init:            
 375:Service/Srv_Upgrade.c ****             Monitor.PollingState = Stage_Process_PortData;
 376:Service/Srv_Upgrade.c ****             Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 377:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 378:Service/Srv_Upgrade.c **** 
 379:Service/Srv_Upgrade.c ****         case Stage_Process_PortData:
 380:Service/Srv_Upgrade.c ****             /* check double stream data */
 381:Service/Srv_Upgrade.c ****             for (i = 0; i < 2; i++)
 382:Service/Srv_Upgrade.c ****             {
 383:Service/Srv_Upgrade.c ****                 if (Monitor.proc_stream[i].size)
 384:Service/Srv_Upgrade.c ****                 {
 385:Service/Srv_Upgrade.c ****                     /* received data from port */
 386:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 387:Service/Srv_Upgrade.c ****                     break;
 388:Service/Srv_Upgrade.c ****                 }
 389:Service/Srv_Upgrade.c ****             }
 390:Service/Srv_Upgrade.c ****             
 391:Service/Srv_Upgrade.c ****             switch (SrvUpgrade_PortProcPolling(sys_time))
 392:Service/Srv_Upgrade.c ****             {
 393:Service/Srv_Upgrade.c ****                 case ProtProc_Finish:
 394:Service/Srv_Upgrade.c ****                     Monitor.PollingState = SrvUpgrade_On_PortProc_Finish();
 395:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 396:Service/Srv_Upgrade.c ****                     break;
 397:Service/Srv_Upgrade.c **** 
 398:Service/Srv_Upgrade.c ****                 /* still developping this branch */
 399:Service/Srv_Upgrade.c ****                 case PortProc_Deal_TimeOut: /* Monitor.PollingState = Stage_TimeOut;*/ break;
 400:Service/Srv_Upgrade.c ****                 case PortProc_Deal_Error: 
 401:Service/Srv_Upgrade.c ****                     Monitor.PollingState = Stage_PortData_Error;
 402:Service/Srv_Upgrade.c ****                     SrvUpgrade_Collect_Info("\tUpgrade data process error\r\n");
 403:Service/Srv_Upgrade.c ****                     break;
 404:Service/Srv_Upgrade.c **** 
 405:Service/Srv_Upgrade.c ****                 default: break;
 406:Service/Srv_Upgrade.c ****             }
 407:Service/Srv_Upgrade.c **** 
 408:Service/Srv_Upgrade.c ****             /* check for processing time out when at app */
 409:Service/Srv_Upgrade.c ****             if (Monitor.discard_time <= sys_time)
 410:Service/Srv_Upgrade.c ****             {
 411:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_TimeOut;
 412:Service/Srv_Upgrade.c ****                 if (Monitor.adapter_obj)
 413:Service/Srv_Upgrade.c ****                 {
 414:Service/Srv_Upgrade.c ****                     SrvFileAdapter.destory(Monitor.adapter_obj);
 415:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 416:Service/Srv_Upgrade.c ****                 }
 417:Service/Srv_Upgrade.c ****             }
 418:Service/Srv_Upgrade.c ****             return Stage_Process_PortData;
 419:Service/Srv_Upgrade.c **** 
 420:Service/Srv_Upgrade.c ****         /* firmware upgrading */
 421:Service/Srv_Upgrade.c ****         case Stage_Reboot:
 422:Service/Srv_Upgrade.c ****             return Stage_Reboot;
 423:Service/Srv_Upgrade.c **** 
 424:Service/Srv_Upgrade.c ****         /* when at bootloader */
 425:Service/Srv_Upgrade.c ****         case Stage_ReadyToJump:
 426:Service/Srv_Upgrade.c ****             return Stage_ReadyToJump;
 427:Service/Srv_Upgrade.c **** 
 428:Service/Srv_Upgrade.c ****         /* error process */
 429:Service/Srv_Upgrade.c ****         case Stage_FileInfo_Error:
 430:Service/Srv_Upgrade.c ****             return Stage_FileInfo_Error;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 9


 431:Service/Srv_Upgrade.c **** 
 432:Service/Srv_Upgrade.c ****         case Stage_Upgrade_Error:
 433:Service/Srv_Upgrade.c ****         case Stage_Adapter_Error:
 434:Service/Srv_Upgrade.c ****         case Stage_PortData_Error:
 435:Service/Srv_Upgrade.c ****             Monitor.PollingState = Stage_Init;
 436:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj)
 437:Service/Srv_Upgrade.c ****             {
 438:Service/Srv_Upgrade.c ****                 SrvUpgrade_Collect_Info("\tDestory adapter object\r\n");
 439:Service/Srv_Upgrade.c ****                 SrvUpgrade_Collect_Info("\tUpgrade abort\r\n");
 440:Service/Srv_Upgrade.c ****                 SrvFileAdapter.destory(Monitor.adapter_obj);
 441:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 442:Service/Srv_Upgrade.c ****             }
 443:Service/Srv_Upgrade.c ****             return Stage_Adapter_Error;
 444:Service/Srv_Upgrade.c **** 
 445:Service/Srv_Upgrade.c ****         case Stage_TimeOut:
 446:Service/Srv_Upgrade.c ****             Monitor.PollingState = Stage_Init;
 447:Service/Srv_Upgrade.c ****             return Stage_TimeOut;
 448:Service/Srv_Upgrade.c **** 
 449:Service/Srv_Upgrade.c ****         case Stage_UpgradeInfo_Error:
 450:Service/Srv_Upgrade.c ****             return Stage_UpgradeInfo_Error;
 451:Service/Srv_Upgrade.c **** 
 452:Service/Srv_Upgrade.c ****         default: return Stage_Unknow;
 453:Service/Srv_Upgrade.c ****     }
 454:Service/Srv_Upgrade.c **** }
 455:Service/Srv_Upgrade.c **** 
 456:Service/Srv_Upgrade.c **** static void SrvUpgrade_SetFileInfo(const FileInfo_TypeDef info)
 457:Service/Srv_Upgrade.c **** {
  28              		.loc 1 457 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 16
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33 0000 84B0     		sub	sp, sp, #16
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36 0002 0DF1040C 		add	ip, sp, #4
  37 0006 8CE80700 		stm	ip, {r0, r1, r2}
 458:Service/Srv_Upgrade.c ****     Monitor.info_update = true;
  38              		.loc 1 458 5 view .LVU1
  39              		.loc 1 458 25 is_stmt 0 view .LVU2
  40 000a 054B     		ldr	r3, .L3
  41 000c 0122     		movs	r2, #1
  42 000e 83F85C20 		strb	r2, [r3, #92]
 459:Service/Srv_Upgrade.c ****     memcpy(&Monitor.FileInfo, &info, sizeof(FileInfo_TypeDef));
  43              		.loc 1 459 5 is_stmt 1 view .LVU3
  44 0012 6033     		adds	r3, r3, #96
  45 0014 9CE80700 		ldm	ip, {r0, r1, r2}
  46 0018 83E80700 		stm	r3, {r0, r1, r2}
 460:Service/Srv_Upgrade.c **** }
  47              		.loc 1 460 1 is_stmt 0 view .LVU4
  48 001c 04B0     		add	sp, sp, #16
  49              	.LCFI1:
  50              		.cfi_def_cfa_offset 0
  51              		@ sp needed
  52 001e 7047     		bx	lr
  53              	.L4:
  54              		.align	2
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 10


  55              	.L3:
  56 0020 00000000 		.word	.LANCHOR0
  57              		.cfi_endproc
  58              	.LFE153:
  60              		.section	.text.SrvUpgrade_PushData,"ax",%progbits
  61              		.align	1
  62              		.syntax unified
  63              		.thumb
  64              		.thumb_func
  66              	SrvUpgrade_PushData:
  67              	.LVL0:
  68              	.LFB154:
 461:Service/Srv_Upgrade.c **** 
 462:Service/Srv_Upgrade.c **** /* call this function in receive thread or irq */
 463:Service/Srv_Upgrade.c **** static bool SrvUpgrade_PushData(uint32_t sys_time, uint8_t *p_buf, uint16_t len)
 464:Service/Srv_Upgrade.c **** {
  69              		.loc 1 464 1 is_stmt 1 view -0
  70              		.cfi_startproc
  71              		@ args = 0, pretend = 0, frame = 0
  72              		@ frame_needed = 0, uses_anonymous_args = 0
  73              		.loc 1 464 1 is_stmt 0 view .LVU6
  74 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
  75              	.LCFI2:
  76              		.cfi_def_cfa_offset 32
  77              		.cfi_offset 3, -32
  78              		.cfi_offset 4, -28
  79              		.cfi_offset 5, -24
  80              		.cfi_offset 6, -20
  81              		.cfi_offset 7, -16
  82              		.cfi_offset 8, -12
  83              		.cfi_offset 9, -8
  84              		.cfi_offset 14, -4
 465:Service/Srv_Upgrade.c ****     if (Monitor.init_state)
  85              		.loc 1 465 5 is_stmt 1 view .LVU7
  86              		.loc 1 465 16 is_stmt 0 view .LVU8
  87 0004 1E4B     		ldr	r3, .L12
  88 0006 1E78     		ldrb	r6, [r3]	@ zero_extendqisi2
  89              		.loc 1 465 8 view .LVU9
  90 0008 B6B3     		cbz	r6, .L6
  91 000a 1546     		mov	r5, r2
 466:Service/Srv_Upgrade.c ****     {
 467:Service/Srv_Upgrade.c ****         Monitor.rec_time = sys_time;
  92              		.loc 1 467 9 is_stmt 1 view .LVU10
  93              		.loc 1 467 26 is_stmt 0 view .LVU11
  94 000c D860     		str	r0, [r3, #12]
 468:Service/Srv_Upgrade.c ****         Monitor.rec_timeout = Monitor.rec_time + FIRMWARE_COMMU_TIMEOUT;
  95              		.loc 1 468 9 is_stmt 1 view .LVU12
  96              		.loc 1 468 48 is_stmt 0 view .LVU13
  97 000e 00F57A70 		add	r0, r0, #1000
  98              	.LVL1:
  99              		.loc 1 468 29 view .LVU14
 100 0012 9860     		str	r0, [r3, #8]
 469:Service/Srv_Upgrade.c **** 
 470:Service/Srv_Upgrade.c ****         for (uint8_t i = 0; i < 2; i++)
 101              		.loc 1 470 9 is_stmt 1 view .LVU15
 102              	.LBB2:
 103              		.loc 1 470 14 view .LVU16
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 11


 104              	.LVL2:
 105              		.loc 1 470 22 is_stmt 0 view .LVU17
 106 0014 0023     		movs	r3, #0
 107              		.loc 1 470 9 view .LVU18
 108 0016 01E0     		b	.L7
 109              	.LVL3:
 110              	.L8:
 111              		.loc 1 470 36 is_stmt 1 discriminator 2 view .LVU19
 112              		.loc 1 470 37 is_stmt 0 discriminator 2 view .LVU20
 113 0018 0133     		adds	r3, r3, #1
 114              	.LVL4:
 115              		.loc 1 470 37 discriminator 2 view .LVU21
 116 001a DBB2     		uxtb	r3, r3
 117              	.LVL5:
 118              	.L7:
 119              		.loc 1 470 29 is_stmt 1 discriminator 1 view .LVU22
 120              		.loc 1 470 9 is_stmt 0 discriminator 1 view .LVU23
 121 001c 012B     		cmp	r3, #1
 122 001e 2AD8     		bhi	.L11
 471:Service/Srv_Upgrade.c ****         {
 472:Service/Srv_Upgrade.c ****             if ((!Monitor.proc_stream[i].access) && \
 123              		.loc 1 472 13 is_stmt 1 view .LVU24
 124              		.loc 1 472 41 is_stmt 0 view .LVU25
 125 0020 03EB4300 		add	r0, r3, r3, lsl #1
 126 0024 164C     		ldr	r4, .L12
 127              		.loc 1 472 41 view .LVU26
 128 0026 04EB8000 		add	r0, r4, r0, lsl #2
 129 002a 90F86C20 		ldrb	r2, [r0, #108]	@ zero_extendqisi2
 130              		.loc 1 472 16 view .LVU27
 131 002e 002A     		cmp	r2, #0
 132 0030 F2D1     		bne	.L8
 473:Service/Srv_Upgrade.c ****                 ((Monitor.proc_stream[i].size + len) <= Monitor.proc_stream[i].total_size))
 133              		.loc 1 473 41 discriminator 1 view .LVU28
 134 0032 03EB4302 		add	r2, r3, r3, lsl #1
 135 0036 04EB8202 		add	r2, r4, r2, lsl #2
 136 003a B2F86E00 		ldrh	r0, [r2, #110]
 137              		.loc 1 473 47 discriminator 1 view .LVU29
 138 003e 2C18     		adds	r4, r5, r0
 139              		.loc 1 473 79 discriminator 1 view .LVU30
 140 0040 B2F87020 		ldrh	r2, [r2, #112]
 472:Service/Srv_Upgrade.c ****                 ((Monitor.proc_stream[i].size + len) <= Monitor.proc_stream[i].total_size))
 141              		.loc 1 472 50 discriminator 1 view .LVU31
 142 0044 9442     		cmp	r4, r2
 143 0046 E7DC     		bgt	.L8
 474:Service/Srv_Upgrade.c ****             {
 475:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].access = true;
 144              		.loc 1 475 17 is_stmt 1 view .LVU32
 145              		.loc 1 475 47 is_stmt 0 view .LVU33
 146 0048 DFF83480 		ldr	r8, .L12
 147              		.loc 1 475 47 view .LVU34
 148 004c 03EB4304 		add	r4, r3, r3, lsl #1
 149 0050 08EB8404 		add	r4, r8, r4, lsl #2
 150 0054 0123     		movs	r3, #1
 151              	.LVL6:
 152              		.loc 1 475 47 view .LVU35
 153 0056 84F86C30 		strb	r3, [r4, #108]
 476:Service/Srv_Upgrade.c ****                 memcpy(&Monitor.proc_stream[i].p_buf[Monitor.proc_stream[i].size], p_buf, len);
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 12


 154              		.loc 1 476 17 is_stmt 1 view .LVU36
 155              		.loc 1 476 47 is_stmt 0 view .LVU37
 156 005a 636F     		ldr	r3, [r4, #116]
 157              		.loc 1 476 17 view .LVU38
 158 005c 2A46     		mov	r2, r5
 159 005e 1844     		add	r0, r0, r3
 160 0060 FFF7FEFF 		bl	memcpy
 161              	.LVL7:
 477:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size += len;
 162              		.loc 1 477 17 is_stmt 1 view .LVU39
 163              		.loc 1 477 45 is_stmt 0 view .LVU40
 164 0064 B4F86E30 		ldrh	r3, [r4, #110]
 165 0068 1D44     		add	r5, r5, r3
 166 006a A4F86E50 		strh	r5, [r4, #110]	@ movhi
 478:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].access = false;
 167              		.loc 1 478 17 is_stmt 1 view .LVU41
 168              		.loc 1 478 47 is_stmt 0 view .LVU42
 169 006e 0023     		movs	r3, #0
 170 0070 84F86C30 		strb	r3, [r4, #108]
 479:Service/Srv_Upgrade.c ****                 return true;
 171              		.loc 1 479 17 is_stmt 1 view .LVU43
 172              		.loc 1 479 24 is_stmt 0 view .LVU44
 173 0074 00E0     		b	.L6
 174              	.LVL8:
 175              	.L11:
 176              		.loc 1 479 24 view .LVU45
 177              	.LBE2:
 480:Service/Srv_Upgrade.c ****             }
 481:Service/Srv_Upgrade.c ****         }
 482:Service/Srv_Upgrade.c ****     }
 483:Service/Srv_Upgrade.c **** 
 484:Service/Srv_Upgrade.c ****     return false;
 178              		.loc 1 484 12 view .LVU46
 179 0076 0026     		movs	r6, #0
 180              	.LVL9:
 181              	.L6:
 485:Service/Srv_Upgrade.c **** }
 182              		.loc 1 485 1 view .LVU47
 183 0078 3046     		mov	r0, r6
 184 007a BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 185              	.L13:
 186 007e 00BF     		.align	2
 187              	.L12:
 188 0080 00000000 		.word	.LANCHOR0
 189              		.cfi_endproc
 190              	.LFE154:
 192              		.section	.text.SrvUpgrade_Get_Info,"ax",%progbits
 193              		.align	1
 194              		.syntax unified
 195              		.thumb
 196              		.thumb_func
 198              	SrvUpgrade_Get_Info:
 199              	.LVL10:
 200              	.LFB157:
 486:Service/Srv_Upgrade.c **** 
 487:Service/Srv_Upgrade.c **** static void SrvUpgrade_Set_FileInfo(const FileInfo_TypeDef info)
 488:Service/Srv_Upgrade.c **** {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 13


 489:Service/Srv_Upgrade.c ****     memcpy(&Monitor.FileInfo, &info, sizeof(FileInfo_TypeDef));
 490:Service/Srv_Upgrade.c **** }
 491:Service/Srv_Upgrade.c **** 
 492:Service/Srv_Upgrade.c **** static void SrvUpgrade_Collect_Info(const char *format, ...)
 493:Service/Srv_Upgrade.c **** {
 494:Service/Srv_Upgrade.c ****     va_list args;
 495:Service/Srv_Upgrade.c ****     uint16_t buf_remain = 0;
 496:Service/Srv_Upgrade.c ****     uint16_t buf_capacity = sizeof(Monitor.LogOut_Info);
 497:Service/Srv_Upgrade.c ****     int16_t send_len = 0;
 498:Service/Srv_Upgrade.c **** 
 499:Service/Srv_Upgrade.c ****     if (format && (Monitor.LogOut_Info_size < buf_capacity))
 500:Service/Srv_Upgrade.c ****     {
 501:Service/Srv_Upgrade.c ****         buf_remain = buf_capacity - Monitor.LogOut_Info_size;
 502:Service/Srv_Upgrade.c **** 
 503:Service/Srv_Upgrade.c ****         va_start(args, format);
 504:Service/Srv_Upgrade.c **** 
 505:Service/Srv_Upgrade.c ****         send_len = vsnprintf((char *)(Monitor.LogOut_Info + Monitor.LogOut_Info_size), buf_remain, 
 506:Service/Srv_Upgrade.c ****         if (send_len > 0)
 507:Service/Srv_Upgrade.c ****             Monitor.LogOut_Info_size += send_len;
 508:Service/Srv_Upgrade.c **** 
 509:Service/Srv_Upgrade.c ****         va_end(args);
 510:Service/Srv_Upgrade.c ****     }
 511:Service/Srv_Upgrade.c **** }
 512:Service/Srv_Upgrade.c **** 
 513:Service/Srv_Upgrade.c **** static uint16_t SrvUpgrade_Get_Info(uint8_t *p_info, uint16_t len)
 514:Service/Srv_Upgrade.c **** {
 201              		.loc 1 514 1 is_stmt 1 view -0
 202              		.cfi_startproc
 203              		@ args = 0, pretend = 0, frame = 0
 204              		@ frame_needed = 0, uses_anonymous_args = 0
 515:Service/Srv_Upgrade.c ****     uint16_t log_size = 0;
 205              		.loc 1 515 5 view .LVU49
 516:Service/Srv_Upgrade.c **** 
 517:Service/Srv_Upgrade.c ****     if (p_info && len && (len >= Monitor.LogOut_Info_size) && Monitor.init_state)
 206              		.loc 1 517 5 view .LVU50
 207              		.loc 1 517 8 is_stmt 0 view .LVU51
 208 0000 98B1     		cbz	r0, .L16
 209              		.loc 1 517 16 discriminator 1 view .LVU52
 210 0002 A1B1     		cbz	r1, .L17
 211              		.loc 1 517 41 discriminator 2 view .LVU53
 212 0004 0C4A     		ldr	r2, .L25
 213 0006 B2F88424 		ldrh	r2, [r2, #1156]
 214              		.loc 1 517 23 discriminator 2 view .LVU54
 215 000a 8A42     		cmp	r2, r1
 216 000c 11D8     		bhi	.L18
 217              		.loc 1 517 70 discriminator 3 view .LVU55
 218 000e 0A49     		ldr	r1, .L25
 219              	.LVL11:
 220              		.loc 1 517 70 discriminator 3 view .LVU56
 221 0010 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 222              		.loc 1 517 60 discriminator 3 view .LVU57
 223 0012 09B9     		cbnz	r1, .L24
 515:Service/Srv_Upgrade.c ****     uint16_t log_size = 0;
 224              		.loc 1 515 14 view .LVU58
 225 0014 0020     		movs	r0, #0
 226              	.LVL12:
 518:Service/Srv_Upgrade.c ****     {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 14


 519:Service/Srv_Upgrade.c ****         log_size = Monitor.LogOut_Info_size;
 520:Service/Srv_Upgrade.c ****         memcpy(p_info, Monitor.LogOut_Info, Monitor.LogOut_Info_size);
 521:Service/Srv_Upgrade.c ****         log_size = Monitor.LogOut_Info_size;
 522:Service/Srv_Upgrade.c ****     }
 523:Service/Srv_Upgrade.c **** 
 524:Service/Srv_Upgrade.c ****     return log_size;
 227              		.loc 1 524 5 is_stmt 1 view .LVU59
 525:Service/Srv_Upgrade.c **** }
 228              		.loc 1 525 1 is_stmt 0 view .LVU60
 229 0016 7047     		bx	lr
 230              	.LVL13:
 231              	.L24:
 514:Service/Srv_Upgrade.c ****     uint16_t log_size = 0;
 232              		.loc 1 514 1 view .LVU61
 233 0018 10B5     		push	{r4, lr}
 234              	.LCFI3:
 235              		.cfi_def_cfa_offset 8
 236              		.cfi_offset 4, -8
 237              		.cfi_offset 14, -4
 519:Service/Srv_Upgrade.c ****         memcpy(p_info, Monitor.LogOut_Info, Monitor.LogOut_Info_size);
 238              		.loc 1 519 9 is_stmt 1 view .LVU62
 239              	.LVL14:
 520:Service/Srv_Upgrade.c ****         log_size = Monitor.LogOut_Info_size;
 240              		.loc 1 520 9 view .LVU63
 241 001a 074C     		ldr	r4, .L25
 242 001c 04F18401 		add	r1, r4, #132
 243 0020 FFF7FEFF 		bl	memcpy
 244              	.LVL15:
 521:Service/Srv_Upgrade.c ****     }
 245              		.loc 1 521 9 view .LVU64
 521:Service/Srv_Upgrade.c ****     }
 246              		.loc 1 521 18 is_stmt 0 view .LVU65
 247 0024 B4F88404 		ldrh	r0, [r4, #1156]
 248              	.LVL16:
 524:Service/Srv_Upgrade.c **** }
 249              		.loc 1 524 5 is_stmt 1 view .LVU66
 250              		.loc 1 525 1 is_stmt 0 view .LVU67
 251 0028 10BD     		pop	{r4, pc}
 252              	.LVL17:
 253              	.L16:
 254              	.LCFI4:
 255              		.cfi_def_cfa_offset 0
 256              		.cfi_restore 4
 257              		.cfi_restore 14
 515:Service/Srv_Upgrade.c **** 
 258              		.loc 1 515 14 view .LVU68
 259 002a 0020     		movs	r0, #0
 260              	.LVL18:
 515:Service/Srv_Upgrade.c **** 
 261              		.loc 1 515 14 view .LVU69
 262 002c 7047     		bx	lr
 263              	.LVL19:
 264              	.L17:
 515:Service/Srv_Upgrade.c **** 
 265              		.loc 1 515 14 view .LVU70
 266 002e 0846     		mov	r0, r1
 267              	.LVL20:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 15


 515:Service/Srv_Upgrade.c **** 
 268              		.loc 1 515 14 view .LVU71
 269 0030 7047     		bx	lr
 270              	.LVL21:
 271              	.L18:
 515:Service/Srv_Upgrade.c **** 
 272              		.loc 1 515 14 view .LVU72
 273 0032 0020     		movs	r0, #0
 274              	.LVL22:
 515:Service/Srv_Upgrade.c **** 
 275              		.loc 1 515 14 view .LVU73
 276 0034 7047     		bx	lr
 277              	.L26:
 278 0036 00BF     		.align	2
 279              	.L25:
 280 0038 00000000 		.word	.LANCHOR0
 281              		.cfi_endproc
 282              	.LFE157:
 284              		.section	.text.SrvUpgrade_ClearLog,"ax",%progbits
 285              		.align	1
 286              		.syntax unified
 287              		.thumb
 288              		.thumb_func
 290              	SrvUpgrade_ClearLog:
 291              	.LFB158:
 526:Service/Srv_Upgrade.c **** 
 527:Service/Srv_Upgrade.c **** static void SrvUpgrade_ClearLog(void)
 528:Service/Srv_Upgrade.c **** {
 292              		.loc 1 528 1 is_stmt 1 view -0
 293              		.cfi_startproc
 294              		@ args = 0, pretend = 0, frame = 0
 295              		@ frame_needed = 0, uses_anonymous_args = 0
 296 0000 10B5     		push	{r4, lr}
 297              	.LCFI5:
 298              		.cfi_def_cfa_offset 8
 299              		.cfi_offset 4, -8
 300              		.cfi_offset 14, -4
 529:Service/Srv_Upgrade.c ****     memset(Monitor.LogOut_Info, 0, sizeof(Monitor.LogOut_Info));
 301              		.loc 1 529 5 view .LVU75
 302 0002 064C     		ldr	r4, .L29
 303 0004 4FF48062 		mov	r2, #1024
 304 0008 0021     		movs	r1, #0
 305 000a 04F18400 		add	r0, r4, #132
 306 000e FFF7FEFF 		bl	memset
 307              	.LVL23:
 530:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 308              		.loc 1 530 5 view .LVU76
 309              		.loc 1 530 30 is_stmt 0 view .LVU77
 310 0012 0023     		movs	r3, #0
 311 0014 A4F88434 		strh	r3, [r4, #1156]	@ movhi
 531:Service/Srv_Upgrade.c **** }
 312              		.loc 1 531 1 view .LVU78
 313 0018 10BD     		pop	{r4, pc}
 314              	.L30:
 315 001a 00BF     		.align	2
 316              	.L29:
 317 001c 00000000 		.word	.LANCHOR0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 16


 318              		.cfi_endproc
 319              	.LFE158:
 321              		.section	.text.SrvUpgrade_PortProcPolling,"ax",%progbits
 322              		.align	1
 323              		.syntax unified
 324              		.thumb
 325              		.thumb_func
 327              	SrvUpgrade_PortProcPolling:
 328              	.LVL24:
 329              	.LFB150:
 233:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List ret;
 330              		.loc 1 233 1 is_stmt 1 view -0
 331              		.cfi_startproc
 332              		@ args = 0, pretend = 0, frame = 0
 333              		@ frame_needed = 0, uses_anonymous_args = 0
 233:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List ret;
 334              		.loc 1 233 1 is_stmt 0 view .LVU80
 335 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 336              	.LCFI6:
 337              		.cfi_def_cfa_offset 24
 338              		.cfi_offset 3, -24
 339              		.cfi_offset 4, -20
 340              		.cfi_offset 5, -16
 341              		.cfi_offset 6, -12
 342              		.cfi_offset 7, -8
 343              		.cfi_offset 14, -4
 234:Service/Srv_Upgrade.c ****     Adapter_Polling_State adapter_state; 
 344              		.loc 1 234 5 is_stmt 1 view .LVU81
 235:Service/Srv_Upgrade.c **** 
 345              		.loc 1 235 5 view .LVU82
 237:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 346              		.loc 1 237 5 view .LVU83
 237:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 347              		.loc 1 237 16 is_stmt 0 view .LVU84
 348 0002 384B     		ldr	r3, .L48
 349 0004 9B6D     		ldr	r3, [r3, #88]
 237:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 350              		.loc 1 237 8 view .LVU85
 351 0006 002B     		cmp	r3, #0
 352 0008 68D0     		beq	.L40
 353 000a 0646     		mov	r6, r0
 354              	.LBB3:
 240:Service/Srv_Upgrade.c ****     {
 355              		.loc 1 240 18 view .LVU86
 356 000c 0024     		movs	r4, #0
 357 000e 09E0     		b	.L33
 358              	.LVL25:
 359              	.L35:
 252:Service/Srv_Upgrade.c ****         }
 360              		.loc 1 252 13 is_stmt 1 view .LVU87
 252:Service/Srv_Upgrade.c ****         }
 361              		.loc 1 252 43 is_stmt 0 view .LVU88
 362 0010 05EB4505 		add	r5, r5, r5, lsl #1
 363 0014 334B     		ldr	r3, .L48
 364 0016 03EB8505 		add	r5, r3, r5, lsl #2
 365 001a 0023     		movs	r3, #0
 366 001c 85F86C30 		strb	r3, [r5, #108]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 17


 367              	.L34:
 240:Service/Srv_Upgrade.c ****     {
 368              		.loc 1 240 32 is_stmt 1 discriminator 2 view .LVU89
 240:Service/Srv_Upgrade.c ****     {
 369              		.loc 1 240 34 is_stmt 0 discriminator 2 view .LVU90
 370 0020 0134     		adds	r4, r4, #1
 371              	.LVL26:
 240:Service/Srv_Upgrade.c ****     {
 372              		.loc 1 240 34 discriminator 2 view .LVU91
 373 0022 E4B2     		uxtb	r4, r4
 374              	.LVL27:
 375              	.L33:
 240:Service/Srv_Upgrade.c ****     {
 376              		.loc 1 240 25 is_stmt 1 discriminator 1 view .LVU92
 240:Service/Srv_Upgrade.c ****     {
 377              		.loc 1 240 5 is_stmt 0 discriminator 1 view .LVU93
 378 0024 012C     		cmp	r4, #1
 379 0026 2DD8     		bhi	.L45
 242:Service/Srv_Upgrade.c ****         {
 380              		.loc 1 242 9 is_stmt 1 view .LVU94
 242:Service/Srv_Upgrade.c ****         {
 381              		.loc 1 242 36 is_stmt 0 view .LVU95
 382 0028 2546     		mov	r5, r4
 383 002a 04EB4403 		add	r3, r4, r4, lsl #1
 384 002e 2D4A     		ldr	r2, .L48
 385 0030 02EB8303 		add	r3, r2, r3, lsl #2
 386 0034 93F86C30 		ldrb	r3, [r3, #108]	@ zero_extendqisi2
 242:Service/Srv_Upgrade.c ****         {
 387              		.loc 1 242 12 view .LVU96
 388 0038 002B     		cmp	r3, #0
 389 003a F1D1     		bne	.L34
 242:Service/Srv_Upgrade.c ****         {
 390              		.loc 1 242 69 discriminator 1 view .LVU97
 391 003c 04EB4403 		add	r3, r4, r4, lsl #1
 392 0040 02EB8303 		add	r3, r2, r3, lsl #2
 393 0044 B3F86E10 		ldrh	r1, [r3, #110]
 242:Service/Srv_Upgrade.c ****         {
 394              		.loc 1 242 44 discriminator 1 view .LVU98
 395 0048 0029     		cmp	r1, #0
 396 004a E9D0     		beq	.L34
 244:Service/Srv_Upgrade.c **** 
 397              		.loc 1 244 13 is_stmt 1 view .LVU99
 244:Service/Srv_Upgrade.c **** 
 398              		.loc 1 244 43 is_stmt 0 view .LVU100
 399 004c 04EB4403 		add	r3, r4, r4, lsl #1
 400 0050 02EB8303 		add	r3, r2, r3, lsl #2
 401 0054 0122     		movs	r2, #1
 402 0056 83F86C20 		strb	r2, [r3, #108]
 246:Service/Srv_Upgrade.c ****             {
 403              		.loc 1 246 13 is_stmt 1 view .LVU101
 246:Service/Srv_Upgrade.c ****             {
 404              		.loc 1 246 31 is_stmt 0 view .LVU102
 405 005a 234A     		ldr	r2, .L48+4
 406 005c 5268     		ldr	r2, [r2, #4]
 246:Service/Srv_Upgrade.c ****             {
 407              		.loc 1 246 17 view .LVU103
 408 005e 586F     		ldr	r0, [r3, #116]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 18


 409 0060 9047     		blx	r2
 410              	.LVL28:
 246:Service/Srv_Upgrade.c ****             {
 411              		.loc 1 246 16 view .LVU104
 412 0062 0028     		cmp	r0, #0
 413 0064 D4D0     		beq	.L35
 248:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 414              		.loc 1 248 17 is_stmt 1 view .LVU105
 248:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 415              		.loc 1 248 46 is_stmt 0 view .LVU106
 416 0066 04EB4407 		add	r7, r4, r4, lsl #1
 417 006a 1E4B     		ldr	r3, .L48
 418 006c 03EB8707 		add	r7, r3, r7, lsl #2
 248:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 419              		.loc 1 248 17 view .LVU107
 420 0070 B7F86E20 		ldrh	r2, [r7, #110]
 421 0074 0021     		movs	r1, #0
 422 0076 786F     		ldr	r0, [r7, #116]
 423 0078 FFF7FEFF 		bl	memset
 424              	.LVL29:
 249:Service/Srv_Upgrade.c ****             }
 425              		.loc 1 249 17 is_stmt 1 view .LVU108
 249:Service/Srv_Upgrade.c ****             }
 426              		.loc 1 249 45 is_stmt 0 view .LVU109
 427 007c 0023     		movs	r3, #0
 428 007e A7F86E30 		strh	r3, [r7, #110]	@ movhi
 429 0082 C5E7     		b	.L35
 430              	.L45:
 431              	.LBE3:
 256:Service/Srv_Upgrade.c ****     {
 432              		.loc 1 256 5 is_stmt 1 view .LVU110
 256:Service/Srv_Upgrade.c ****     {
 433              		.loc 1 256 29 is_stmt 0 view .LVU111
 434 0084 174B     		ldr	r3, .L48
 435 0086 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
 256:Service/Srv_Upgrade.c ****     {
 436              		.loc 1 256 5 view .LVU112
 437 0088 0128     		cmp	r0, #1
 438 008a 0CD0     		beq	.L37
 439 008c 0228     		cmp	r0, #2
 440 008e 18D0     		beq	.L38
 441 0090 28B1     		cbz	r0, .L46
 442 0092 0620     		movs	r0, #6
 443              	.L39:
 285:Service/Srv_Upgrade.c ****     {
 444              		.loc 1 285 57 discriminator 1 view .LVU113
 445 0094 134B     		ldr	r3, .L48
 446 0096 9B68     		ldr	r3, [r3, #8]
 285:Service/Srv_Upgrade.c ****     {
 447              		.loc 1 285 34 discriminator 1 view .LVU114
 448 0098 B342     		cmp	r3, r6
 449 009a 18D9     		bls	.L47
 450              	.LVL30:
 451              	.L32:
 293:Service/Srv_Upgrade.c **** 
 452              		.loc 1 293 1 view .LVU115
 453 009c F8BD     		pop	{r3, r4, r5, r6, r7, pc}
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 19


 454              	.LVL31:
 455              	.L46:
 259:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 456              		.loc 1 259 13 is_stmt 1 view .LVU116
 259:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 457              		.loc 1 259 44 is_stmt 0 view .LVU117
 458 009e 06F57A73 		add	r3, r6, #1000
 259:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 459              		.loc 1 259 33 view .LVU118
 460 00a2 104A     		ldr	r2, .L48
 461 00a4 9360     		str	r3, [r2, #8]
 462              	.L37:
 261:Service/Srv_Upgrade.c ****             adapter_state = SrvFileAdapter.polling(sys_time, Monitor.adapter_obj);
 463              		.loc 1 261 13 is_stmt 1 view .LVU119
 261:Service/Srv_Upgrade.c ****             adapter_state = SrvFileAdapter.polling(sys_time, Monitor.adapter_obj);
 464              		.loc 1 261 35 is_stmt 0 view .LVU120
 465 00a6 0F4B     		ldr	r3, .L48
 466 00a8 0122     		movs	r2, #1
 467 00aa 9A70     		strb	r2, [r3, #2]
 262:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 468              		.loc 1 262 13 is_stmt 1 view .LVU121
 262:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 469              		.loc 1 262 43 is_stmt 0 view .LVU122
 470 00ac 0E4A     		ldr	r2, .L48+4
 471 00ae 1269     		ldr	r2, [r2, #16]
 262:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 472              		.loc 1 262 29 view .LVU123
 473 00b0 996D     		ldr	r1, [r3, #88]
 474 00b2 3046     		mov	r0, r6
 475 00b4 9047     		blx	r2
 476              	.LVL32:
 263:Service/Srv_Upgrade.c ****             
 477              		.loc 1 263 13 is_stmt 1 view .LVU124
 266:Service/Srv_Upgrade.c ****             {
 478              		.loc 1 266 13 view .LVU125
 479 00b6 0228     		cmp	r0, #2
 480 00b8 12D0     		beq	.L42
 481 00ba 0328     		cmp	r0, #3
 482 00bc 05D1     		bne	.L43
 483 00be 0220     		movs	r0, #2
 484              	.LVL33:
 266:Service/Srv_Upgrade.c ****             {
 485              		.loc 1 266 13 is_stmt 0 view .LVU126
 486 00c0 E8E7     		b	.L39
 487              	.LVL34:
 488              	.L38:
 275:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Error;
 489              		.loc 1 275 13 is_stmt 1 view .LVU127
 275:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Error;
 490              		.loc 1 275 35 is_stmt 0 view .LVU128
 491 00c2 084B     		ldr	r3, .L48
 492 00c4 0022     		movs	r2, #0
 493 00c6 9A70     		strb	r2, [r3, #2]
 276:Service/Srv_Upgrade.c ****             break;
 494              		.loc 1 276 13 is_stmt 1 view .LVU129
 495              	.LVL35:
 277:Service/Srv_Upgrade.c **** 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 20


 496              		.loc 1 277 13 view .LVU130
 285:Service/Srv_Upgrade.c ****     {
 497              		.loc 1 285 5 view .LVU131
 498 00c8 E4E7     		b	.L39
 499              	.LVL36:
 500              	.L43:
 263:Service/Srv_Upgrade.c ****             
 501              		.loc 1 263 17 is_stmt 0 view .LVU132
 502 00ca 0120     		movs	r0, #1
 503              	.LVL37:
 263:Service/Srv_Upgrade.c ****             
 504              		.loc 1 263 17 view .LVU133
 505 00cc E2E7     		b	.L39
 506              	.LVL38:
 507              	.L47:
 287:Service/Srv_Upgrade.c ****         Monitor.PortDataState = PortProc_None;
 508              		.loc 1 287 9 is_stmt 1 view .LVU134
 287:Service/Srv_Upgrade.c ****         Monitor.PortDataState = PortProc_None;
 509              		.loc 1 287 29 is_stmt 0 view .LVU135
 510 00ce 054B     		ldr	r3, .L48
 511 00d0 0022     		movs	r2, #0
 512 00d2 83F85C20 		strb	r2, [r3, #92]
 288:Service/Srv_Upgrade.c ****         ret = PortProc_Deal_TimeOut;
 513              		.loc 1 288 9 is_stmt 1 view .LVU136
 288:Service/Srv_Upgrade.c ****         ret = PortProc_Deal_TimeOut;
 514              		.loc 1 288 31 is_stmt 0 view .LVU137
 515 00d6 9A70     		strb	r2, [r3, #2]
 289:Service/Srv_Upgrade.c ****     }
 516              		.loc 1 289 9 is_stmt 1 view .LVU138
 517              	.LVL39:
 289:Service/Srv_Upgrade.c ****     }
 518              		.loc 1 289 13 is_stmt 0 view .LVU139
 519 00d8 0420     		movs	r0, #4
 520 00da DFE7     		b	.L32
 521              	.LVL40:
 522              	.L40:
 238:Service/Srv_Upgrade.c **** 
 523              		.loc 1 238 16 view .LVU140
 524 00dc 0220     		movs	r0, #2
 525              	.LVL41:
 238:Service/Srv_Upgrade.c **** 
 526              		.loc 1 238 16 view .LVU141
 527 00de DDE7     		b	.L32
 528              	.LVL42:
 529              	.L42:
 238:Service/Srv_Upgrade.c **** 
 530              		.loc 1 238 16 view .LVU142
 531 00e0 0320     		movs	r0, #3
 532              	.LVL43:
 238:Service/Srv_Upgrade.c **** 
 533              		.loc 1 238 16 view .LVU143
 534 00e2 DBE7     		b	.L32
 535              	.L49:
 536              		.align	2
 537              	.L48:
 538 00e4 00000000 		.word	.LANCHOR0
 539 00e8 00000000 		.word	SrvFileAdapter
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 21


 540              		.cfi_endproc
 541              	.LFE150:
 543              		.section	.rodata.SrvUpgrade_CheckUpgrade_OnBootUp.str1.4,"aMS",%progbits,1
 544              		.align	2
 545              	.LC0:
 546 0000 55706772 		.ascii	"Upgrade_Info\000"
 546      6164655F 
 546      496E666F 
 546      00
 547              		.section	.text.SrvUpgrade_CheckUpgrade_OnBootUp,"ax",%progbits
 548              		.align	1
 549              		.syntax unified
 550              		.thumb
 551              		.thumb_func
 553              	SrvUpgrade_CheckUpgrade_OnBootUp:
 554              	.LFB149:
 164:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 555              		.loc 1 164 1 is_stmt 1 view -0
 556              		.cfi_startproc
 557              		@ args = 0, pretend = 0, frame = 104
 558              		@ frame_needed = 0, uses_anonymous_args = 0
 559 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 560              	.LCFI7:
 561              		.cfi_def_cfa_offset 32
 562              		.cfi_offset 4, -32
 563              		.cfi_offset 5, -28
 564              		.cfi_offset 6, -24
 565              		.cfi_offset 7, -20
 566              		.cfi_offset 8, -16
 567              		.cfi_offset 9, -12
 568              		.cfi_offset 10, -8
 569              		.cfi_offset 14, -4
 570 0004 AAB0     		sub	sp, sp, #168
 571              	.LCFI8:
 572              		.cfi_def_cfa_offset 200
 165:Service/Srv_Upgrade.c ****     uint32_t file_size = 0;
 573              		.loc 1 165 5 view .LVU145
 166:Service/Srv_Upgrade.c ****     uint16_t update_size = 0;
 574              		.loc 1 166 5 view .LVU146
 575              	.LVL44:
 167:Service/Srv_Upgrade.c ****     uint32_t addr_offset = 0;
 576              		.loc 1 167 5 view .LVU147
 168:Service/Srv_Upgrade.c **** 
 577              		.loc 1 168 5 view .LVU148
 170:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 578              		.loc 1 170 5 view .LVU149
 579 0006 5B4C     		ldr	r4, .L64
 580 0008 04F11005 		add	r5, r4, #16
 581 000c 4526     		movs	r6, #69
 582 000e 3246     		mov	r2, r6
 583 0010 0021     		movs	r1, #0
 584 0012 2846     		mov	r0, r5
 585 0014 FFF7FEFF 		bl	memset
 586              	.LVL45:
 171:Service/Srv_Upgrade.c **** 
 587              		.loc 1 171 5 view .LVU150
 588 0018 0021     		movs	r1, #0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 22


 589 001a 2391     		str	r1, [sp, #140]
 590 001c 2491     		str	r1, [sp, #144]
 591 001e 2591     		str	r1, [sp, #148]
 592 0020 2691     		str	r1, [sp, #152]
 593 0022 2791     		str	r1, [sp, #156]
 594 0024 2891     		str	r1, [sp, #160]
 595 0026 8DF8A410 		strb	r1, [sp, #164]
 174:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 596              		.loc 1 174 5 view .LVU151
 174:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 597              		.loc 1 174 37 is_stmt 0 view .LVU152
 598 002a 534B     		ldr	r3, .L64+4
 599 002c 5B68     		ldr	r3, [r3, #4]
 174:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 600              		.loc 1 174 30 view .LVU153
 601 002e 534A     		ldr	r2, .L64+8
 602 0030 10A8     		add	r0, sp, #64
 603 0032 9847     		blx	r3
 604              	.LVL46:
 605 0034 3246     		mov	r2, r6
 606 0036 10A9     		add	r1, sp, #64
 607 0038 2846     		mov	r0, r5
 608 003a FFF7FEFF 		bl	memcpy
 609              	.LVL47:
 175:Service/Srv_Upgrade.c ****     {
 610              		.loc 1 175 5 is_stmt 1 view .LVU154
 175:Service/Srv_Upgrade.c ****     {
 611              		.loc 1 175 31 is_stmt 0 view .LVU155
 612 003e 2369     		ldr	r3, [r4, #16]
 175:Service/Srv_Upgrade.c ****     {
 613              		.loc 1 175 8 view .LVU156
 614 0040 002B     		cmp	r3, #0
 615 0042 6FD0     		beq	.L51
 177:Service/Srv_Upgrade.c **** 
 616              		.loc 1 177 9 is_stmt 1 view .LVU157
 177:Service/Srv_Upgrade.c **** 
 617              		.loc 1 177 16 is_stmt 0 view .LVU158
 618 0044 4C4B     		ldr	r3, .L64+4
 619 0046 D3F81080 		ldr	r8, [r3, #16]
 177:Service/Srv_Upgrade.c **** 
 620              		.loc 1 177 9 view .LVU159
 621 004a 2746     		mov	r7, r4
 622 004c 1922     		movs	r2, #25
 623 004e 0E92     		str	r2, [sp, #56]
 624 0050 23AA     		add	r2, sp, #140
 625 0052 0D92     		str	r2, [sp, #52]
 626 0054 D4F81590 		ldr	r9, [r4, #21]	@ unaligned
 627 0058 D4F819E0 		ldr	lr, [r4, #25]	@ unaligned
 628 005c D4F81DC0 		ldr	ip, [r4, #29]	@ unaligned
 629 0060 2134     		adds	r4, r4, #33
 630 0062 6E46     		mov	r6, sp
 631 0064 5137     		adds	r7, r7, #81
 632              	.L52:
 633 0066 3546     		mov	r5, r6
 634 0068 2068     		ldr	r0, [r4]	@ unaligned
 635 006a 6168     		ldr	r1, [r4, #4]	@ unaligned
 636 006c A268     		ldr	r2, [r4, #8]	@ unaligned
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 23


 637 006e E368     		ldr	r3, [r4, #12]	@ unaligned
 638 0070 0FC5     		stmia	r5!, {r0, r1, r2, r3}
 639 0072 1034     		adds	r4, r4, #16
 640 0074 2E46     		mov	r6, r5
 641 0076 BC42     		cmp	r4, r7
 642 0078 F5D1     		bne	.L52
 643 007a 2068     		ldr	r0, [r4]	@ unaligned
 644 007c 2860     		str	r0, [r5]
 645 007e 4946     		mov	r1, r9
 646 0080 7246     		mov	r2, lr
 647 0082 6346     		mov	r3, ip
 648 0084 0020     		movs	r0, #0
 649 0086 C047     		blx	r8
 650              	.LVL48:
 181:Service/Srv_Upgrade.c ****         {
 651              		.loc 1 181 9 is_stmt 1 view .LVU160
 181:Service/Srv_Upgrade.c ****         {
 652              		.loc 1 181 13 is_stmt 0 view .LVU161
 653 0088 9DF88C30 		ldrb	r3, [sp, #140]	@ zero_extendqisi2
 181:Service/Srv_Upgrade.c ****         {
 654              		.loc 1 181 12 view .LVU162
 655 008c 13F0010F 		tst	r3, #1
 656 0090 0AD0     		beq	.L60
 184:Service/Srv_Upgrade.c ****             {
 657              		.loc 1 184 13 is_stmt 1 view .LVU163
 184:Service/Srv_Upgrade.c ****             {
 658              		.loc 1 184 17 is_stmt 0 view .LVU164
 659 0092 0322     		movs	r2, #3
 660 0094 3A49     		ldr	r1, .L64+12
 661 0096 0DF19200 		add	r0, sp, #146
 662 009a FFF7FEFF 		bl	memcmp
 663              	.LVL49:
 184:Service/Srv_Upgrade.c ****             {
 664              		.loc 1 184 16 view .LVU165
 665 009e 0028     		cmp	r0, #0
 666 00a0 3ED1     		bne	.L61
 187:Service/Srv_Upgrade.c ****             }
 667              		.loc 1 187 17 is_stmt 1 view .LVU166
 187:Service/Srv_Upgrade.c ****             }
 668              		.loc 1 187 27 is_stmt 0 view .LVU167
 669 00a2 DDF89550 		ldr	r5, [sp, #149]	@ unaligned
 670              	.LVL50:
 187:Service/Srv_Upgrade.c ****             }
 671              		.loc 1 187 27 view .LVU168
 672 00a6 00E0     		b	.L53
 673              	.LVL51:
 674              	.L60:
 166:Service/Srv_Upgrade.c ****     uint16_t update_size = 0;
 675              		.loc 1 166 14 view .LVU169
 676 00a8 0025     		movs	r5, #0
 677              	.LVL52:
 678              	.L53:
 195:Service/Srv_Upgrade.c **** 
 679              		.loc 1 195 29 view .LVU170
 680 00aa 0026     		movs	r6, #0
 681              	.LVL53:
 682              	.L54:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 24


 191:Service/Srv_Upgrade.c ****         {
 683              		.loc 1 191 15 is_stmt 1 view .LVU171
 684 00ac 002D     		cmp	r5, #0
 685 00ae 56D0     		beq	.L58
 193:Service/Srv_Upgrade.c ****             if (file_size > 1024)
 686              		.loc 1 193 13 view .LVU172
 193:Service/Srv_Upgrade.c ****             if (file_size > 1024)
 687              		.loc 1 193 25 is_stmt 0 view .LVU173
 688 00b0 ACB2     		uxth	r4, r5
 689              	.LVL54:
 194:Service/Srv_Upgrade.c ****                 update_size = 1024;
 690              		.loc 1 194 13 is_stmt 1 view .LVU174
 194:Service/Srv_Upgrade.c ****                 update_size = 1024;
 691              		.loc 1 194 16 is_stmt 0 view .LVU175
 692 00b2 B5F5806F 		cmp	r5, #1024
 693 00b6 01D9     		bls	.L55
 195:Service/Srv_Upgrade.c **** 
 694              		.loc 1 195 29 view .LVU176
 695 00b8 4FF48064 		mov	r4, #1024
 696              	.LVL55:
 697              	.L55:
 198:Service/Srv_Upgrade.c ****             Storage.read_firmware(Firmware_Boot, addr_offset, upgrade_buf, update_size);
 698              		.loc 1 198 13 is_stmt 1 view .LVU177
 699 00bc DFF8CCA0 		ldr	r10, .L64+24
 700 00c0 2246     		mov	r2, r4
 701 00c2 0021     		movs	r1, #0
 702 00c4 5046     		mov	r0, r10
 703 00c6 FFF7FEFF 		bl	memset
 704              	.LVL56:
 199:Service/Srv_Upgrade.c **** 
 705              		.loc 1 199 13 view .LVU178
 199:Service/Srv_Upgrade.c **** 
 706              		.loc 1 199 20 is_stmt 0 view .LVU179
 707 00ca DFF8AC90 		ldr	r9, .L64+4
 199:Service/Srv_Upgrade.c **** 
 708              		.loc 1 199 13 view .LVU180
 709 00ce 2346     		mov	r3, r4
 710 00d0 5246     		mov	r2, r10
 711 00d2 3146     		mov	r1, r6
 712 00d4 0120     		movs	r0, #1
 713 00d6 D9F82870 		ldr	r7, [r9, #40]
 714 00da B847     		blx	r7
 715              	.LVL57:
 201:Service/Srv_Upgrade.c ****             /* write firmware to boot flash */
 716              		.loc 1 201 13 is_stmt 1 view .LVU181
 201:Service/Srv_Upgrade.c ****             /* write firmware to boot flash */
 717              		.loc 1 201 24 is_stmt 0 view .LVU182
 718 00dc DFF8B080 		ldr	r8, .L64+28
 719 00e0 D8F83030 		ldr	r3, [r8, #48]
 201:Service/Srv_Upgrade.c ****             /* write firmware to boot flash */
 720              		.loc 1 201 13 view .LVU183
 721 00e4 9847     		blx	r3
 722              	.LVL58:
 203:Service/Srv_Upgrade.c ****             SrvOsCommon.exit_critical();
 723              		.loc 1 203 13 is_stmt 1 view .LVU184
 203:Service/Srv_Upgrade.c ****             SrvOsCommon.exit_critical();
 724              		.loc 1 203 20 is_stmt 0 view .LVU185
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 25


 725 00e6 D9F82C90 		ldr	r9, [r9, #44]
 203:Service/Srv_Upgrade.c ****             SrvOsCommon.exit_critical();
 726              		.loc 1 203 13 view .LVU186
 727 00ea 0094     		str	r4, [sp]
 728 00ec 5346     		mov	r3, r10
 729 00ee 3246     		mov	r2, r6
 730 00f0 0121     		movs	r1, #1
 731 00f2 0020     		movs	r0, #0
 732 00f4 C847     		blx	r9
 733              	.LVL59:
 204:Service/Srv_Upgrade.c **** 
 734              		.loc 1 204 13 is_stmt 1 view .LVU187
 204:Service/Srv_Upgrade.c **** 
 735              		.loc 1 204 24 is_stmt 0 view .LVU188
 736 00f6 D8F83430 		ldr	r3, [r8, #52]
 204:Service/Srv_Upgrade.c **** 
 737              		.loc 1 204 13 view .LVU189
 738 00fa 9847     		blx	r3
 739              	.LVL60:
 206:Service/Srv_Upgrade.c ****             addr_offset += update_size;
 740              		.loc 1 206 13 is_stmt 1 view .LVU190
 207:Service/Srv_Upgrade.c **** 
 741              		.loc 1 207 13 view .LVU191
 207:Service/Srv_Upgrade.c **** 
 742              		.loc 1 207 25 is_stmt 0 view .LVU192
 743 00fc 2644     		add	r6, r6, r4
 744              	.LVL61:
 209:Service/Srv_Upgrade.c ****             {
 745              		.loc 1 209 13 is_stmt 1 view .LVU193
 209:Service/Srv_Upgrade.c ****             {
 746              		.loc 1 209 16 is_stmt 0 view .LVU194
 747 00fe 2D1B     		subs	r5, r5, r4
 748              	.LVL62:
 209:Service/Srv_Upgrade.c ****             {
 749              		.loc 1 209 16 view .LVU195
 750 0100 D4D1     		bne	.L54
 212:Service/Srv_Upgrade.c ****                 Storage.update(Para_Boot, Monitor.UpgradeInfo_SO.item.data_addr, (uint8_t *)(&Info)
 751              		.loc 1 212 17 is_stmt 1 view .LVU196
 212:Service/Srv_Upgrade.c ****                 Storage.update(Para_Boot, Monitor.UpgradeInfo_SO.item.data_addr, (uint8_t *)(&Info)
 752              		.loc 1 212 38 is_stmt 0 view .LVU197
 753 0102 9DF88C30 		ldrb	r3, [sp, #140]	@ zero_extendqisi2
 754 0106 6FF30003 		bfc	r3, #0, #1
 755 010a 8DF88C30 		strb	r3, [sp, #140]
 213:Service/Srv_Upgrade.c ****             }
 756              		.loc 1 213 17 is_stmt 1 view .LVU198
 213:Service/Srv_Upgrade.c ****             }
 757              		.loc 1 213 24 is_stmt 0 view .LVU199
 758 010e 1A4B     		ldr	r3, .L64+4
 759 0110 DC68     		ldr	r4, [r3, #12]
 760              	.LVL63:
 213:Service/Srv_Upgrade.c ****             }
 761              		.loc 1 213 17 view .LVU200
 762 0112 1923     		movs	r3, #25
 763 0114 23AA     		add	r2, sp, #140
 764 0116 1749     		ldr	r1, .L64
 765 0118 096C     		ldr	r1, [r1, #64]
 766 011a 0020     		movs	r0, #0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 26


 767 011c A047     		blx	r4
 768              	.LVL64:
 769 011e C5E7     		b	.L54
 770              	.LVL65:
 771              	.L61:
 166:Service/Srv_Upgrade.c ****     uint16_t update_size = 0;
 772              		.loc 1 166 14 view .LVU201
 773 0120 0025     		movs	r5, #0
 774 0122 C2E7     		b	.L53
 775              	.L51:
 219:Service/Srv_Upgrade.c ****         memcpy(Info.BF_Info.HW_Ver, HWVer, sizeof(Info.AF_Info.HW_Ver));
 776              		.loc 1 219 9 is_stmt 1 view .LVU202
 777 0124 174B     		ldr	r3, .L64+16
 778 0126 1A88     		ldrh	r2, [r3]	@ unaligned
 779 0128 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 780 012a ADF89E20 		strh	r2, [sp, #158]	@ unaligned
 781 012e 8DF8A030 		strb	r3, [sp, #160]
 220:Service/Srv_Upgrade.c ****         Storage.create(Para_Boot, UpgradeInfo_Sec, (uint8_t *)(&Info), sizeof(SrvUpgradeInfo_TypeDe
 782              		.loc 1 220 9 view .LVU203
 783 0132 ADF89220 		strh	r2, [sp, #146]	@ unaligned
 784 0136 8DF89430 		strb	r3, [sp, #148]
 221:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 785              		.loc 1 221 9 view .LVU204
 221:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 786              		.loc 1 221 16 is_stmt 0 view .LVU205
 787 013a 0F4D     		ldr	r5, .L64+4
 788 013c AE68     		ldr	r6, [r5, #8]
 221:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 789              		.loc 1 221 9 view .LVU206
 790 013e 0F4C     		ldr	r4, .L64+8
 791 0140 1923     		movs	r3, #25
 792 0142 23AA     		add	r2, sp, #140
 793 0144 2146     		mov	r1, r4
 794 0146 0020     		movs	r0, #0
 795 0148 B047     		blx	r6
 796              	.LVL66:
 222:Service/Srv_Upgrade.c ****     }
 797              		.loc 1 222 9 is_stmt 1 view .LVU207
 222:Service/Srv_Upgrade.c ****     }
 798              		.loc 1 222 41 is_stmt 0 view .LVU208
 799 014a 6B68     		ldr	r3, [r5, #4]
 222:Service/Srv_Upgrade.c ****     }
 800              		.loc 1 222 34 view .LVU209
 801 014c 2246     		mov	r2, r4
 802 014e 0021     		movs	r1, #0
 803 0150 10A8     		add	r0, sp, #64
 804 0152 9847     		blx	r3
 805              	.LVL67:
 806 0154 4522     		movs	r2, #69
 807 0156 10A9     		add	r1, sp, #64
 808 0158 0B48     		ldr	r0, .L64+20
 809 015a FFF7FEFF 		bl	memcpy
 810              	.LVL68:
 811              	.L58:
 225:Service/Srv_Upgrade.c ****     {
 812              		.loc 1 225 5 is_stmt 1 view .LVU210
 225:Service/Srv_Upgrade.c ****     {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 27


 813              		.loc 1 225 31 is_stmt 0 view .LVU211
 814 015e 054B     		ldr	r3, .L64
 815 0160 1B69     		ldr	r3, [r3, #16]
 225:Service/Srv_Upgrade.c ****     {
 816              		.loc 1 225 8 view .LVU212
 817 0162 23B9     		cbnz	r3, .L50
 227:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_UpgradeInfo_Error;
 818              		.loc 1 227 9 is_stmt 1 view .LVU213
 227:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_UpgradeInfo_Error;
 819              		.loc 1 227 28 is_stmt 0 view .LVU214
 820 0164 034B     		ldr	r3, .L64
 821 0166 0022     		movs	r2, #0
 822 0168 1A70     		strb	r2, [r3]
 228:Service/Srv_Upgrade.c ****     }
 823              		.loc 1 228 9 is_stmt 1 view .LVU215
 228:Service/Srv_Upgrade.c ****     }
 824              		.loc 1 228 30 is_stmt 0 view .LVU216
 825 016a 0222     		movs	r2, #2
 826 016c 5A70     		strb	r2, [r3, #1]
 827              	.L50:
 230:Service/Srv_Upgrade.c **** 
 828              		.loc 1 230 1 view .LVU217
 829 016e 2AB0     		add	sp, sp, #168
 830              	.LCFI9:
 831              		.cfi_def_cfa_offset 32
 832              		@ sp needed
 833 0170 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 834              	.L65:
 835              		.align	2
 836              	.L64:
 837 0174 00000000 		.word	.LANCHOR0
 838 0178 00000000 		.word	Storage
 839 017c 00000000 		.word	.LC0
 840 0180 00000000 		.word	.LANCHOR1
 841 0184 00000000 		.word	.LANCHOR2
 842 0188 10000000 		.word	.LANCHOR0+16
 843 018c 00000000 		.word	upgrade_buf
 844 0190 00000000 		.word	SrvOsCommon
 845              		.cfi_endproc
 846              	.LFE149:
 848              		.section	.text.SrvUpgrade_Init,"ax",%progbits
 849              		.align	1
 850              		.syntax unified
 851              		.thumb
 852              		.thumb_func
 854              	SrvUpgrade_Init:
 855              	.LFB148:
 126:Service/Srv_Upgrade.c ****     if (sizeof(upgrade_buf) % 2)
 856              		.loc 1 126 1 is_stmt 1 view -0
 857              		.cfi_startproc
 858              		@ args = 0, pretend = 0, frame = 0
 859              		@ frame_needed = 0, uses_anonymous_args = 0
 860 0000 70B5     		push	{r4, r5, r6, lr}
 861              	.LCFI10:
 862              		.cfi_def_cfa_offset 16
 863              		.cfi_offset 4, -16
 864              		.cfi_offset 5, -12
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 28


 865              		.cfi_offset 6, -8
 866              		.cfi_offset 14, -4
 127:Service/Srv_Upgrade.c ****         return false;
 867              		.loc 1 127 5 view .LVU219
 131:Service/Srv_Upgrade.c ****     memset(&Monitor.FileInfo, 0, sizeof(Monitor.FileInfo));
 868              		.loc 1 131 5 view .LVU220
 131:Service/Srv_Upgrade.c ****     memset(&Monitor.FileInfo, 0, sizeof(Monitor.FileInfo));
 869              		.loc 1 131 25 is_stmt 0 view .LVU221
 870 0002 154C     		ldr	r4, .L68
 871 0004 0025     		movs	r5, #0
 872 0006 84F85C50 		strb	r5, [r4, #92]
 132:Service/Srv_Upgrade.c **** 
 873              		.loc 1 132 5 is_stmt 1 view .LVU222
 874 000a 2566     		str	r5, [r4, #96]
 875 000c 6566     		str	r5, [r4, #100]
 876 000e A566     		str	r5, [r4, #104]
 135:Service/Srv_Upgrade.c **** 
 877              		.loc 1 135 5 view .LVU223
 135:Service/Srv_Upgrade.c **** 
 878              		.loc 1 135 30 is_stmt 0 view .LVU224
 879 0010 A4F88454 		strh	r5, [r4, #1156]	@ movhi
 137:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 880              		.loc 1 137 5 is_stmt 1 view .LVU225
 881 0014 4FF48062 		mov	r2, #1024
 882 0018 2946     		mov	r1, r5
 883 001a 04F18400 		add	r0, r4, #132
 884 001e FFF7FEFF 		bl	memset
 885              	.LVL69:
 138:Service/Srv_Upgrade.c ****     
 886              		.loc 1 138 5 view .LVU226
 141:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].size = 0;
 887              		.loc 1 141 5 view .LVU227
 141:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].size = 0;
 888              		.loc 1 141 35 is_stmt 0 view .LVU228
 889 0022 84F86C50 		strb	r5, [r4, #108]
 142:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].total_size = sizeof(upgrade_buf) / 2;
 890              		.loc 1 142 5 is_stmt 1 view .LVU229
 142:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].total_size = sizeof(upgrade_buf) / 2;
 891              		.loc 1 142 33 is_stmt 0 view .LVU230
 892 0026 A4F86E50 		strh	r5, [r4, #110]	@ movhi
 143:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].p_buf = upgrade_buf;
 893              		.loc 1 143 5 is_stmt 1 view .LVU231
 143:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].p_buf = upgrade_buf;
 894              		.loc 1 143 39 is_stmt 0 view .LVU232
 895 002a 4FF40062 		mov	r2, #2048
 896 002e A4F87020 		strh	r2, [r4, #112]	@ movhi
 144:Service/Srv_Upgrade.c **** 
 897              		.loc 1 144 5 is_stmt 1 view .LVU233
 144:Service/Srv_Upgrade.c **** 
 898              		.loc 1 144 34 is_stmt 0 view .LVU234
 899 0032 0A4B     		ldr	r3, .L68+4
 900 0034 6367     		str	r3, [r4, #116]
 146:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].size = 0;
 901              		.loc 1 146 5 is_stmt 1 view .LVU235
 146:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].size = 0;
 902              		.loc 1 146 35 is_stmt 0 view .LVU236
 903 0036 84F87850 		strb	r5, [r4, #120]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 29


 147:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].total_size = sizeof(upgrade_buf) / 2;
 904              		.loc 1 147 5 is_stmt 1 view .LVU237
 147:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].total_size = sizeof(upgrade_buf) / 2;
 905              		.loc 1 147 33 is_stmt 0 view .LVU238
 906 003a A4F87A50 		strh	r5, [r4, #122]	@ movhi
 148:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].p_buf = &upgrade_buf[sizeof(upgrade_buf) / 2];
 907              		.loc 1 148 5 is_stmt 1 view .LVU239
 148:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].p_buf = &upgrade_buf[sizeof(upgrade_buf) / 2];
 908              		.loc 1 148 39 is_stmt 0 view .LVU240
 909 003e A4F87C20 		strh	r2, [r4, #124]	@ movhi
 149:Service/Srv_Upgrade.c **** 
 910              		.loc 1 149 5 is_stmt 1 view .LVU241
 149:Service/Srv_Upgrade.c **** 
 911              		.loc 1 149 34 is_stmt 0 view .LVU242
 912 0042 1344     		add	r3, r3, r2
 913 0044 C4F88030 		str	r3, [r4, #128]
 151:Service/Srv_Upgrade.c ****     Monitor.PollingState = Stage_Init;
 914              		.loc 1 151 5 is_stmt 1 view .LVU243
 151:Service/Srv_Upgrade.c ****     Monitor.PollingState = Stage_Init;
 915              		.loc 1 151 24 is_stmt 0 view .LVU244
 916 0048 0126     		movs	r6, #1
 917 004a 2670     		strb	r6, [r4]
 152:Service/Srv_Upgrade.c ****     Monitor.PortDataState = PortProc_None;
 918              		.loc 1 152 5 is_stmt 1 view .LVU245
 152:Service/Srv_Upgrade.c ****     Monitor.PortDataState = PortProc_None;
 919              		.loc 1 152 26 is_stmt 0 view .LVU246
 920 004c 6570     		strb	r5, [r4, #1]
 153:Service/Srv_Upgrade.c ****     
 921              		.loc 1 153 5 is_stmt 1 view .LVU247
 153:Service/Srv_Upgrade.c ****     
 922              		.loc 1 153 27 is_stmt 0 view .LVU248
 923 004e A570     		strb	r5, [r4, #2]
 159:Service/Srv_Upgrade.c ****     return true;
 924              		.loc 1 159 5 is_stmt 1 view .LVU249
 925 0050 FFF7FEFF 		bl	SrvUpgrade_CheckUpgrade_OnBootUp
 926              	.LVL70:
 160:Service/Srv_Upgrade.c **** }
 927              		.loc 1 160 5 view .LVU250
 161:Service/Srv_Upgrade.c **** 
 928              		.loc 1 161 1 is_stmt 0 view .LVU251
 929 0054 3046     		mov	r0, r6
 930 0056 70BD     		pop	{r4, r5, r6, pc}
 931              	.L69:
 932              		.align	2
 933              	.L68:
 934 0058 00000000 		.word	.LANCHOR0
 935 005c 00000000 		.word	upgrade_buf
 936              		.cfi_endproc
 937              	.LFE148:
 939              		.section	.text.SrvUpgrade_Collect_Info,"ax",%progbits
 940              		.align	1
 941              		.syntax unified
 942              		.thumb
 943              		.thumb_func
 945              	SrvUpgrade_Collect_Info:
 946              	.LVL71:
 947              	.LFB156:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 30


 493:Service/Srv_Upgrade.c ****     va_list args;
 948              		.loc 1 493 1 is_stmt 1 view -0
 949              		.cfi_startproc
 950              		@ args = 4, pretend = 16, frame = 8
 951              		@ frame_needed = 0, uses_anonymous_args = 1
 493:Service/Srv_Upgrade.c ****     va_list args;
 952              		.loc 1 493 1 is_stmt 0 view .LVU253
 953 0000 0FB4     		push	{r0, r1, r2, r3}
 954              	.LCFI11:
 955              		.cfi_def_cfa_offset 16
 956              		.cfi_offset 0, -16
 957              		.cfi_offset 1, -12
 958              		.cfi_offset 2, -8
 959              		.cfi_offset 3, -4
 960 0002 10B5     		push	{r4, lr}
 961              	.LCFI12:
 962              		.cfi_def_cfa_offset 24
 963              		.cfi_offset 4, -24
 964              		.cfi_offset 14, -20
 965 0004 82B0     		sub	sp, sp, #8
 966              	.LCFI13:
 967              		.cfi_def_cfa_offset 32
 968 0006 049A     		ldr	r2, [sp, #16]
 494:Service/Srv_Upgrade.c ****     uint16_t buf_remain = 0;
 969              		.loc 1 494 5 is_stmt 1 view .LVU254
 495:Service/Srv_Upgrade.c ****     uint16_t buf_capacity = sizeof(Monitor.LogOut_Info);
 970              		.loc 1 495 5 view .LVU255
 971              	.LVL72:
 496:Service/Srv_Upgrade.c ****     int16_t send_len = 0;
 972              		.loc 1 496 5 view .LVU256
 497:Service/Srv_Upgrade.c **** 
 973              		.loc 1 497 5 view .LVU257
 499:Service/Srv_Upgrade.c ****     {
 974              		.loc 1 499 5 view .LVU258
 499:Service/Srv_Upgrade.c ****     {
 975              		.loc 1 499 8 is_stmt 0 view .LVU259
 976 0008 2AB1     		cbz	r2, .L70
 499:Service/Srv_Upgrade.c ****     {
 977              		.loc 1 499 27 discriminator 1 view .LVU260
 978 000a 114B     		ldr	r3, .L75
 979 000c B3F88414 		ldrh	r1, [r3, #1156]
 499:Service/Srv_Upgrade.c ****     {
 980              		.loc 1 499 16 discriminator 1 view .LVU261
 981 0010 B1F5806F 		cmp	r1, #1024
 982 0014 04D3     		bcc	.L74
 983              	.LVL73:
 984              	.L70:
 511:Service/Srv_Upgrade.c **** 
 985              		.loc 1 511 1 view .LVU262
 986 0016 02B0     		add	sp, sp, #8
 987              	.LCFI14:
 988              		.cfi_remember_state
 989              		.cfi_def_cfa_offset 24
 990              		@ sp needed
 991 0018 BDE81040 		pop	{r4, lr}
 992              	.LCFI15:
 993              		.cfi_restore 14
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 31


 994              		.cfi_restore 4
 995              		.cfi_def_cfa_offset 16
 996 001c 04B0     		add	sp, sp, #16
 997              	.LCFI16:
 998              		.cfi_restore 3
 999              		.cfi_restore 2
 1000              		.cfi_restore 1
 1001              		.cfi_restore 0
 1002              		.cfi_def_cfa_offset 0
 1003 001e 7047     		bx	lr
 1004              	.LVL74:
 1005              	.L74:
 1006              	.LCFI17:
 1007              		.cfi_restore_state
 501:Service/Srv_Upgrade.c **** 
 1008              		.loc 1 501 9 is_stmt 1 view .LVU263
 501:Service/Srv_Upgrade.c **** 
 1009              		.loc 1 501 20 is_stmt 0 view .LVU264
 1010 0020 C1F58061 		rsb	r1, r1, #1024
 1011              	.LVL75:
 503:Service/Srv_Upgrade.c **** 
 1012              		.loc 1 503 9 is_stmt 1 view .LVU265
 1013 0024 05AB     		add	r3, sp, #20
 1014 0026 0193     		str	r3, [sp, #4]
 505:Service/Srv_Upgrade.c ****         if (send_len > 0)
 1015              		.loc 1 505 9 view .LVU266
 505:Service/Srv_Upgrade.c ****         if (send_len > 0)
 1016              		.loc 1 505 68 is_stmt 0 view .LVU267
 1017 0028 094C     		ldr	r4, .L75
 1018 002a B4F88404 		ldrh	r0, [r4, #1156]
 505:Service/Srv_Upgrade.c ****         if (send_len > 0)
 1019              		.loc 1 505 20 view .LVU268
 1020 002e 8434     		adds	r4, r4, #132
 1021 0030 89B2     		uxth	r1, r1
 505:Service/Srv_Upgrade.c ****         if (send_len > 0)
 1022              		.loc 1 505 20 view .LVU269
 1023 0032 2044     		add	r0, r0, r4
 1024 0034 FFF7FEFF 		bl	vsnprintf
 1025              	.LVL76:
 505:Service/Srv_Upgrade.c ****         if (send_len > 0)
 1026              		.loc 1 505 18 view .LVU270
 1027 0038 03B2     		sxth	r3, r0
 1028              	.LVL77:
 506:Service/Srv_Upgrade.c ****             Monitor.LogOut_Info_size += send_len;
 1029              		.loc 1 506 9 is_stmt 1 view .LVU271
 506:Service/Srv_Upgrade.c ****             Monitor.LogOut_Info_size += send_len;
 1030              		.loc 1 506 12 is_stmt 0 view .LVU272
 1031 003a 002B     		cmp	r3, #0
 1032 003c EBDD     		ble	.L70
 507:Service/Srv_Upgrade.c **** 
 1033              		.loc 1 507 13 is_stmt 1 view .LVU273
 507:Service/Srv_Upgrade.c **** 
 1034              		.loc 1 507 38 is_stmt 0 view .LVU274
 1035 003e A4F18403 		sub	r3, r4, #132
 1036              	.LVL78:
 507:Service/Srv_Upgrade.c **** 
 1037              		.loc 1 507 38 view .LVU275
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 32


 1038 0042 B3F88424 		ldrh	r2, [r3, #1156]
 1039 0046 1044     		add	r0, r0, r2
 1040              	.LVL79:
 507:Service/Srv_Upgrade.c **** 
 1041              		.loc 1 507 38 view .LVU276
 1042 0048 A3F88404 		strh	r0, [r3, #1156]	@ movhi
 509:Service/Srv_Upgrade.c ****     }
 1043              		.loc 1 509 9 is_stmt 1 view .LVU277
 511:Service/Srv_Upgrade.c **** 
 1044              		.loc 1 511 1 is_stmt 0 view .LVU278
 1045 004c E3E7     		b	.L70
 1046              	.L76:
 1047 004e 00BF     		.align	2
 1048              	.L75:
 1049 0050 00000000 		.word	.LANCHOR0
 1050              		.cfi_endproc
 1051              	.LFE156:
 1053              		.section	.rodata.SrvUpgrade_On_PortProc_Finish.str1.4,"aMS",%progbits,1
 1054              		.align	2
 1055              	.LC2:
 1056 0000 09417070 		.ascii	"\011App firmware receive finished\015\012\000"
 1056      20666972 
 1056      6D776172 
 1056      65207265 
 1056      63656976 
 1057 0021 000000   		.align	2
 1058              	.LC3:
 1059 0024 41707020 		.ascii	"App firmware hardware version error\015\012\000"
 1059      6669726D 
 1059      77617265 
 1059      20686172 
 1059      64776172 
 1060 004a 0000     		.align	2
 1061              	.LC4:
 1062 004c 09426F6F 		.ascii	"\011Boot firmware receive finished\015\012\000"
 1062      74206669 
 1062      726D7761 
 1062      72652072 
 1062      65636569 
 1063 006e 0000     		.align	2
 1064              	.LC5:
 1065 0070 426F6F74 		.ascii	"Boot firmware hardware version error\015\012\000"
 1065      20666972 
 1065      6D776172 
 1065      65206861 
 1065      72647761 
 1066 0097 00       		.align	2
 1067              	.LC6:
 1068 0098 0946696C 		.ascii	"\011File size: %d\015\012\000"
 1068      65207369 
 1068      7A653A20 
 1068      25640D0A 
 1068      00
 1069 00a9 000000   		.align	2
 1070              	.LC7:
 1071 00ac 0948573A 		.ascii	"\011HW: %d.%d.%d\015\012\000"
 1071      2025642E 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 33


 1071      25642E25 
 1071      640D0A00 
 1072              		.align	2
 1073              	.LC8:
 1074 00bc 0953573A 		.ascii	"\011SW: %d.%d.%d\015\012\000"
 1074      2025642E 
 1074      25642E25 
 1074      640D0A00 
 1075              		.section	.text.SrvUpgrade_On_PortProc_Finish,"ax",%progbits
 1076              		.align	1
 1077              		.syntax unified
 1078              		.thumb
 1079              		.thumb_func
 1081              	SrvUpgrade_On_PortProc_Finish:
 1082              	.LFB151:
 296:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 1083              		.loc 1 296 1 is_stmt 1 view -0
 1084              		.cfi_startproc
 1085              		@ args = 0, pretend = 0, frame = 56
 1086              		@ frame_needed = 0, uses_anonymous_args = 0
 1087 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 1088              	.LCFI18:
 1089              		.cfi_def_cfa_offset 28
 1090              		.cfi_offset 4, -28
 1091              		.cfi_offset 5, -24
 1092              		.cfi_offset 6, -20
 1093              		.cfi_offset 7, -16
 1094              		.cfi_offset 8, -12
 1095              		.cfi_offset 9, -8
 1096              		.cfi_offset 14, -4
 1097 0004 9FB0     		sub	sp, sp, #124
 1098              	.LCFI19:
 1099              		.cfi_def_cfa_offset 152
 297:Service/Srv_Upgrade.c ****     FileInfo_TypeDef rec_file_info;
 1100              		.loc 1 297 5 view .LVU280
 298:Service/Srv_Upgrade.c **** 
 1101              		.loc 1 298 5 view .LVU281
 300:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 1102              		.loc 1 300 5 view .LVU282
 1103 0006 0023     		movs	r3, #0
 1104 0008 1493     		str	r3, [sp, #80]
 1105 000a 1593     		str	r3, [sp, #84]
 1106 000c 1693     		str	r3, [sp, #88]
 301:Service/Srv_Upgrade.c **** 
 1107              		.loc 1 301 5 view .LVU283
 1108 000e 17AA     		add	r2, sp, #92
 1109 0010 1793     		str	r3, [sp, #92]
 1110 0012 1893     		str	r3, [sp, #96]
 1111 0014 1993     		str	r3, [sp, #100]
 1112 0016 1A93     		str	r3, [sp, #104]
 1113 0018 1B93     		str	r3, [sp, #108]
 1114 001a 1C93     		str	r3, [sp, #112]
 1115 001c 8DF87430 		strb	r3, [sp, #116]
 305:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 1116              		.loc 1 305 5 view .LVU284
 305:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 1117              		.loc 1 305 12 is_stmt 0 view .LVU285
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 34


 1118 0020 4E4B     		ldr	r3, .L89
 1119 0022 1E69     		ldr	r6, [r3, #16]
 305:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 1120              		.loc 1 305 5 view .LVU286
 1121 0024 4E4B     		ldr	r3, .L89+4
 1122 0026 1921     		movs	r1, #25
 1123 0028 0E91     		str	r1, [sp, #56]
 1124 002a 0D92     		str	r2, [sp, #52]
 1125 002c D3F81590 		ldr	r9, [r3, #21]	@ unaligned
 1126 0030 D3F81980 		ldr	r8, [r3, #25]	@ unaligned
 1127 0034 D3F81D70 		ldr	r7, [r3, #29]	@ unaligned
 1128 0038 03F1210C 		add	ip, r3, #33
 1129 003c 6D46     		mov	r5, sp
 1130 003e 03F1510E 		add	lr, r3, #81
 1131              	.L78:
 1132 0042 2C46     		mov	r4, r5
 1133 0044 DCF80000 		ldr	r0, [ip]	@ unaligned
 1134 0048 DCF80410 		ldr	r1, [ip, #4]	@ unaligned
 1135 004c DCF80820 		ldr	r2, [ip, #8]	@ unaligned
 1136 0050 DCF80C30 		ldr	r3, [ip, #12]	@ unaligned
 1137 0054 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 1138 0056 0CF1100C 		add	ip, ip, #16
 1139 005a 2546     		mov	r5, r4
 1140 005c F445     		cmp	ip, lr
 1141 005e F0D1     		bne	.L78
 1142 0060 DCF80000 		ldr	r0, [ip]	@ unaligned
 1143 0064 2060     		str	r0, [r4]
 1144 0066 4946     		mov	r1, r9
 1145 0068 4246     		mov	r2, r8
 1146 006a 3B46     		mov	r3, r7
 1147 006c 0020     		movs	r0, #0
 1148 006e B047     		blx	r6
 1149              	.LVL80:
 306:Service/Srv_Upgrade.c **** 
 1150              		.loc 1 306 5 is_stmt 1 view .LVU287
 306:Service/Srv_Upgrade.c **** 
 1151              		.loc 1 306 35 is_stmt 0 view .LVU288
 1152 0070 3C4B     		ldr	r3, .L89+8
 1153 0072 5B69     		ldr	r3, [r3, #20]
 306:Service/Srv_Upgrade.c **** 
 1154              		.loc 1 306 21 view .LVU289
 1155 0074 10AC     		add	r4, sp, #64
 1156 0076 3A4D     		ldr	r5, .L89+4
 1157 0078 A96D     		ldr	r1, [r5, #88]
 1158 007a 2046     		mov	r0, r4
 1159 007c 9847     		blx	r3
 1160              	.LVL81:
 1161 007e 14AB     		add	r3, sp, #80
 1162 0080 94E80700 		ldm	r4, {r0, r1, r2}
 1163 0084 83E80700 		stm	r3, {r0, r1, r2}
 308:Service/Srv_Upgrade.c ****     {
 1164              		.loc 1 308 5 is_stmt 1 view .LVU290
 308:Service/Srv_Upgrade.c ****     {
 1165              		.loc 1 308 25 is_stmt 0 view .LVU291
 1166 0088 95F86030 		ldrb	r3, [r5, #96]	@ zero_extendqisi2
 308:Service/Srv_Upgrade.c ****     {
 1167              		.loc 1 308 8 view .LVU292
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 35


 1168 008c 012B     		cmp	r3, #1
 1169 008e 29D0     		beq	.L85
 322:Service/Srv_Upgrade.c ****     {
 1170              		.loc 1 322 10 is_stmt 1 view .LVU293
 322:Service/Srv_Upgrade.c ****     {
 1171              		.loc 1 322 13 is_stmt 0 view .LVU294
 1172 0090 022B     		cmp	r3, #2
 1173 0092 45D0     		beq	.L86
 1174              	.L82:
 337:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tHW: %d.%d.%d\r\n", rec_file_info.HW_Ver[0], rec_file_info.HW_Ver[1],
 1175              		.loc 1 337 5 is_stmt 1 view .LVU295
 1176 0094 1699     		ldr	r1, [sp, #88]
 1177 0096 3448     		ldr	r0, .L89+12
 1178 0098 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1179              	.LVL82:
 338:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tSW: %d.%d.%d\r\n", rec_file_info.SW_Ver[0], rec_file_info.SW_Ver[1],
 1180              		.loc 1 338 5 view .LVU296
 1181 009c 9DF85730 		ldrb	r3, [sp, #87]	@ zero_extendqisi2
 1182 00a0 9DF85620 		ldrb	r2, [sp, #86]	@ zero_extendqisi2
 1183 00a4 9DF85510 		ldrb	r1, [sp, #85]	@ zero_extendqisi2
 1184 00a8 3048     		ldr	r0, .L89+16
 1185 00aa FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1186              	.LVL83:
 339:Service/Srv_Upgrade.c ****     Storage.update(Para_Boot, Monitor.UpgradeInfo_SO.item.data_addr, (uint8_t *)&Info, sizeof(SrvUp
 1187              		.loc 1 339 5 view .LVU297
 1188 00ae 9DF85430 		ldrb	r3, [sp, #84]	@ zero_extendqisi2
 1189 00b2 9DF85320 		ldrb	r2, [sp, #83]	@ zero_extendqisi2
 1190 00b6 9DF85210 		ldrb	r1, [sp, #82]	@ zero_extendqisi2
 1191 00ba 2D48     		ldr	r0, .L89+20
 1192 00bc FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1193              	.LVL84:
 340:Service/Srv_Upgrade.c **** 
 1194              		.loc 1 340 5 view .LVU298
 340:Service/Srv_Upgrade.c **** 
 1195              		.loc 1 340 12 is_stmt 0 view .LVU299
 1196 00c0 264B     		ldr	r3, .L89
 1197 00c2 DD68     		ldr	r5, [r3, #12]
 340:Service/Srv_Upgrade.c **** 
 1198              		.loc 1 340 5 view .LVU300
 1199 00c4 264C     		ldr	r4, .L89+4
 1200 00c6 1923     		movs	r3, #25
 1201 00c8 17AA     		add	r2, sp, #92
 1202 00ca 216C     		ldr	r1, [r4, #64]
 1203 00cc 0020     		movs	r0, #0
 1204 00ce A847     		blx	r5
 1205              	.LVL85:
 343:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 1206              		.loc 1 343 5 is_stmt 1 view .LVU301
 343:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 1207              		.loc 1 343 19 is_stmt 0 view .LVU302
 1208 00d0 244B     		ldr	r3, .L89+8
 1209 00d2 9B68     		ldr	r3, [r3, #8]
 343:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 1210              		.loc 1 343 5 view .LVU303
 1211 00d4 A06D     		ldr	r0, [r4, #88]
 1212 00d6 9847     		blx	r3
 1213              	.LVL86:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 36


 344:Service/Srv_Upgrade.c **** 
 1214              		.loc 1 344 5 is_stmt 1 view .LVU304
 344:Service/Srv_Upgrade.c **** 
 1215              		.loc 1 344 25 is_stmt 0 view .LVU305
 1216 00d8 0023     		movs	r3, #0
 1217 00da A365     		str	r3, [r4, #88]
 347:Service/Srv_Upgrade.c **** }
 1218              		.loc 1 347 5 is_stmt 1 view .LVU306
 347:Service/Srv_Upgrade.c **** }
 1219              		.loc 1 347 12 is_stmt 0 view .LVU307
 1220 00dc 0120     		movs	r0, #1
 1221              	.L81:
 348:Service/Srv_Upgrade.c **** 
 1222              		.loc 1 348 1 view .LVU308
 1223 00de 1FB0     		add	sp, sp, #124
 1224              	.LCFI20:
 1225              		.cfi_remember_state
 1226              		.cfi_def_cfa_offset 28
 1227              		@ sp needed
 1228 00e0 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 1229              	.L85:
 1230              	.LCFI21:
 1231              		.cfi_restore_state
 310:Service/Srv_Upgrade.c **** 
 1232              		.loc 1 310 9 is_stmt 1 view .LVU309
 1233 00e4 2348     		ldr	r0, .L89+24
 1234 00e6 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1235              	.LVL87:
 312:Service/Srv_Upgrade.c ****         {
 1236              		.loc 1 312 9 view .LVU310
 312:Service/Srv_Upgrade.c ****         {
 1237              		.loc 1 312 13 is_stmt 0 view .LVU311
 1238 00ea 0322     		movs	r2, #3
 1239 00ec 2249     		ldr	r1, .L89+28
 1240 00ee 0DF16E00 		add	r0, sp, #110
 1241 00f2 FFF7FEFF 		bl	memcmp
 1242              	.LVL88:
 312:Service/Srv_Upgrade.c ****         {
 1243              		.loc 1 312 12 view .LVU312
 1244 00f6 70B9     		cbnz	r0, .L87
 319:Service/Srv_Upgrade.c ****         Info.AF_Info = rec_file_info;
 1245              		.loc 1 319 9 is_stmt 1 view .LVU313
 319:Service/Srv_Upgrade.c ****         Info.AF_Info = rec_file_info;
 1246              		.loc 1 319 29 is_stmt 0 view .LVU314
 1247 00f8 9DF85C30 		ldrb	r3, [sp, #92]	@ zero_extendqisi2
 1248 00fc 43F00203 		orr	r3, r3, #2
 1249 0100 8DF85C30 		strb	r3, [sp, #92]
 320:Service/Srv_Upgrade.c ****     }
 1250              		.loc 1 320 9 is_stmt 1 view .LVU315
 320:Service/Srv_Upgrade.c ****     }
 1251              		.loc 1 320 22 is_stmt 0 view .LVU316
 1252 0104 14AB     		add	r3, sp, #80
 1253 0106 07CB     		ldmia	r3!, {r0, r1, r2}
 1254 0108 CDF86900 		str	r0, [sp, #105]	@ unaligned
 1255 010c CDF86D10 		str	r1, [sp, #109]	@ unaligned
 1256 0110 CDF87120 		str	r2, [sp, #113]	@ unaligned
 1257 0114 BEE7     		b	.L82
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 37


 1258              	.L87:
 314:Service/Srv_Upgrade.c ****             return Stage_Upgrade_Error;
 1259              		.loc 1 314 13 is_stmt 1 view .LVU317
 1260 0116 1948     		ldr	r0, .L89+32
 1261 0118 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1262              	.LVL89:
 315:Service/Srv_Upgrade.c ****         }
 1263              		.loc 1 315 13 view .LVU318
 315:Service/Srv_Upgrade.c ****         }
 1264              		.loc 1 315 20 is_stmt 0 view .LVU319
 1265 011c 0620     		movs	r0, #6
 1266 011e DEE7     		b	.L81
 1267              	.L86:
 324:Service/Srv_Upgrade.c ****         
 1268              		.loc 1 324 9 is_stmt 1 view .LVU320
 1269 0120 1748     		ldr	r0, .L89+36
 1270 0122 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1271              	.LVL90:
 326:Service/Srv_Upgrade.c ****         {
 1272              		.loc 1 326 9 view .LVU321
 326:Service/Srv_Upgrade.c ****         {
 1273              		.loc 1 326 13 is_stmt 0 view .LVU322
 1274 0126 0322     		movs	r2, #3
 1275 0128 1349     		ldr	r1, .L89+28
 1276 012a 0DF16200 		add	r0, sp, #98
 1277 012e FFF7FEFF 		bl	memcmp
 1278              	.LVL91:
 326:Service/Srv_Upgrade.c ****         {
 1279              		.loc 1 326 12 view .LVU323
 1280 0132 70B9     		cbnz	r0, .L88
 333:Service/Srv_Upgrade.c ****         Info.BF_Info = rec_file_info;    /* check for firmware upgrade */
 1281              		.loc 1 333 9 is_stmt 1 view .LVU324
 333:Service/Srv_Upgrade.c ****         Info.BF_Info = rec_file_info;    /* check for firmware upgrade */
 1282              		.loc 1 333 30 is_stmt 0 view .LVU325
 1283 0134 9DF85C30 		ldrb	r3, [sp, #92]	@ zero_extendqisi2
 1284 0138 43F00103 		orr	r3, r3, #1
 1285 013c 8DF85C30 		strb	r3, [sp, #92]
 334:Service/Srv_Upgrade.c ****     }
 1286              		.loc 1 334 9 is_stmt 1 view .LVU326
 334:Service/Srv_Upgrade.c ****     }
 1287              		.loc 1 334 22 is_stmt 0 view .LVU327
 1288 0140 14AB     		add	r3, sp, #80
 1289 0142 07CB     		ldmia	r3!, {r0, r1, r2}
 1290 0144 CDF85D00 		str	r0, [sp, #93]	@ unaligned
 1291 0148 CDF86110 		str	r1, [sp, #97]	@ unaligned
 1292 014c CDF86520 		str	r2, [sp, #101]	@ unaligned
 1293 0150 A0E7     		b	.L82
 1294              	.L88:
 328:Service/Srv_Upgrade.c ****             return Stage_Upgrade_Error;
 1295              		.loc 1 328 13 is_stmt 1 view .LVU328
 1296 0152 0C48     		ldr	r0, .L89+40
 1297 0154 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1298              	.LVL92:
 329:Service/Srv_Upgrade.c ****         }
 1299              		.loc 1 329 13 view .LVU329
 329:Service/Srv_Upgrade.c ****         }
 1300              		.loc 1 329 20 is_stmt 0 view .LVU330
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 38


 1301 0158 0620     		movs	r0, #6
 1302 015a C0E7     		b	.L81
 1303              	.L90:
 1304              		.align	2
 1305              	.L89:
 1306 015c 00000000 		.word	Storage
 1307 0160 00000000 		.word	.LANCHOR0
 1308 0164 00000000 		.word	SrvFileAdapter
 1309 0168 98000000 		.word	.LC6
 1310 016c AC000000 		.word	.LC7
 1311 0170 BC000000 		.word	.LC8
 1312 0174 00000000 		.word	.LC2
 1313 0178 00000000 		.word	.LANCHOR1
 1314 017c 24000000 		.word	.LC3
 1315 0180 4C000000 		.word	.LC4
 1316 0184 70000000 		.word	.LC5
 1317              		.cfi_endproc
 1318              	.LFE151:
 1320              		.section	.rodata.SrvUpgrade_StatePolling.str1.4,"aMS",%progbits,1
 1321              		.align	2
 1322              	.LC9:
 1323 0000 09557067 		.ascii	"\011Upgrade data process error\015\012\000"
 1323      72616465 
 1323      20646174 
 1323      61207072 
 1323      6F636573 
 1324 001e 0000     		.align	2
 1325              	.LC10:
 1326 0020 09446573 		.ascii	"\011Destory adapter object\015\012\000"
 1326      746F7279 
 1326      20616461 
 1326      70746572 
 1326      206F626A 
 1327 003a 0000     		.align	2
 1328              	.LC11:
 1329 003c 09557067 		.ascii	"\011Upgrade abort\015\012\000"
 1329      72616465 
 1329      2061626F 
 1329      72740D0A 
 1329      00
 1330              		.section	.text.SrvUpgrade_StatePolling,"ax",%progbits
 1331              		.align	1
 1332              		.syntax unified
 1333              		.thumb
 1334              		.thumb_func
 1336              	SrvUpgrade_StatePolling:
 1337              	.LVL93:
 1338              	.LFB152:
 351:Service/Srv_Upgrade.c ****     uint8_t i = 0;
 1339              		.loc 1 351 1 is_stmt 1 view -0
 1340              		.cfi_startproc
 1341              		@ args = 0, pretend = 0, frame = 0
 1342              		@ frame_needed = 0, uses_anonymous_args = 0
 351:Service/Srv_Upgrade.c ****     uint8_t i = 0;
 1343              		.loc 1 351 1 is_stmt 0 view .LVU332
 1344 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 1345              	.LCFI22:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 39


 1346              		.cfi_def_cfa_offset 24
 1347              		.cfi_offset 3, -24
 1348              		.cfi_offset 4, -20
 1349              		.cfi_offset 5, -16
 1350              		.cfi_offset 6, -12
 1351              		.cfi_offset 7, -8
 1352              		.cfi_offset 14, -4
 1353 0002 0546     		mov	r5, r0
 1354 0004 0C46     		mov	r4, r1
 352:Service/Srv_Upgrade.c ****     
 1355              		.loc 1 352 5 is_stmt 1 view .LVU333
 1356              	.LVL94:
 354:Service/Srv_Upgrade.c ****     {
 1357              		.loc 1 354 5 view .LVU334
 354:Service/Srv_Upgrade.c ****     {
 1358              		.loc 1 354 26 is_stmt 0 view .LVU335
 1359 0006 4A4B     		ldr	r3, .L111
 1360 0008 93F86030 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
 354:Service/Srv_Upgrade.c ****     {
 1361              		.loc 1 354 55 view .LVU336
 1362 000c 013B     		subs	r3, r3, #1
 1363 000e DBB2     		uxtb	r3, r3
 354:Service/Srv_Upgrade.c ****     {
 1364              		.loc 1 354 8 view .LVU337
 1365 0010 012B     		cmp	r3, #1
 1366 0012 15D9     		bls	.L92
 356:Service/Srv_Upgrade.c ****     }
 1367              		.loc 1 356 9 is_stmt 1 view .LVU338
 356:Service/Srv_Upgrade.c ****     }
 1368              		.loc 1 356 30 is_stmt 0 view .LVU339
 1369 0014 464B     		ldr	r3, .L111
 1370 0016 0422     		movs	r2, #4
 1371 0018 5A70     		strb	r2, [r3, #1]
 1372              	.LVL95:
 1373              	.L93:
 369:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1374              		.loc 1 369 5 is_stmt 1 view .LVU340
 369:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1375              		.loc 1 369 16 is_stmt 0 view .LVU341
 1376 001a 454B     		ldr	r3, .L111
 1377 001c 986D     		ldr	r0, [r3, #88]
 369:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1378              		.loc 1 369 8 view .LVU342
 1379 001e 20B1     		cbz	r0, .L94
 369:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1380              		.loc 1 369 29 discriminator 1 view .LVU343
 1381 0020 1CB1     		cbz	r4, .L94
 370:Service/Srv_Upgrade.c **** 
 1382              		.loc 1 370 9 is_stmt 1 view .LVU344
 370:Service/Srv_Upgrade.c **** 
 1383              		.loc 1 370 23 is_stmt 0 view .LVU345
 1384 0022 444B     		ldr	r3, .L111+4
 1385 0024 DB68     		ldr	r3, [r3, #12]
 370:Service/Srv_Upgrade.c **** 
 1386              		.loc 1 370 9 view .LVU346
 1387 0026 2146     		mov	r1, r4
 1388 0028 9847     		blx	r3
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 40


 1389              	.LVL96:
 1390              	.L94:
 372:Service/Srv_Upgrade.c ****     {
 1391              		.loc 1 372 5 is_stmt 1 view .LVU347
 372:Service/Srv_Upgrade.c ****     {
 1392              		.loc 1 372 30 is_stmt 0 view .LVU348
 1393 002a 414B     		ldr	r3, .L111
 1394 002c 5C78     		ldrb	r4, [r3, #1]	@ zero_extendqisi2
 1395              	.LVL97:
 372:Service/Srv_Upgrade.c ****     {
 1396              		.loc 1 372 5 view .LVU349
 1397 002e 092C     		cmp	r4, #9
 1398 0030 79D8     		bhi	.L95
 1399 0032 DFE804F0 		tbb	[pc, r4]
 1400              	.L97:
 1401 0036 1D       		.byte	(.L101-.L97)/2
 1402 0037 24       		.byte	(.L96-.L97)/2
 1403 0038 24       		.byte	(.L96-.L97)/2
 1404 0039 60       		.byte	(.L99-.L97)/2
 1405 003a 24       		.byte	(.L96-.L97)/2
 1406 003b 4A       		.byte	(.L107-.L97)/2
 1407 003c 60       		.byte	(.L99-.L97)/2
 1408 003d 60       		.byte	(.L99-.L97)/2
 1409 003e 74       		.byte	(.L98-.L97)/2
 1410 003f 24       		.byte	(.L96-.L97)/2
 1411              	.LVL98:
 1412              		.p2align 1
 1413              	.L92:
 361:Service/Srv_Upgrade.c ****         {
 1414              		.loc 1 361 9 is_stmt 1 view .LVU350
 361:Service/Srv_Upgrade.c ****         {
 1415              		.loc 1 361 20 is_stmt 0 view .LVU351
 1416 0040 3B4B     		ldr	r3, .L111
 1417 0042 93F85C30 		ldrb	r3, [r3, #92]	@ zero_extendqisi2
 361:Service/Srv_Upgrade.c ****         {
 1418              		.loc 1 361 12 view .LVU352
 1419 0046 002B     		cmp	r3, #0
 1420 0048 E7D0     		beq	.L93
 361:Service/Srv_Upgrade.c ****         {
 1421              		.loc 1 361 44 discriminator 1 view .LVU353
 1422 004a 394B     		ldr	r3, .L111
 1423 004c 9B6D     		ldr	r3, [r3, #88]
 361:Service/Srv_Upgrade.c ****         {
 1424              		.loc 1 361 33 discriminator 1 view .LVU354
 1425 004e 002B     		cmp	r3, #0
 1426 0050 E3D1     		bne	.L93
 363:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1427              		.loc 1 363 13 is_stmt 1 view .LVU355
 363:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1428              		.loc 1 363 49 is_stmt 0 view .LVU356
 1429 0052 384B     		ldr	r3, .L111+4
 1430 0054 1F68     		ldr	r7, [r3]
 363:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1431              		.loc 1 363 35 view .LVU357
 1432 0056 364E     		ldr	r6, .L111
 1433 0058 06F16003 		add	r3, r6, #96
 1434 005c 0ECB     		ldm	r3, {r1, r2, r3}
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 41


 1435              	.LVL99:
 363:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1436              		.loc 1 363 35 view .LVU358
 1437 005e 96F86100 		ldrb	r0, [r6, #97]	@ zero_extendqisi2
 1438              	.LVL100:
 363:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1439              		.loc 1 363 35 view .LVU359
 1440 0062 B847     		blx	r7
 1441              	.LVL101:
 363:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1442              		.loc 1 363 33 view .LVU360
 1443 0064 B065     		str	r0, [r6, #88]
 364:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_Adapter_Error;
 1444              		.loc 1 364 13 is_stmt 1 view .LVU361
 364:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_Adapter_Error;
 1445              		.loc 1 364 16 is_stmt 0 view .LVU362
 1446 0066 0028     		cmp	r0, #0
 1447 0068 D7D1     		bne	.L93
 365:Service/Srv_Upgrade.c ****         }
 1448              		.loc 1 365 17 is_stmt 1 view .LVU363
 365:Service/Srv_Upgrade.c ****         }
 1449              		.loc 1 365 38 is_stmt 0 view .LVU364
 1450 006a 0322     		movs	r2, #3
 1451 006c 7270     		strb	r2, [r6, #1]
 1452 006e D4E7     		b	.L93
 1453              	.LVL102:
 1454              	.L101:
 375:Service/Srv_Upgrade.c ****             Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1455              		.loc 1 375 13 is_stmt 1 view .LVU365
 375:Service/Srv_Upgrade.c ****             Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1456              		.loc 1 375 34 is_stmt 0 view .LVU366
 1457 0070 2F4B     		ldr	r3, .L111
 1458 0072 0524     		movs	r4, #5
 1459 0074 5C70     		strb	r4, [r3, #1]
 376:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1460              		.loc 1 376 13 is_stmt 1 view .LVU367
 376:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1461              		.loc 1 376 45 is_stmt 0 view .LVU368
 1462 0076 05F56A45 		add	r5, r5, #59904
 1463              	.LVL103:
 376:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1464              		.loc 1 376 45 view .LVU369
 1465 007a 6035     		adds	r5, r5, #96
 1466              	.LVL104:
 376:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1467              		.loc 1 376 34 view .LVU370
 1468 007c 5D60     		str	r5, [r3, #4]
 377:Service/Srv_Upgrade.c **** 
 1469              		.loc 1 377 13 is_stmt 1 view .LVU371
 1470              	.LVL105:
 1471              	.L96:
 454:Service/Srv_Upgrade.c **** 
 1472              		.loc 1 454 1 is_stmt 0 view .LVU372
 1473 007e 2046     		mov	r0, r4
 1474 0080 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1475              	.LVL106:
 1476              	.L110:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 42


 386:Service/Srv_Upgrade.c ****                     break;
 1477              		.loc 1 386 21 is_stmt 1 view .LVU373
 386:Service/Srv_Upgrade.c ****                     break;
 1478              		.loc 1 386 53 is_stmt 0 view .LVU374
 1479 0082 05F56A43 		add	r3, r5, #59904
 1480              	.LVL107:
 386:Service/Srv_Upgrade.c ****                     break;
 1481              		.loc 1 386 53 view .LVU375
 1482 0086 6033     		adds	r3, r3, #96
 386:Service/Srv_Upgrade.c ****                     break;
 1483              		.loc 1 386 42 view .LVU376
 1484 0088 4B60     		str	r3, [r1, #4]
 387:Service/Srv_Upgrade.c ****                 }
 1485              		.loc 1 387 21 is_stmt 1 view .LVU377
 1486              	.L103:
 391:Service/Srv_Upgrade.c ****             {
 1487              		.loc 1 391 13 view .LVU378
 391:Service/Srv_Upgrade.c ****             {
 1488              		.loc 1 391 21 is_stmt 0 view .LVU379
 1489 008a 2846     		mov	r0, r5
 1490 008c FFF7FEFF 		bl	SrvUpgrade_PortProcPolling
 1491              	.LVL108:
 1492 0090 0228     		cmp	r0, #2
 1493 0092 29D0     		beq	.L105
 1494 0094 0328     		cmp	r0, #3
 1495 0096 07D1     		bne	.L106
 394:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1496              		.loc 1 394 21 is_stmt 1 view .LVU380
 394:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1497              		.loc 1 394 44 is_stmt 0 view .LVU381
 1498 0098 FFF7FEFF 		bl	SrvUpgrade_On_PortProc_Finish
 1499              	.LVL109:
 394:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1500              		.loc 1 394 42 view .LVU382
 1501 009c 244A     		ldr	r2, .L111
 1502 009e 5070     		strb	r0, [r2, #1]
 395:Service/Srv_Upgrade.c ****                     break;
 1503              		.loc 1 395 21 is_stmt 1 view .LVU383
 395:Service/Srv_Upgrade.c ****                     break;
 1504              		.loc 1 395 53 is_stmt 0 view .LVU384
 1505 00a0 05F56A43 		add	r3, r5, #59904
 1506 00a4 6033     		adds	r3, r3, #96
 395:Service/Srv_Upgrade.c ****                     break;
 1507              		.loc 1 395 42 view .LVU385
 1508 00a6 5360     		str	r3, [r2, #4]
 396:Service/Srv_Upgrade.c **** 
 1509              		.loc 1 396 21 is_stmt 1 view .LVU386
 1510              	.L106:
 409:Service/Srv_Upgrade.c ****             {
 1511              		.loc 1 409 13 view .LVU387
 409:Service/Srv_Upgrade.c ****             {
 1512              		.loc 1 409 24 is_stmt 0 view .LVU388
 1513 00a8 214B     		ldr	r3, .L111
 1514 00aa 5B68     		ldr	r3, [r3, #4]
 409:Service/Srv_Upgrade.c ****             {
 1515              		.loc 1 409 16 view .LVU389
 1516 00ac AB42     		cmp	r3, r5
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 43


 1517 00ae E6D8     		bhi	.L96
 411:Service/Srv_Upgrade.c ****                 if (Monitor.adapter_obj)
 1518              		.loc 1 411 17 is_stmt 1 view .LVU390
 411:Service/Srv_Upgrade.c ****                 if (Monitor.adapter_obj)
 1519              		.loc 1 411 38 is_stmt 0 view .LVU391
 1520 00b0 1F4B     		ldr	r3, .L111
 1521 00b2 0822     		movs	r2, #8
 1522 00b4 5A70     		strb	r2, [r3, #1]
 412:Service/Srv_Upgrade.c ****                 {
 1523              		.loc 1 412 17 is_stmt 1 view .LVU392
 412:Service/Srv_Upgrade.c ****                 {
 1524              		.loc 1 412 28 is_stmt 0 view .LVU393
 1525 00b6 986D     		ldr	r0, [r3, #88]
 412:Service/Srv_Upgrade.c ****                 {
 1526              		.loc 1 412 20 view .LVU394
 1527 00b8 0028     		cmp	r0, #0
 1528 00ba E0D0     		beq	.L96
 414:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 1529              		.loc 1 414 21 is_stmt 1 view .LVU395
 414:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 1530              		.loc 1 414 35 is_stmt 0 view .LVU396
 1531 00bc 1D4B     		ldr	r3, .L111+4
 1532 00be 9B68     		ldr	r3, [r3, #8]
 414:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 1533              		.loc 1 414 21 view .LVU397
 1534 00c0 9847     		blx	r3
 1535              	.LVL110:
 415:Service/Srv_Upgrade.c ****                 }
 1536              		.loc 1 415 21 is_stmt 1 view .LVU398
 415:Service/Srv_Upgrade.c ****                 }
 1537              		.loc 1 415 41 is_stmt 0 view .LVU399
 1538 00c2 1B4B     		ldr	r3, .L111
 1539 00c4 0022     		movs	r2, #0
 1540 00c6 9A65     		str	r2, [r3, #88]
 1541 00c8 D9E7     		b	.L96
 1542              	.LVL111:
 1543              	.L107:
 372:Service/Srv_Upgrade.c ****     {
 1544              		.loc 1 372 5 view .LVU400
 1545 00ca 0023     		movs	r3, #0
 1546              	.LVL112:
 1547              	.L100:
 381:Service/Srv_Upgrade.c ****             {
 1548              		.loc 1 381 25 is_stmt 1 discriminator 1 view .LVU401
 381:Service/Srv_Upgrade.c ****             {
 1549              		.loc 1 381 13 is_stmt 0 discriminator 1 view .LVU402
 1550 00cc 012B     		cmp	r3, #1
 1551 00ce DCD8     		bhi	.L103
 383:Service/Srv_Upgrade.c ****                 {
 1552              		.loc 1 383 17 is_stmt 1 view .LVU403
 383:Service/Srv_Upgrade.c ****                 {
 1553              		.loc 1 383 43 is_stmt 0 view .LVU404
 1554 00d0 03EB4302 		add	r2, r3, r3, lsl #1
 1555 00d4 1649     		ldr	r1, .L111
 1556 00d6 01EB8202 		add	r2, r1, r2, lsl #2
 1557 00da B2F86E20 		ldrh	r2, [r2, #110]
 383:Service/Srv_Upgrade.c ****                 {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 44


 1558              		.loc 1 383 20 view .LVU405
 1559 00de 002A     		cmp	r2, #0
 1560 00e0 CFD1     		bne	.L110
 381:Service/Srv_Upgrade.c ****             {
 1561              		.loc 1 381 32 is_stmt 1 discriminator 2 view .LVU406
 381:Service/Srv_Upgrade.c ****             {
 1562              		.loc 1 381 33 is_stmt 0 discriminator 2 view .LVU407
 1563 00e2 0133     		adds	r3, r3, #1
 1564              	.LVL113:
 381:Service/Srv_Upgrade.c ****             {
 1565              		.loc 1 381 33 discriminator 2 view .LVU408
 1566 00e4 DBB2     		uxtb	r3, r3
 1567              	.LVL114:
 381:Service/Srv_Upgrade.c ****             {
 1568              		.loc 1 381 33 discriminator 2 view .LVU409
 1569 00e6 F1E7     		b	.L100
 1570              	.LVL115:
 1571              	.L105:
 401:Service/Srv_Upgrade.c ****                     SrvUpgrade_Collect_Info("\tUpgrade data process error\r\n");
 1572              		.loc 1 401 21 is_stmt 1 view .LVU410
 401:Service/Srv_Upgrade.c ****                     SrvUpgrade_Collect_Info("\tUpgrade data process error\r\n");
 1573              		.loc 1 401 42 is_stmt 0 view .LVU411
 1574 00e8 114B     		ldr	r3, .L111
 1575 00ea 0722     		movs	r2, #7
 1576 00ec 5A70     		strb	r2, [r3, #1]
 402:Service/Srv_Upgrade.c ****                     break;
 1577              		.loc 1 402 21 is_stmt 1 view .LVU412
 1578 00ee 1248     		ldr	r0, .L111+8
 1579 00f0 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1580              	.LVL116:
 403:Service/Srv_Upgrade.c **** 
 1581              		.loc 1 403 21 view .LVU413
 1582 00f4 D8E7     		b	.L106
 1583              	.LVL117:
 1584              	.L99:
 435:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj)
 1585              		.loc 1 435 13 view .LVU414
 435:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj)
 1586              		.loc 1 435 34 is_stmt 0 view .LVU415
 1587 00f6 0E4B     		ldr	r3, .L111
 1588 00f8 0022     		movs	r2, #0
 1589 00fa 5A70     		strb	r2, [r3, #1]
 436:Service/Srv_Upgrade.c ****             {
 1590              		.loc 1 436 13 is_stmt 1 view .LVU416
 436:Service/Srv_Upgrade.c ****             {
 1591              		.loc 1 436 24 is_stmt 0 view .LVU417
 1592 00fc 9B6D     		ldr	r3, [r3, #88]
 436:Service/Srv_Upgrade.c ****             {
 1593              		.loc 1 436 16 view .LVU418
 1594 00fe A3B1     		cbz	r3, .L108
 438:Service/Srv_Upgrade.c ****                 SrvUpgrade_Collect_Info("\tUpgrade abort\r\n");
 1595              		.loc 1 438 17 is_stmt 1 view .LVU419
 1596 0100 0E48     		ldr	r0, .L111+12
 1597 0102 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1598              	.LVL118:
 439:Service/Srv_Upgrade.c ****                 SrvFileAdapter.destory(Monitor.adapter_obj);
 1599              		.loc 1 439 17 view .LVU420
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 45


 1600 0106 0E48     		ldr	r0, .L111+16
 1601 0108 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1602              	.LVL119:
 440:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 1603              		.loc 1 440 17 view .LVU421
 440:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 1604              		.loc 1 440 31 is_stmt 0 view .LVU422
 1605 010c 094B     		ldr	r3, .L111+4
 1606 010e 9B68     		ldr	r3, [r3, #8]
 440:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 1607              		.loc 1 440 17 view .LVU423
 1608 0110 074C     		ldr	r4, .L111
 1609 0112 A06D     		ldr	r0, [r4, #88]
 1610 0114 9847     		blx	r3
 1611              	.LVL120:
 441:Service/Srv_Upgrade.c ****             }
 1612              		.loc 1 441 17 is_stmt 1 view .LVU424
 441:Service/Srv_Upgrade.c ****             }
 1613              		.loc 1 441 37 is_stmt 0 view .LVU425
 1614 0116 0023     		movs	r3, #0
 1615 0118 A365     		str	r3, [r4, #88]
 443:Service/Srv_Upgrade.c **** 
 1616              		.loc 1 443 20 view .LVU426
 1617 011a 0324     		movs	r4, #3
 1618 011c AFE7     		b	.L96
 1619              	.L98:
 446:Service/Srv_Upgrade.c ****             return Stage_TimeOut;
 1620              		.loc 1 446 13 is_stmt 1 view .LVU427
 446:Service/Srv_Upgrade.c ****             return Stage_TimeOut;
 1621              		.loc 1 446 34 is_stmt 0 view .LVU428
 1622 011e 044B     		ldr	r3, .L111
 1623 0120 0022     		movs	r2, #0
 1624 0122 5A70     		strb	r2, [r3, #1]
 447:Service/Srv_Upgrade.c **** 
 1625              		.loc 1 447 13 is_stmt 1 view .LVU429
 447:Service/Srv_Upgrade.c **** 
 1626              		.loc 1 447 20 is_stmt 0 view .LVU430
 1627 0124 ABE7     		b	.L96
 1628              	.L95:
 452:Service/Srv_Upgrade.c ****     }
 1629              		.loc 1 452 18 is_stmt 1 view .LVU431
 452:Service/Srv_Upgrade.c ****     }
 1630              		.loc 1 452 25 is_stmt 0 view .LVU432
 1631 0126 0B24     		movs	r4, #11
 1632 0128 A9E7     		b	.L96
 1633              	.L108:
 443:Service/Srv_Upgrade.c **** 
 1634              		.loc 1 443 20 view .LVU433
 1635 012a 0324     		movs	r4, #3
 1636 012c A7E7     		b	.L96
 1637              	.L112:
 1638 012e 00BF     		.align	2
 1639              	.L111:
 1640 0130 00000000 		.word	.LANCHOR0
 1641 0134 00000000 		.word	SrvFileAdapter
 1642 0138 00000000 		.word	.LC9
 1643 013c 20000000 		.word	.LC10
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 46


 1644 0140 3C000000 		.word	.LC11
 1645              		.cfi_endproc
 1646              	.LFE152:
 1648              		.section	.rodata.SrvUpgrade_Show_CurAppVer.str1.4,"aMS",%progbits,1
 1649              		.align	2
 1650              	.LC12:
 1651 0000 5B204375 		.ascii	"[ Current App ] SW Version: %d.%d.%d\015\012\000"
 1651      7272656E 
 1651      74204170 
 1651      70205D20 
 1651      53572056 
 1652              		.section	.text.SrvUpgrade_Show_CurAppVer,"ax",%progbits
 1653              		.align	1
 1654              		.syntax unified
 1655              		.thumb
 1656              		.thumb_func
 1658              	SrvUpgrade_Show_CurAppVer:
 1659              	.LFB159:
 532:Service/Srv_Upgrade.c **** 
 533:Service/Srv_Upgrade.c **** static void SrvUpgrade_Show_CurAppVer(void)
 534:Service/Srv_Upgrade.c **** {
 1660              		.loc 1 534 1 is_stmt 1 view -0
 1661              		.cfi_startproc
 1662              		@ args = 0, pretend = 0, frame = 0
 1663              		@ frame_needed = 0, uses_anonymous_args = 0
 1664 0000 00B5     		push	{lr}
 1665              	.LCFI23:
 1666              		.cfi_def_cfa_offset 4
 1667              		.cfi_offset 14, -4
 1668 0002 83B0     		sub	sp, sp, #12
 1669              	.LCFI24:
 1670              		.cfi_def_cfa_offset 16
 535:Service/Srv_Upgrade.c ****     Shell *shell_obj = Shell_GetInstence();
 1671              		.loc 1 535 5 view .LVU435
 1672              		.loc 1 535 24 is_stmt 0 view .LVU436
 1673 0004 FFF7FEFF 		bl	Shell_GetInstence
 1674              	.LVL121:
 536:Service/Srv_Upgrade.c **** 
 537:Service/Srv_Upgrade.c ****     if (shell_obj)
 1675              		.loc 1 537 5 is_stmt 1 view .LVU437
 1676              		.loc 1 537 8 is_stmt 0 view .LVU438
 1677 0008 30B1     		cbz	r0, .L113
 538:Service/Srv_Upgrade.c ****     {
 539:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ Current App ] SW Version: %d.%d.%d\r\n", AppVer[0], AppVer[1], App
 1678              		.loc 1 539 9 is_stmt 1 view .LVU439
 1679 000a 1123     		movs	r3, #17
 1680 000c 0093     		str	r3, [sp]
 1681 000e 0023     		movs	r3, #0
 1682 0010 1A46     		mov	r2, r3
 1683 0012 0349     		ldr	r1, .L116
 1684 0014 FFF7FEFF 		bl	shellPrint
 1685              	.LVL122:
 1686              	.L113:
 540:Service/Srv_Upgrade.c ****     }
 541:Service/Srv_Upgrade.c **** }
 1687              		.loc 1 541 1 is_stmt 0 view .LVU440
 1688 0018 03B0     		add	sp, sp, #12
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 47


 1689              	.LCFI25:
 1690              		.cfi_def_cfa_offset 4
 1691              		@ sp needed
 1692 001a 5DF804FB 		ldr	pc, [sp], #4
 1693              	.L117:
 1694 001e 00BF     		.align	2
 1695              	.L116:
 1696 0020 00000000 		.word	.LC12
 1697              		.cfi_endproc
 1698              	.LFE159:
 1700              		.section	.rodata.SrvUpgrade_Check_AppFirmware.str1.4,"aMS",%progbits,1
 1701              		.align	2
 1702              	.LC13:
 1703 0000 5B204669 		.ascii	"[ Firmware Info Param ] Read Failed\015\012\000"
 1703      726D7761 
 1703      72652049 
 1703      6E666F20 
 1703      50617261 
 1704 0026 0000     		.align	2
 1705              	.LC14:
 1706 0028 5B204170 		.ascii	"[ App Info ] size: %d\015\012\000"
 1706      7020496E 
 1706      666F205D 
 1706      2073697A 
 1706      653A2025 
 1707              		.align	2
 1708              	.LC15:
 1709 0040 5B204170 		.ascii	"[ App Info ] HW:   %d.%d.%d\015\012\000"
 1709      7020496E 
 1709      666F205D 
 1709      2048573A 
 1709      20202025 
 1710 005e 0000     		.align	2
 1711              	.LC16:
 1712 0060 5B204170 		.ascii	"[ App Info ] SW:   %d.%d.%d\015\012\000"
 1712      7020496E 
 1712      666F205D 
 1712      2053573A 
 1712      20202025 
 1713 007e 0000     		.align	2
 1714              	.LC17:
 1715 0080 20253032 		.ascii	" %02x%02x%02x%02x \000"
 1715      78253032 
 1715      78253032 
 1715      78253032 
 1715      782000
 1716 0093 00       		.align	2
 1717              	.LC18:
 1718 0094 0D0A00   		.ascii	"\015\012\000"
 1719              		.section	.text.SrvUpgrade_Check_AppFirmware,"ax",%progbits
 1720              		.align	1
 1721              		.syntax unified
 1722              		.thumb
 1723              		.thumb_func
 1725              	SrvUpgrade_Check_AppFirmware:
 1726              	.LFB160:
 542:Service/Srv_Upgrade.c **** SHELL_EXPORT_CMD(SHELL_CMD_PERMISSION(0) | SHELL_CMD_TYPE(SHELL_TYPE_CMD_FUNC) | SHELL_CMD_DISABLE_
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 48


 543:Service/Srv_Upgrade.c **** 
 544:Service/Srv_Upgrade.c **** static void SrvUpgrade_Check_AppFirmware(void)
 545:Service/Srv_Upgrade.c **** {
 1727              		.loc 1 545 1 is_stmt 1 view -0
 1728              		.cfi_startproc
 1729              		@ args = 0, pretend = 0, frame = 32
 1730              		@ frame_needed = 0, uses_anonymous_args = 0
 1731 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 1732              	.LCFI26:
 1733              		.cfi_def_cfa_offset 32
 1734              		.cfi_offset 4, -32
 1735              		.cfi_offset 5, -28
 1736              		.cfi_offset 6, -24
 1737              		.cfi_offset 7, -20
 1738              		.cfi_offset 8, -16
 1739              		.cfi_offset 9, -12
 1740              		.cfi_offset 10, -8
 1741              		.cfi_offset 14, -4
 1742 0004 98B0     		sub	sp, sp, #96
 1743              	.LCFI27:
 1744              		.cfi_def_cfa_offset 128
 546:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 1745              		.loc 1 546 5 view .LVU442
 547:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 1746              		.loc 1 547 5 view .LVU443
 1747 0006 0023     		movs	r3, #0
 1748 0008 1193     		str	r3, [sp, #68]
 1749 000a 1293     		str	r3, [sp, #72]
 1750 000c 1393     		str	r3, [sp, #76]
 1751 000e 1493     		str	r3, [sp, #80]
 1752 0010 1593     		str	r3, [sp, #84]
 1753 0012 1693     		str	r3, [sp, #88]
 1754 0014 8DF85C30 		strb	r3, [sp, #92]
 548:Service/Srv_Upgrade.c ****     Shell *shell_obj = Shell_GetInstence();
 1755              		.loc 1 548 5 view .LVU444
 1756              		.loc 1 548 24 is_stmt 0 view .LVU445
 1757 0018 FFF7FEFF 		bl	Shell_GetInstence
 1758              	.LVL123:
 549:Service/Srv_Upgrade.c ****     uint16_t read_size = 0;
 1759              		.loc 1 549 5 is_stmt 1 view .LVU446
 550:Service/Srv_Upgrade.c ****     uint32_t total_size = 0;
 1760              		.loc 1 550 5 view .LVU447
 551:Service/Srv_Upgrade.c ****     uint32_t read_addr_offset = 0;
 1761              		.loc 1 551 5 view .LVU448
 552:Service/Srv_Upgrade.c ****     uint8_t r = 0;
 1762              		.loc 1 552 5 view .LVU449
 553:Service/Srv_Upgrade.c **** 
 554:Service/Srv_Upgrade.c ****     if (shell_obj == NULL)
 1763              		.loc 1 554 5 view .LVU450
 1764              		.loc 1 554 8 is_stmt 0 view .LVU451
 1765 001c 0028     		cmp	r0, #0
 1766 001e 50D0     		beq	.L118
 1767 0020 0746     		mov	r7, r0
 555:Service/Srv_Upgrade.c ****         return;
 556:Service/Srv_Upgrade.c **** 
 557:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 1768              		.loc 1 557 5 is_stmt 1 view .LVU452
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 49


 1769              		.loc 1 557 31 is_stmt 0 view .LVU453
 1770 0022 474B     		ldr	r3, .L135
 1771 0024 1B69     		ldr	r3, [r3, #16]
 1772              		.loc 1 557 8 view .LVU454
 1773 0026 002B     		cmp	r3, #0
 1774 0028 4BD0     		beq	.L118
 558:Service/Srv_Upgrade.c ****     {
 559:Service/Srv_Upgrade.c ****         if (Storage.get(Para_Boot, Monitor.UpgradeInfo_SO.item, (uint8_t *)(&Info), sizeof(SrvUpgra
 1775              		.loc 1 559 9 is_stmt 1 view .LVU455
 1776              		.loc 1 559 20 is_stmt 0 view .LVU456
 1777 002a 464B     		ldr	r3, .L135+4
 1778 002c D3F81080 		ldr	r8, [r3, #16]
 1779              		.loc 1 559 13 view .LVU457
 1780 0030 434B     		ldr	r3, .L135
 1781 0032 1922     		movs	r2, #25
 1782 0034 0E92     		str	r2, [sp, #56]
 1783 0036 11AA     		add	r2, sp, #68
 1784 0038 0D92     		str	r2, [sp, #52]
 1785 003a D3F815A0 		ldr	r10, [r3, #21]	@ unaligned
 1786 003e D3F81990 		ldr	r9, [r3, #25]	@ unaligned
 1787 0042 D3F81DE0 		ldr	lr, [r3, #29]	@ unaligned
 1788 0046 03F12104 		add	r4, r3, #33
 1789 004a 6E46     		mov	r6, sp
 1790 004c 03F1510C 		add	ip, r3, #81
 1791              	.LVL124:
 1792              	.L121:
 1793              		.loc 1 559 13 view .LVU458
 1794 0050 3546     		mov	r5, r6
 1795 0052 2068     		ldr	r0, [r4]	@ unaligned
 1796 0054 6168     		ldr	r1, [r4, #4]	@ unaligned
 1797 0056 A268     		ldr	r2, [r4, #8]	@ unaligned
 1798 0058 E368     		ldr	r3, [r4, #12]	@ unaligned
 1799 005a 0FC5     		stmia	r5!, {r0, r1, r2, r3}
 1800 005c 1034     		adds	r4, r4, #16
 1801 005e 2E46     		mov	r6, r5
 1802 0060 6445     		cmp	r4, ip
 1803 0062 F5D1     		bne	.L121
 1804 0064 2068     		ldr	r0, [r4]	@ unaligned
 1805 0066 2860     		str	r0, [r5]
 1806 0068 5146     		mov	r1, r10
 1807 006a 4A46     		mov	r2, r9
 1808 006c 7346     		mov	r3, lr
 1809 006e 0020     		movs	r0, #0
 1810 0070 C047     		blx	r8
 1811              	.LVL125:
 1812              		.loc 1 559 12 view .LVU459
 1813 0072 8246     		mov	r10, r0
 1814 0074 08BB     		cbnz	r0, .L132
 560:Service/Srv_Upgrade.c ****         {
 561:Service/Srv_Upgrade.c ****             shellPrint(shell_obj, "[ Firmware Info Param ] Read Failed\r\n");
 562:Service/Srv_Upgrade.c ****             return;
 563:Service/Srv_Upgrade.c ****         }
 564:Service/Srv_Upgrade.c **** 
 565:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ App Info ] size: %d\r\n", Info.AF_Info.File_Size);
 1815              		.loc 1 565 9 is_stmt 1 view .LVU460
 1816 0076 DDF85920 		ldr	r2, [sp, #89]	@ unaligned
 1817 007a 3349     		ldr	r1, .L135+8
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 50


 1818 007c 3846     		mov	r0, r7
 1819 007e FFF7FEFF 		bl	shellPrint
 1820              	.LVL126:
 566:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ App Info ] HW:   %d.%d.%d\r\n", Info.AF_Info.HW_Ver[0], Info.AF_In
 1821              		.loc 1 566 9 view .LVU461
 1822              		.loc 1 566 133 is_stmt 0 view .LVU462
 1823 0082 9DF85830 		ldrb	r3, [sp, #88]	@ zero_extendqisi2
 1824              		.loc 1 566 9 view .LVU463
 1825 0086 0093     		str	r3, [sp]
 1826 0088 9DF85730 		ldrb	r3, [sp, #87]	@ zero_extendqisi2
 1827 008c 9DF85620 		ldrb	r2, [sp, #86]	@ zero_extendqisi2
 1828 0090 2E49     		ldr	r1, .L135+12
 1829 0092 3846     		mov	r0, r7
 1830 0094 FFF7FEFF 		bl	shellPrint
 1831              	.LVL127:
 567:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ App Info ] SW:   %d.%d.%d\r\n", Info.AF_Info.SW_Ver[0], Info.AF_In
 1832              		.loc 1 567 9 is_stmt 1 view .LVU464
 1833              		.loc 1 567 133 is_stmt 0 view .LVU465
 1834 0098 9DF85530 		ldrb	r3, [sp, #85]	@ zero_extendqisi2
 1835              		.loc 1 567 9 view .LVU466
 1836 009c 0093     		str	r3, [sp]
 1837 009e 9DF85430 		ldrb	r3, [sp, #84]	@ zero_extendqisi2
 1838 00a2 9DF85320 		ldrb	r2, [sp, #83]	@ zero_extendqisi2
 1839 00a6 2A49     		ldr	r1, .L135+16
 1840 00a8 3846     		mov	r0, r7
 1841 00aa FFF7FEFF 		bl	shellPrint
 1842              	.LVL128:
 568:Service/Srv_Upgrade.c **** 
 569:Service/Srv_Upgrade.c ****         total_size = Info.AF_Info.File_Size;
 1843              		.loc 1 569 9 is_stmt 1 view .LVU467
 1844              		.loc 1 569 20 is_stmt 0 view .LVU468
 1845 00ae DDF85980 		ldr	r8, [sp, #89]	@ unaligned
 1846              	.LVL129:
 570:Service/Srv_Upgrade.c ****         for (uint32_t i = 0; i < total_size; )
 1847              		.loc 1 570 9 is_stmt 1 view .LVU469
 1848              	.LBB4:
 1849              		.loc 1 570 14 view .LVU470
 1850              		.loc 1 570 14 is_stmt 0 view .LVU471
 1851              	.LBE4:
 552:Service/Srv_Upgrade.c **** 
 1852              		.loc 1 552 13 view .LVU472
 1853 00b2 5546     		mov	r5, r10
 551:Service/Srv_Upgrade.c ****     uint8_t r = 0;
 1854              		.loc 1 551 14 view .LVU473
 1855 00b4 4FF00009 		mov	r9, #0
 1856              	.LBB7:
 1857              		.loc 1 570 9 view .LVU474
 1858 00b8 31E0     		b	.L123
 1859              	.LVL130:
 1860              	.L132:
 1861              		.loc 1 570 9 view .LVU475
 1862              	.LBE7:
 561:Service/Srv_Upgrade.c ****             return;
 1863              		.loc 1 561 13 is_stmt 1 view .LVU476
 1864 00ba 2649     		ldr	r1, .L135+20
 1865 00bc 3846     		mov	r0, r7
 1866 00be FFF7FEFF 		bl	shellPrint
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 51


 1867              	.LVL131:
 562:Service/Srv_Upgrade.c ****         }
 1868              		.loc 1 562 13 view .LVU477
 1869              	.L118:
 571:Service/Srv_Upgrade.c ****         {
 572:Service/Srv_Upgrade.c ****             read_size = (1 Kb);
 573:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 574:Service/Srv_Upgrade.c ****                 read_size = total_size;
 575:Service/Srv_Upgrade.c **** 
 576:Service/Srv_Upgrade.c ****             /* read boot firmware */
 577:Service/Srv_Upgrade.c ****             Storage.read_firmware(Firmware_App, read_addr_offset, upgrade_buf, read_size);
 578:Service/Srv_Upgrade.c **** 
 579:Service/Srv_Upgrade.c ****             for (uint16_t j = 0; j < (read_size / 4); j++)
 580:Service/Srv_Upgrade.c ****             {
 581:Service/Srv_Upgrade.c ****                 shellPrint(shell_obj, " %02x%02x%02x%02x ", upgrade_buf[j * 4], upgrade_buf[j * 4 +
 582:Service/Srv_Upgrade.c ****                 r ++;
 583:Service/Srv_Upgrade.c ****                 if (r == 3)
 584:Service/Srv_Upgrade.c ****                 {
 585:Service/Srv_Upgrade.c ****                     r = 0;
 586:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 587:Service/Srv_Upgrade.c ****                 }
 588:Service/Srv_Upgrade.c ****             }
 589:Service/Srv_Upgrade.c ****             memset(upgrade_buf, 0, read_size);
 590:Service/Srv_Upgrade.c ****             total_size -= read_size;
 591:Service/Srv_Upgrade.c ****             if (total_size == 0)
 592:Service/Srv_Upgrade.c ****                 break;
 593:Service/Srv_Upgrade.c ****             
 594:Service/Srv_Upgrade.c ****             read_addr_offset += read_size;
 595:Service/Srv_Upgrade.c ****         }
 596:Service/Srv_Upgrade.c ****     }
 597:Service/Srv_Upgrade.c **** }
 1870              		.loc 1 597 1 is_stmt 0 view .LVU478
 1871 00c2 18B0     		add	sp, sp, #96
 1872              	.LCFI28:
 1873              		.cfi_remember_state
 1874              		.cfi_def_cfa_offset 32
 1875              		@ sp needed
 1876 00c4 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1877              	.LVL132:
 1878              	.L130:
 1879              	.LCFI29:
 1880              		.cfi_restore_state
 1881              	.LBB8:
 572:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 1882              		.loc 1 572 23 view .LVU479
 1883 00c8 4FF48066 		mov	r6, #1024
 1884 00cc 2FE0     		b	.L124
 1885              	.LVL133:
 1886              	.L134:
 1887              	.LBB5:
 585:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 1888              		.loc 1 585 21 is_stmt 1 view .LVU480
 586:Service/Srv_Upgrade.c ****                 }
 1889              		.loc 1 586 21 view .LVU481
 1890 00ce 2249     		ldr	r1, .L135+24
 1891 00d0 3846     		mov	r0, r7
 1892 00d2 FFF7FEFF 		bl	shellPrint
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 52


 1893              	.LVL134:
 585:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 1894              		.loc 1 585 23 is_stmt 0 view .LVU482
 1895 00d6 5546     		mov	r5, r10
 1896              	.LVL135:
 1897              	.L126:
 579:Service/Srv_Upgrade.c ****             {
 1898              		.loc 1 579 55 is_stmt 1 discriminator 2 view .LVU483
 579:Service/Srv_Upgrade.c ****             {
 1899              		.loc 1 579 56 is_stmt 0 discriminator 2 view .LVU484
 1900 00d8 0134     		adds	r4, r4, #1
 1901              	.LVL136:
 579:Service/Srv_Upgrade.c ****             {
 1902              		.loc 1 579 56 discriminator 2 view .LVU485
 1903 00da A4B2     		uxth	r4, r4
 1904              	.LVL137:
 1905              	.L125:
 579:Service/Srv_Upgrade.c ****             {
 1906              		.loc 1 579 34 is_stmt 1 discriminator 1 view .LVU486
 579:Service/Srv_Upgrade.c ****             {
 1907              		.loc 1 579 13 is_stmt 0 discriminator 1 view .LVU487
 1908 00dc B4EB960F 		cmp	r4, r6, lsr #2
 1909 00e0 14D2     		bcs	.L133
 581:Service/Srv_Upgrade.c ****                 r ++;
 1910              		.loc 1 581 17 is_stmt 1 view .LVU488
 581:Service/Srv_Upgrade.c ****                 r ++;
 1911              		.loc 1 581 75 is_stmt 0 view .LVU489
 1912 00e2 A300     		lsls	r3, r4, #2
 581:Service/Srv_Upgrade.c ****                 r ++;
 1913              		.loc 1 581 72 view .LVU490
 1914 00e4 1D4A     		ldr	r2, .L135+28
 581:Service/Srv_Upgrade.c ****                 r ++;
 1915              		.loc 1 581 99 view .LVU491
 1916 00e6 591C     		adds	r1, r3, #1
 581:Service/Srv_Upgrade.c ****                 r ++;
 1917              		.loc 1 581 123 view .LVU492
 1918 00e8 981C     		adds	r0, r3, #2
 581:Service/Srv_Upgrade.c ****                 r ++;
 1919              		.loc 1 581 116 view .LVU493
 1920 00ea 105C     		ldrb	r0, [r2, r0]	@ zero_extendqisi2
 581:Service/Srv_Upgrade.c ****                 r ++;
 1921              		.loc 1 581 147 view .LVU494
 1922 00ec 0333     		adds	r3, r3, #3
 581:Service/Srv_Upgrade.c ****                 r ++;
 1923              		.loc 1 581 140 view .LVU495
 1924 00ee D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
 581:Service/Srv_Upgrade.c ****                 r ++;
 1925              		.loc 1 581 17 view .LVU496
 1926 00f0 0193     		str	r3, [sp, #4]
 1927 00f2 0090     		str	r0, [sp]
 1928 00f4 535C     		ldrb	r3, [r2, r1]	@ zero_extendqisi2
 1929 00f6 12F82420 		ldrb	r2, [r2, r4, lsl #2]	@ zero_extendqisi2
 1930 00fa 1949     		ldr	r1, .L135+32
 1931 00fc 3846     		mov	r0, r7
 1932 00fe FFF7FEFF 		bl	shellPrint
 1933              	.LVL138:
 582:Service/Srv_Upgrade.c ****                 if (r == 3)
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 53


 1934              		.loc 1 582 17 is_stmt 1 view .LVU497
 582:Service/Srv_Upgrade.c ****                 if (r == 3)
 1935              		.loc 1 582 19 is_stmt 0 view .LVU498
 1936 0102 0135     		adds	r5, r5, #1
 1937              	.LVL139:
 582:Service/Srv_Upgrade.c ****                 if (r == 3)
 1938              		.loc 1 582 19 view .LVU499
 1939 0104 EDB2     		uxtb	r5, r5
 1940              	.LVL140:
 583:Service/Srv_Upgrade.c ****                 {
 1941              		.loc 1 583 17 is_stmt 1 view .LVU500
 583:Service/Srv_Upgrade.c ****                 {
 1942              		.loc 1 583 20 is_stmt 0 view .LVU501
 1943 0106 032D     		cmp	r5, #3
 1944 0108 E6D1     		bne	.L126
 1945 010a E0E7     		b	.L134
 1946              	.L133:
 583:Service/Srv_Upgrade.c ****                 {
 1947              		.loc 1 583 20 view .LVU502
 1948              	.LBE5:
 589:Service/Srv_Upgrade.c ****             total_size -= read_size;
 1949              		.loc 1 589 13 is_stmt 1 view .LVU503
 1950 010c 3246     		mov	r2, r6
 1951 010e 0021     		movs	r1, #0
 1952 0110 1248     		ldr	r0, .L135+28
 1953 0112 FFF7FEFF 		bl	memset
 1954              	.LVL141:
 590:Service/Srv_Upgrade.c ****             if (total_size == 0)
 1955              		.loc 1 590 13 view .LVU504
 591:Service/Srv_Upgrade.c ****                 break;
 1956              		.loc 1 591 13 view .LVU505
 591:Service/Srv_Upgrade.c ****                 break;
 1957              		.loc 1 591 16 is_stmt 0 view .LVU506
 1958 0116 B8EB0608 		subs	r8, r8, r6
 1959              	.LVL142:
 591:Service/Srv_Upgrade.c ****                 break;
 1960              		.loc 1 591 16 view .LVU507
 1961 011a D2D0     		beq	.L118
 594:Service/Srv_Upgrade.c ****         }
 1962              		.loc 1 594 13 is_stmt 1 view .LVU508
 594:Service/Srv_Upgrade.c ****         }
 1963              		.loc 1 594 30 is_stmt 0 view .LVU509
 1964 011c B144     		add	r9, r9, r6
 1965              	.LVL143:
 1966              	.L123:
 570:Service/Srv_Upgrade.c ****         {
 1967              		.loc 1 570 30 is_stmt 1 discriminator 1 view .LVU510
 570:Service/Srv_Upgrade.c ****         {
 1968              		.loc 1 570 9 is_stmt 0 discriminator 1 view .LVU511
 1969 011e B8F1000F 		cmp	r8, #0
 1970 0122 CED0     		beq	.L118
 572:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 1971              		.loc 1 572 13 is_stmt 1 view .LVU512
 1972              	.LVL144:
 573:Service/Srv_Upgrade.c ****                 read_size = total_size;
 1973              		.loc 1 573 13 view .LVU513
 573:Service/Srv_Upgrade.c ****                 read_size = total_size;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 54


 1974              		.loc 1 573 16 is_stmt 0 view .LVU514
 1975 0124 B8F5806F 		cmp	r8, #1024
 1976 0128 CED2     		bcs	.L130
 574:Service/Srv_Upgrade.c **** 
 1977              		.loc 1 574 17 is_stmt 1 view .LVU515
 574:Service/Srv_Upgrade.c **** 
 1978              		.loc 1 574 27 is_stmt 0 view .LVU516
 1979 012a 1FFA88F6 		uxth	r6, r8
 1980              	.LVL145:
 1981              	.L124:
 577:Service/Srv_Upgrade.c **** 
 1982              		.loc 1 577 13 is_stmt 1 view .LVU517
 577:Service/Srv_Upgrade.c **** 
 1983              		.loc 1 577 20 is_stmt 0 view .LVU518
 1984 012e 054B     		ldr	r3, .L135+4
 1985 0130 9C6A     		ldr	r4, [r3, #40]
 577:Service/Srv_Upgrade.c **** 
 1986              		.loc 1 577 13 view .LVU519
 1987 0132 3346     		mov	r3, r6
 1988 0134 094A     		ldr	r2, .L135+28
 1989 0136 4946     		mov	r1, r9
 1990 0138 0220     		movs	r0, #2
 1991 013a A047     		blx	r4
 1992              	.LVL146:
 579:Service/Srv_Upgrade.c ****             {
 1993              		.loc 1 579 13 is_stmt 1 view .LVU520
 1994              	.LBB6:
 579:Service/Srv_Upgrade.c ****             {
 1995              		.loc 1 579 18 view .LVU521
 579:Service/Srv_Upgrade.c ****             {
 1996              		.loc 1 579 27 is_stmt 0 view .LVU522
 1997 013c 0024     		movs	r4, #0
 579:Service/Srv_Upgrade.c ****             {
 1998              		.loc 1 579 13 view .LVU523
 1999 013e CDE7     		b	.L125
 2000              	.L136:
 2001              		.align	2
 2002              	.L135:
 2003 0140 00000000 		.word	.LANCHOR0
 2004 0144 00000000 		.word	Storage
 2005 0148 28000000 		.word	.LC14
 2006 014c 40000000 		.word	.LC15
 2007 0150 60000000 		.word	.LC16
 2008 0154 00000000 		.word	.LC13
 2009 0158 94000000 		.word	.LC18
 2010 015c 00000000 		.word	upgrade_buf
 2011 0160 80000000 		.word	.LC17
 2012              	.LBE6:
 2013              	.LBE8:
 2014              		.cfi_endproc
 2015              	.LFE160:
 2017              		.section	.rodata.SrvUpgrade_Check_BootFirmware.str1.4,"aMS",%progbits,1
 2018              		.align	2
 2019              	.LC19:
 2020 0000 5B20426F 		.ascii	"[ Boot Info ] size: %d\015\012\000"
 2020      6F742049 
 2020      6E666F20 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 55


 2020      5D207369 
 2020      7A653A20 
 2021 0019 000000   		.align	2
 2022              	.LC20:
 2023 001c 5B20426F 		.ascii	"[ Boot Info ] HW:   %d.%d.%d\015\012\000"
 2023      6F742049 
 2023      6E666F20 
 2023      5D204857 
 2023      3A202020 
 2024 003b 00       		.align	2
 2025              	.LC21:
 2026 003c 5B20426F 		.ascii	"[ Boot Info ] SW:   %d.%d.%d\015\012\000"
 2026      6F742049 
 2026      6E666F20 
 2026      5D205357 
 2026      3A202020 
 2027              		.section	.text.SrvUpgrade_Check_BootFirmware,"ax",%progbits
 2028              		.align	1
 2029              		.syntax unified
 2030              		.thumb
 2031              		.thumb_func
 2033              	SrvUpgrade_Check_BootFirmware:
 2034              	.LFB161:
 598:Service/Srv_Upgrade.c **** SHELL_EXPORT_CMD(SHELL_CMD_PERMISSION(0) | SHELL_CMD_TYPE(SHELL_TYPE_CMD_FUNC) | SHELL_CMD_DISABLE_
 599:Service/Srv_Upgrade.c **** 
 600:Service/Srv_Upgrade.c **** static void SrvUpgrade_Check_BootFirmware(void)
 601:Service/Srv_Upgrade.c **** {
 2035              		.loc 1 601 1 is_stmt 1 view -0
 2036              		.cfi_startproc
 2037              		@ args = 0, pretend = 0, frame = 32
 2038              		@ frame_needed = 0, uses_anonymous_args = 0
 2039 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 2040              	.LCFI30:
 2041              		.cfi_def_cfa_offset 32
 2042              		.cfi_offset 4, -32
 2043              		.cfi_offset 5, -28
 2044              		.cfi_offset 6, -24
 2045              		.cfi_offset 7, -20
 2046              		.cfi_offset 8, -16
 2047              		.cfi_offset 9, -12
 2048              		.cfi_offset 10, -8
 2049              		.cfi_offset 14, -4
 2050 0004 98B0     		sub	sp, sp, #96
 2051              	.LCFI31:
 2052              		.cfi_def_cfa_offset 128
 602:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 2053              		.loc 1 602 5 view .LVU525
 603:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 2054              		.loc 1 603 5 view .LVU526
 2055 0006 0023     		movs	r3, #0
 2056 0008 1193     		str	r3, [sp, #68]
 2057 000a 1293     		str	r3, [sp, #72]
 2058 000c 1393     		str	r3, [sp, #76]
 2059 000e 1493     		str	r3, [sp, #80]
 2060 0010 1593     		str	r3, [sp, #84]
 2061 0012 1693     		str	r3, [sp, #88]
 2062 0014 8DF85C30 		strb	r3, [sp, #92]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 56


 604:Service/Srv_Upgrade.c ****     Shell *shell_obj = Shell_GetInstence();
 2063              		.loc 1 604 5 view .LVU527
 2064              		.loc 1 604 24 is_stmt 0 view .LVU528
 2065 0018 FFF7FEFF 		bl	Shell_GetInstence
 2066              	.LVL147:
 605:Service/Srv_Upgrade.c ****     uint16_t read_size = 0;
 2067              		.loc 1 605 5 is_stmt 1 view .LVU529
 606:Service/Srv_Upgrade.c ****     uint32_t total_size = 0;
 2068              		.loc 1 606 5 view .LVU530
 607:Service/Srv_Upgrade.c ****     uint32_t read_addr_offset = 0;
 2069              		.loc 1 607 5 view .LVU531
 608:Service/Srv_Upgrade.c ****     uint8_t r = 0;
 2070              		.loc 1 608 5 view .LVU532
 609:Service/Srv_Upgrade.c **** 
 610:Service/Srv_Upgrade.c ****     if (shell_obj == NULL)
 2071              		.loc 1 610 5 view .LVU533
 2072              		.loc 1 610 8 is_stmt 0 view .LVU534
 2073 001c 0028     		cmp	r0, #0
 2074 001e 50D0     		beq	.L137
 2075 0020 0746     		mov	r7, r0
 611:Service/Srv_Upgrade.c ****         return;
 612:Service/Srv_Upgrade.c **** 
 613:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 2076              		.loc 1 613 5 is_stmt 1 view .LVU535
 2077              		.loc 1 613 31 is_stmt 0 view .LVU536
 2078 0022 474B     		ldr	r3, .L154
 2079 0024 1B69     		ldr	r3, [r3, #16]
 2080              		.loc 1 613 8 view .LVU537
 2081 0026 002B     		cmp	r3, #0
 2082 0028 4BD0     		beq	.L137
 614:Service/Srv_Upgrade.c ****     {
 615:Service/Srv_Upgrade.c ****         if (Storage.get(Para_Boot, Monitor.UpgradeInfo_SO.item, (uint8_t *)(&Info), sizeof(SrvUpgra
 2083              		.loc 1 615 9 is_stmt 1 view .LVU538
 2084              		.loc 1 615 20 is_stmt 0 view .LVU539
 2085 002a 464B     		ldr	r3, .L154+4
 2086 002c D3F81080 		ldr	r8, [r3, #16]
 2087              		.loc 1 615 13 view .LVU540
 2088 0030 434B     		ldr	r3, .L154
 2089 0032 1922     		movs	r2, #25
 2090 0034 0E92     		str	r2, [sp, #56]
 2091 0036 11AA     		add	r2, sp, #68
 2092 0038 0D92     		str	r2, [sp, #52]
 2093 003a D3F815A0 		ldr	r10, [r3, #21]	@ unaligned
 2094 003e D3F81990 		ldr	r9, [r3, #25]	@ unaligned
 2095 0042 D3F81DE0 		ldr	lr, [r3, #29]	@ unaligned
 2096 0046 03F12104 		add	r4, r3, #33
 2097 004a 6E46     		mov	r6, sp
 2098 004c 03F1510C 		add	ip, r3, #81
 2099              	.LVL148:
 2100              	.L140:
 2101              		.loc 1 615 13 view .LVU541
 2102 0050 3546     		mov	r5, r6
 2103 0052 2068     		ldr	r0, [r4]	@ unaligned
 2104 0054 6168     		ldr	r1, [r4, #4]	@ unaligned
 2105 0056 A268     		ldr	r2, [r4, #8]	@ unaligned
 2106 0058 E368     		ldr	r3, [r4, #12]	@ unaligned
 2107 005a 0FC5     		stmia	r5!, {r0, r1, r2, r3}
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 57


 2108 005c 1034     		adds	r4, r4, #16
 2109 005e 2E46     		mov	r6, r5
 2110 0060 6445     		cmp	r4, ip
 2111 0062 F5D1     		bne	.L140
 2112 0064 2068     		ldr	r0, [r4]	@ unaligned
 2113 0066 2860     		str	r0, [r5]
 2114 0068 5146     		mov	r1, r10
 2115 006a 4A46     		mov	r2, r9
 2116 006c 7346     		mov	r3, lr
 2117 006e 0020     		movs	r0, #0
 2118 0070 C047     		blx	r8
 2119              	.LVL149:
 2120              		.loc 1 615 12 view .LVU542
 2121 0072 8246     		mov	r10, r0
 2122 0074 08BB     		cbnz	r0, .L151
 616:Service/Srv_Upgrade.c ****         {
 617:Service/Srv_Upgrade.c ****             shellPrint(shell_obj, "[ Firmware Info Param ] Read Failed\r\n");
 618:Service/Srv_Upgrade.c ****             return;
 619:Service/Srv_Upgrade.c ****         }
 620:Service/Srv_Upgrade.c **** 
 621:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ Boot Info ] size: %d\r\n", Info.BF_Info.File_Size);
 2123              		.loc 1 621 9 is_stmt 1 view .LVU543
 2124 0076 DDF84D20 		ldr	r2, [sp, #77]	@ unaligned
 2125 007a 3349     		ldr	r1, .L154+8
 2126 007c 3846     		mov	r0, r7
 2127 007e FFF7FEFF 		bl	shellPrint
 2128              	.LVL150:
 622:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ Boot Info ] HW:   %d.%d.%d\r\n", Info.BF_Info.HW_Ver[0], Info.BF_I
 2129              		.loc 1 622 9 view .LVU544
 2130              		.loc 1 622 134 is_stmt 0 view .LVU545
 2131 0082 9DF84C30 		ldrb	r3, [sp, #76]	@ zero_extendqisi2
 2132              		.loc 1 622 9 view .LVU546
 2133 0086 0093     		str	r3, [sp]
 2134 0088 9DF84B30 		ldrb	r3, [sp, #75]	@ zero_extendqisi2
 2135 008c 9DF84A20 		ldrb	r2, [sp, #74]	@ zero_extendqisi2
 2136 0090 2E49     		ldr	r1, .L154+12
 2137 0092 3846     		mov	r0, r7
 2138 0094 FFF7FEFF 		bl	shellPrint
 2139              	.LVL151:
 623:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ Boot Info ] SW:   %d.%d.%d\r\n", Info.BF_Info.SW_Ver[0], Info.BF_I
 2140              		.loc 1 623 9 is_stmt 1 view .LVU547
 2141              		.loc 1 623 134 is_stmt 0 view .LVU548
 2142 0098 9DF84930 		ldrb	r3, [sp, #73]	@ zero_extendqisi2
 2143              		.loc 1 623 9 view .LVU549
 2144 009c 0093     		str	r3, [sp]
 2145 009e 9DF84830 		ldrb	r3, [sp, #72]	@ zero_extendqisi2
 2146 00a2 9DF84720 		ldrb	r2, [sp, #71]	@ zero_extendqisi2
 2147 00a6 2A49     		ldr	r1, .L154+16
 2148 00a8 3846     		mov	r0, r7
 2149 00aa FFF7FEFF 		bl	shellPrint
 2150              	.LVL152:
 624:Service/Srv_Upgrade.c **** 
 625:Service/Srv_Upgrade.c ****         total_size = Info.AF_Info.File_Size;
 2151              		.loc 1 625 9 is_stmt 1 view .LVU550
 2152              		.loc 1 625 20 is_stmt 0 view .LVU551
 2153 00ae DDF85980 		ldr	r8, [sp, #89]	@ unaligned
 2154              	.LVL153:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 58


 626:Service/Srv_Upgrade.c ****         for (uint32_t i = 0; i < total_size; )
 2155              		.loc 1 626 9 is_stmt 1 view .LVU552
 2156              	.LBB9:
 2157              		.loc 1 626 14 view .LVU553
 2158              		.loc 1 626 14 is_stmt 0 view .LVU554
 2159              	.LBE9:
 608:Service/Srv_Upgrade.c **** 
 2160              		.loc 1 608 13 view .LVU555
 2161 00b2 5546     		mov	r5, r10
 607:Service/Srv_Upgrade.c ****     uint8_t r = 0;
 2162              		.loc 1 607 14 view .LVU556
 2163 00b4 4FF00009 		mov	r9, #0
 2164              	.LBB12:
 2165              		.loc 1 626 9 view .LVU557
 2166 00b8 31E0     		b	.L142
 2167              	.LVL154:
 2168              	.L151:
 2169              		.loc 1 626 9 view .LVU558
 2170              	.LBE12:
 617:Service/Srv_Upgrade.c ****             return;
 2171              		.loc 1 617 13 is_stmt 1 view .LVU559
 2172 00ba 2649     		ldr	r1, .L154+20
 2173 00bc 3846     		mov	r0, r7
 2174 00be FFF7FEFF 		bl	shellPrint
 2175              	.LVL155:
 618:Service/Srv_Upgrade.c ****         }
 2176              		.loc 1 618 13 view .LVU560
 2177              	.L137:
 627:Service/Srv_Upgrade.c ****         {
 628:Service/Srv_Upgrade.c ****             read_size = (1 Kb);
 629:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 630:Service/Srv_Upgrade.c ****                 read_size = total_size;
 631:Service/Srv_Upgrade.c **** 
 632:Service/Srv_Upgrade.c ****             /* read boot firmware */
 633:Service/Srv_Upgrade.c ****             Storage.read_firmware(Firmware_App, read_addr_offset, upgrade_buf, read_size);
 634:Service/Srv_Upgrade.c **** 
 635:Service/Srv_Upgrade.c ****             for (uint16_t j = 0; j < (read_size / 4); j++)
 636:Service/Srv_Upgrade.c ****             {
 637:Service/Srv_Upgrade.c ****                 shellPrint(shell_obj, " %02x%02x%02x%02x ", upgrade_buf[j * 4], upgrade_buf[j * 4 +
 638:Service/Srv_Upgrade.c ****                 r ++;
 639:Service/Srv_Upgrade.c ****                 if (r == 3)
 640:Service/Srv_Upgrade.c ****                 {
 641:Service/Srv_Upgrade.c ****                     r = 0;
 642:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 643:Service/Srv_Upgrade.c ****                 }
 644:Service/Srv_Upgrade.c ****             }
 645:Service/Srv_Upgrade.c ****             memset(upgrade_buf, 0, read_size);
 646:Service/Srv_Upgrade.c ****             total_size -= read_size;
 647:Service/Srv_Upgrade.c ****             if (total_size == 0)
 648:Service/Srv_Upgrade.c ****                 break;
 649:Service/Srv_Upgrade.c ****             
 650:Service/Srv_Upgrade.c ****             read_addr_offset += read_size;
 651:Service/Srv_Upgrade.c ****         }
 652:Service/Srv_Upgrade.c ****     }
 653:Service/Srv_Upgrade.c **** }
 2178              		.loc 1 653 1 is_stmt 0 view .LVU561
 2179 00c2 18B0     		add	sp, sp, #96
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 59


 2180              	.LCFI32:
 2181              		.cfi_remember_state
 2182              		.cfi_def_cfa_offset 32
 2183              		@ sp needed
 2184 00c4 BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 2185              	.LVL156:
 2186              	.L149:
 2187              	.LCFI33:
 2188              		.cfi_restore_state
 2189              	.LBB13:
 628:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 2190              		.loc 1 628 23 view .LVU562
 2191 00c8 4FF48066 		mov	r6, #1024
 2192 00cc 2FE0     		b	.L143
 2193              	.LVL157:
 2194              	.L153:
 2195              	.LBB10:
 641:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 2196              		.loc 1 641 21 is_stmt 1 view .LVU563
 642:Service/Srv_Upgrade.c ****                 }
 2197              		.loc 1 642 21 view .LVU564
 2198 00ce 2249     		ldr	r1, .L154+24
 2199 00d0 3846     		mov	r0, r7
 2200 00d2 FFF7FEFF 		bl	shellPrint
 2201              	.LVL158:
 641:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 2202              		.loc 1 641 23 is_stmt 0 view .LVU565
 2203 00d6 5546     		mov	r5, r10
 2204              	.LVL159:
 2205              	.L145:
 635:Service/Srv_Upgrade.c ****             {
 2206              		.loc 1 635 55 is_stmt 1 discriminator 2 view .LVU566
 635:Service/Srv_Upgrade.c ****             {
 2207              		.loc 1 635 56 is_stmt 0 discriminator 2 view .LVU567
 2208 00d8 0134     		adds	r4, r4, #1
 2209              	.LVL160:
 635:Service/Srv_Upgrade.c ****             {
 2210              		.loc 1 635 56 discriminator 2 view .LVU568
 2211 00da A4B2     		uxth	r4, r4
 2212              	.LVL161:
 2213              	.L144:
 635:Service/Srv_Upgrade.c ****             {
 2214              		.loc 1 635 34 is_stmt 1 discriminator 1 view .LVU569
 635:Service/Srv_Upgrade.c ****             {
 2215              		.loc 1 635 13 is_stmt 0 discriminator 1 view .LVU570
 2216 00dc B4EB960F 		cmp	r4, r6, lsr #2
 2217 00e0 14D2     		bcs	.L152
 637:Service/Srv_Upgrade.c ****                 r ++;
 2218              		.loc 1 637 17 is_stmt 1 view .LVU571
 637:Service/Srv_Upgrade.c ****                 r ++;
 2219              		.loc 1 637 75 is_stmt 0 view .LVU572
 2220 00e2 A300     		lsls	r3, r4, #2
 637:Service/Srv_Upgrade.c ****                 r ++;
 2221              		.loc 1 637 72 view .LVU573
 2222 00e4 1D4A     		ldr	r2, .L154+28
 637:Service/Srv_Upgrade.c ****                 r ++;
 2223              		.loc 1 637 99 view .LVU574
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 60


 2224 00e6 591C     		adds	r1, r3, #1
 637:Service/Srv_Upgrade.c ****                 r ++;
 2225              		.loc 1 637 123 view .LVU575
 2226 00e8 981C     		adds	r0, r3, #2
 637:Service/Srv_Upgrade.c ****                 r ++;
 2227              		.loc 1 637 116 view .LVU576
 2228 00ea 105C     		ldrb	r0, [r2, r0]	@ zero_extendqisi2
 637:Service/Srv_Upgrade.c ****                 r ++;
 2229              		.loc 1 637 147 view .LVU577
 2230 00ec 0333     		adds	r3, r3, #3
 637:Service/Srv_Upgrade.c ****                 r ++;
 2231              		.loc 1 637 140 view .LVU578
 2232 00ee D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
 637:Service/Srv_Upgrade.c ****                 r ++;
 2233              		.loc 1 637 17 view .LVU579
 2234 00f0 0193     		str	r3, [sp, #4]
 2235 00f2 0090     		str	r0, [sp]
 2236 00f4 535C     		ldrb	r3, [r2, r1]	@ zero_extendqisi2
 2237 00f6 12F82420 		ldrb	r2, [r2, r4, lsl #2]	@ zero_extendqisi2
 2238 00fa 1949     		ldr	r1, .L154+32
 2239 00fc 3846     		mov	r0, r7
 2240 00fe FFF7FEFF 		bl	shellPrint
 2241              	.LVL162:
 638:Service/Srv_Upgrade.c ****                 if (r == 3)
 2242              		.loc 1 638 17 is_stmt 1 view .LVU580
 638:Service/Srv_Upgrade.c ****                 if (r == 3)
 2243              		.loc 1 638 19 is_stmt 0 view .LVU581
 2244 0102 0135     		adds	r5, r5, #1
 2245              	.LVL163:
 638:Service/Srv_Upgrade.c ****                 if (r == 3)
 2246              		.loc 1 638 19 view .LVU582
 2247 0104 EDB2     		uxtb	r5, r5
 2248              	.LVL164:
 639:Service/Srv_Upgrade.c ****                 {
 2249              		.loc 1 639 17 is_stmt 1 view .LVU583
 639:Service/Srv_Upgrade.c ****                 {
 2250              		.loc 1 639 20 is_stmt 0 view .LVU584
 2251 0106 032D     		cmp	r5, #3
 2252 0108 E6D1     		bne	.L145
 2253 010a E0E7     		b	.L153
 2254              	.L152:
 639:Service/Srv_Upgrade.c ****                 {
 2255              		.loc 1 639 20 view .LVU585
 2256              	.LBE10:
 645:Service/Srv_Upgrade.c ****             total_size -= read_size;
 2257              		.loc 1 645 13 is_stmt 1 view .LVU586
 2258 010c 3246     		mov	r2, r6
 2259 010e 0021     		movs	r1, #0
 2260 0110 1248     		ldr	r0, .L154+28
 2261 0112 FFF7FEFF 		bl	memset
 2262              	.LVL165:
 646:Service/Srv_Upgrade.c ****             if (total_size == 0)
 2263              		.loc 1 646 13 view .LVU587
 647:Service/Srv_Upgrade.c ****                 break;
 2264              		.loc 1 647 13 view .LVU588
 647:Service/Srv_Upgrade.c ****                 break;
 2265              		.loc 1 647 16 is_stmt 0 view .LVU589
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 61


 2266 0116 B8EB0608 		subs	r8, r8, r6
 2267              	.LVL166:
 647:Service/Srv_Upgrade.c ****                 break;
 2268              		.loc 1 647 16 view .LVU590
 2269 011a D2D0     		beq	.L137
 650:Service/Srv_Upgrade.c ****         }
 2270              		.loc 1 650 13 is_stmt 1 view .LVU591
 650:Service/Srv_Upgrade.c ****         }
 2271              		.loc 1 650 30 is_stmt 0 view .LVU592
 2272 011c B144     		add	r9, r9, r6
 2273              	.LVL167:
 2274              	.L142:
 626:Service/Srv_Upgrade.c ****         {
 2275              		.loc 1 626 30 is_stmt 1 discriminator 1 view .LVU593
 626:Service/Srv_Upgrade.c ****         {
 2276              		.loc 1 626 9 is_stmt 0 discriminator 1 view .LVU594
 2277 011e B8F1000F 		cmp	r8, #0
 2278 0122 CED0     		beq	.L137
 628:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 2279              		.loc 1 628 13 is_stmt 1 view .LVU595
 2280              	.LVL168:
 629:Service/Srv_Upgrade.c ****                 read_size = total_size;
 2281              		.loc 1 629 13 view .LVU596
 629:Service/Srv_Upgrade.c ****                 read_size = total_size;
 2282              		.loc 1 629 16 is_stmt 0 view .LVU597
 2283 0124 B8F5806F 		cmp	r8, #1024
 2284 0128 CED2     		bcs	.L149
 630:Service/Srv_Upgrade.c **** 
 2285              		.loc 1 630 17 is_stmt 1 view .LVU598
 630:Service/Srv_Upgrade.c **** 
 2286              		.loc 1 630 27 is_stmt 0 view .LVU599
 2287 012a 1FFA88F6 		uxth	r6, r8
 2288              	.LVL169:
 2289              	.L143:
 633:Service/Srv_Upgrade.c **** 
 2290              		.loc 1 633 13 is_stmt 1 view .LVU600
 633:Service/Srv_Upgrade.c **** 
 2291              		.loc 1 633 20 is_stmt 0 view .LVU601
 2292 012e 054B     		ldr	r3, .L154+4
 2293 0130 9C6A     		ldr	r4, [r3, #40]
 633:Service/Srv_Upgrade.c **** 
 2294              		.loc 1 633 13 view .LVU602
 2295 0132 3346     		mov	r3, r6
 2296 0134 094A     		ldr	r2, .L154+28
 2297 0136 4946     		mov	r1, r9
 2298 0138 0220     		movs	r0, #2
 2299 013a A047     		blx	r4
 2300              	.LVL170:
 635:Service/Srv_Upgrade.c ****             {
 2301              		.loc 1 635 13 is_stmt 1 view .LVU603
 2302              	.LBB11:
 635:Service/Srv_Upgrade.c ****             {
 2303              		.loc 1 635 18 view .LVU604
 635:Service/Srv_Upgrade.c ****             {
 2304              		.loc 1 635 27 is_stmt 0 view .LVU605
 2305 013c 0024     		movs	r4, #0
 635:Service/Srv_Upgrade.c ****             {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 62


 2306              		.loc 1 635 13 view .LVU606
 2307 013e CDE7     		b	.L144
 2308              	.L155:
 2309              		.align	2
 2310              	.L154:
 2311 0140 00000000 		.word	.LANCHOR0
 2312 0144 00000000 		.word	Storage
 2313 0148 00000000 		.word	.LC19
 2314 014c 1C000000 		.word	.LC20
 2315 0150 3C000000 		.word	.LC21
 2316 0154 00000000 		.word	.LC13
 2317 0158 94000000 		.word	.LC18
 2318 015c 00000000 		.word	upgrade_buf
 2319 0160 80000000 		.word	.LC17
 2320              	.LBE11:
 2321              	.LBE13:
 2322              		.cfi_endproc
 2323              	.LFE161:
 2325              		.section	.text.Write_OnChipFlash,"ax",%progbits
 2326              		.align	1
 2327              		.weak	Write_OnChipFlash
 2328              		.syntax unified
 2329              		.thumb
 2330              		.thumb_func
 2332              	Write_OnChipFlash:
 2333              	.LVL171:
 2334              	.LFB145:
  44:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 2335              		.loc 1 44 92 is_stmt 1 view -0
 2336              		.cfi_startproc
 2337              		@ args = 0, pretend = 0, frame = 0
 2338              		@ frame_needed = 0, uses_anonymous_args = 0
 2339              		@ link register save eliminated.
  44:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 2340              		.loc 1 44 93 view .LVU608
  44:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 2341              		.loc 1 44 106 is_stmt 0 view .LVU609
 2342 0000 0020     		movs	r0, #0
 2343              	.LVL172:
  44:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 2344              		.loc 1 44 106 view .LVU610
 2345 0002 7047     		bx	lr
 2346              		.cfi_endproc
 2347              	.LFE145:
 2349              		.section	.text.Read_OnChipFlash,"ax",%progbits
 2350              		.align	1
 2351              		.weak	Read_OnChipFlash
 2352              		.syntax unified
 2353              		.thumb
 2354              		.thumb_func
 2356              	Read_OnChipFlash:
 2357              	.LVL173:
 2358              	.LFB146:
  45:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 2359              		.loc 1 45 91 is_stmt 1 view -0
 2360              		.cfi_startproc
 2361              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 63


 2362              		@ frame_needed = 0, uses_anonymous_args = 0
 2363              		@ link register save eliminated.
  45:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 2364              		.loc 1 45 92 view .LVU612
  45:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 2365              		.loc 1 45 105 is_stmt 0 view .LVU613
 2366 0000 0020     		movs	r0, #0
 2367              	.LVL174:
  45:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 2368              		.loc 1 45 105 view .LVU614
 2369 0002 7047     		bx	lr
 2370              		.cfi_endproc
 2371              	.LFE146:
 2373              		.section	.text.Erase_OnChipFlash,"ax",%progbits
 2374              		.align	1
 2375              		.weak	Erase_OnChipFlash
 2376              		.syntax unified
 2377              		.thumb
 2378              		.thumb_func
 2380              	Erase_OnChipFlash:
 2381              	.LVL175:
 2382              	.LFB147:
  46:Service/Srv_Upgrade.c **** 
 2383              		.loc 1 46 92 is_stmt 1 view -0
 2384              		.cfi_startproc
 2385              		@ args = 0, pretend = 0, frame = 0
 2386              		@ frame_needed = 0, uses_anonymous_args = 0
 2387              		@ link register save eliminated.
  46:Service/Srv_Upgrade.c **** 
 2388              		.loc 1 46 93 view .LVU616
  46:Service/Srv_Upgrade.c **** 
 2389              		.loc 1 46 106 is_stmt 0 view .LVU617
 2390 0000 0020     		movs	r0, #0
 2391              	.LVL176:
  46:Service/Srv_Upgrade.c **** 
 2392              		.loc 1 46 106 view .LVU618
 2393 0002 7047     		bx	lr
 2394              		.cfi_endproc
 2395              	.LFE147:
 2397              		.global	shellCommandcheck_boot
 2398              		.global	shellDesccheck_boot
 2399              		.global	shellCmdcheck_boot
 2400              		.global	shellCommandcheck_app
 2401              		.global	shellDesccheck_app
 2402              		.global	shellCmdcheck_app
 2403              		.global	shellCommandapp_ver
 2404              		.global	shellDescapp_ver
 2405              		.global	shellCmdapp_ver
 2406              		.global	SrvUpgrade
 2407              		.global	HWVer
 2408              		.global	AppVer
 2409              		.section	.rodata
 2410              		.align	2
 2411              		.set	.LANCHOR2,. + 0
 2412              	.LC1:
 2413 0000 000003   		.ascii	"\000\000\003"
 2414              		.section	.bss.Monitor,"aw",%nobits
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 64


 2415              		.align	2
 2416              		.set	.LANCHOR0,. + 0
 2419              	Monitor:
 2420 0000 00000000 		.space	1160
 2420      00000000 
 2420      00000000 
 2420      00000000 
 2420      00000000 
 2421              		.section	.bss.upgrade_buf,"aw",%nobits
 2422              		.align	2
 2425              	upgrade_buf:
 2426 0000 00000000 		.space	4096
 2426      00000000 
 2426      00000000 
 2426      00000000 
 2426      00000000 
 2427              		.section	.data.SrvUpgrade,"aw"
 2428              		.align	2
 2431              	SrvUpgrade:
 2432 0000 00000000 		.word	SrvUpgrade_Init
 2433 0004 00000000 		.word	SrvUpgrade_StatePolling
 2434 0008 00000000 		.word	SrvUpgrade_SetFileInfo
 2435 000c 00000000 		.word	SrvUpgrade_Get_Info
 2436 0010 00000000 		.word	SrvUpgrade_ClearLog
 2437 0014 00000000 		.word	SrvUpgrade_PushData
 2438              		.section	.rodata.AppVer,"a"
 2439              		.align	2
 2442              	AppVer:
 2443 0000 000011   		.ascii	"\000\000\021"
 2444              		.section	.rodata.HWVer,"a"
 2445              		.align	2
 2446              		.set	.LANCHOR1,. + 0
 2449              	HWVer:
 2450 0000 000003   		.ascii	"\000\000\003"
 2451              		.section	.rodata.shellCmdapp_ver,"a"
 2452              		.align	2
 2455              	shellCmdapp_ver:
 2456 0000 6170705F 		.ascii	"app_ver\000"
 2456      76657200 
 2457              		.section	.rodata.shellCmdcheck_app,"a"
 2458              		.align	2
 2461              	shellCmdcheck_app:
 2462 0000 63686563 		.ascii	"check_app\000"
 2462      6B5F6170 
 2462      7000
 2463              		.section	.rodata.shellCmdcheck_boot,"a"
 2464              		.align	2
 2467              	shellCmdcheck_boot:
 2468 0000 63686563 		.ascii	"check_boot\000"
 2468      6B5F626F 
 2468      6F7400
 2469              		.section	.rodata.shellDescapp_ver,"a"
 2470              		.align	2
 2473              	shellDescapp_ver:
 2474 0000 63686563 		.ascii	"check app version\000"
 2474      6B206170 
 2474      70207665 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 65


 2474      7273696F 
 2474      6E00
 2475              		.section	.rodata.shellDesccheck_app,"a"
 2476              		.align	2
 2479              	shellDesccheck_app:
 2480 0000 63686563 		.ascii	"check stored app\000"
 2480      6B207374 
 2480      6F726564 
 2480      20617070 
 2480      00
 2481              		.section	.rodata.shellDesccheck_boot,"a"
 2482              		.align	2
 2485              	shellDesccheck_boot:
 2486 0000 63686563 		.ascii	"check stored boot\000"
 2486      6B207374 
 2486      6F726564 
 2486      20626F6F 
 2486      7400
 2487              		.section	shellCommand,"a"
 2488              		.align	2
 2491              	shellCommandcheck_boot:
 2492 0000 00210000 		.word	8448
 2493 0004 00000000 		.word	shellCmdcheck_boot
 2494 0008 00000000 		.word	SrvUpgrade_Check_BootFirmware
 2495 000c 00000000 		.word	shellDesccheck_boot
 2498              	shellCommandcheck_app:
 2499 0010 00210000 		.word	8448
 2500 0014 00000000 		.word	shellCmdcheck_app
 2501 0018 00000000 		.word	SrvUpgrade_Check_AppFirmware
 2502 001c 00000000 		.word	shellDesccheck_app
 2505              	shellCommandapp_ver:
 2506 0020 00210000 		.word	8448
 2507 0024 00000000 		.word	shellCmdapp_ver
 2508 0028 00000000 		.word	SrvUpgrade_Show_CurAppVer
 2509 002c 00000000 		.word	shellDescapp_ver
 2510              		.text
 2511              	.Letext0:
 2512              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 2513              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 2514              		.file 4 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\lib\\gcc\\arm-none-eabi\
 2515              		.file 5 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\lib\\gcc\\arm-none-eabi\
 2516              		.file 6 "Service/Srv_FileAdapter.h"
 2517              		.file 7 "Service/Srv_Upgrade.h"
 2518              		.file 8 "common/Error_Log/../../common/gen_physic_def/imu_data.h"
 2519              		.file 9 "System/FreeRTOS/include/portable.h"
 2520              		.file 10 "Service/Srv_OsCommon.h"
 2521              		.file 11 "Service/control_data.h"
 2522              		.file 12 "Service/../System/storage/Storage.h"
 2523              		.file 13 "System/shell/shell.h"
 2524              		.file 14 "System/FreeRTOS/FreeRTOSConfig.h"
 2525              		.file 15 "System/shell/shell_port.h"
 2526              		.file 16 "<built-in>"
 2527              		.file 17 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\
 2528              		.file 18 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 66


DEFINED SYMBOLS
                            *ABS*:00000000 Srv_Upgrade.c
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:20     .text.SrvUpgrade_SetFileInfo:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:25     .text.SrvUpgrade_SetFileInfo:00000000 SrvUpgrade_SetFileInfo
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:56     .text.SrvUpgrade_SetFileInfo:00000020 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:61     .text.SrvUpgrade_PushData:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:66     .text.SrvUpgrade_PushData:00000000 SrvUpgrade_PushData
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:188    .text.SrvUpgrade_PushData:00000080 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:193    .text.SrvUpgrade_Get_Info:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:198    .text.SrvUpgrade_Get_Info:00000000 SrvUpgrade_Get_Info
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:280    .text.SrvUpgrade_Get_Info:00000038 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:285    .text.SrvUpgrade_ClearLog:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:290    .text.SrvUpgrade_ClearLog:00000000 SrvUpgrade_ClearLog
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:317    .text.SrvUpgrade_ClearLog:0000001c $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:322    .text.SrvUpgrade_PortProcPolling:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:327    .text.SrvUpgrade_PortProcPolling:00000000 SrvUpgrade_PortProcPolling
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:538    .text.SrvUpgrade_PortProcPolling:000000e4 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:544    .rodata.SrvUpgrade_CheckUpgrade_OnBootUp.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:548    .text.SrvUpgrade_CheckUpgrade_OnBootUp:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:553    .text.SrvUpgrade_CheckUpgrade_OnBootUp:00000000 SrvUpgrade_CheckUpgrade_OnBootUp
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:837    .text.SrvUpgrade_CheckUpgrade_OnBootUp:00000174 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2425   .bss.upgrade_buf:00000000 upgrade_buf
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:849    .text.SrvUpgrade_Init:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:854    .text.SrvUpgrade_Init:00000000 SrvUpgrade_Init
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:934    .text.SrvUpgrade_Init:00000058 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:940    .text.SrvUpgrade_Collect_Info:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:945    .text.SrvUpgrade_Collect_Info:00000000 SrvUpgrade_Collect_Info
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1049   .text.SrvUpgrade_Collect_Info:00000050 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1054   .rodata.SrvUpgrade_On_PortProc_Finish.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1076   .text.SrvUpgrade_On_PortProc_Finish:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1081   .text.SrvUpgrade_On_PortProc_Finish:00000000 SrvUpgrade_On_PortProc_Finish
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1306   .text.SrvUpgrade_On_PortProc_Finish:0000015c $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1321   .rodata.SrvUpgrade_StatePolling.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1331   .text.SrvUpgrade_StatePolling:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1336   .text.SrvUpgrade_StatePolling:00000000 SrvUpgrade_StatePolling
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1401   .text.SrvUpgrade_StatePolling:00000036 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1412   .text.SrvUpgrade_StatePolling:00000040 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1640   .text.SrvUpgrade_StatePolling:00000130 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1649   .rodata.SrvUpgrade_Show_CurAppVer.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1653   .text.SrvUpgrade_Show_CurAppVer:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1658   .text.SrvUpgrade_Show_CurAppVer:00000000 SrvUpgrade_Show_CurAppVer
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1696   .text.SrvUpgrade_Show_CurAppVer:00000020 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1701   .rodata.SrvUpgrade_Check_AppFirmware.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1720   .text.SrvUpgrade_Check_AppFirmware:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:1725   .text.SrvUpgrade_Check_AppFirmware:00000000 SrvUpgrade_Check_AppFirmware
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2003   .text.SrvUpgrade_Check_AppFirmware:00000140 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2018   .rodata.SrvUpgrade_Check_BootFirmware.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2028   .text.SrvUpgrade_Check_BootFirmware:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2033   .text.SrvUpgrade_Check_BootFirmware:00000000 SrvUpgrade_Check_BootFirmware
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2311   .text.SrvUpgrade_Check_BootFirmware:00000140 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2326   .text.Write_OnChipFlash:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2332   .text.Write_OnChipFlash:00000000 Write_OnChipFlash
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2350   .text.Read_OnChipFlash:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2356   .text.Read_OnChipFlash:00000000 Read_OnChipFlash
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2374   .text.Erase_OnChipFlash:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2380   .text.Erase_OnChipFlash:00000000 Erase_OnChipFlash
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2491   shellCommand:00000000 shellCommandcheck_boot
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s 			page 67


C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2485   .rodata.shellDesccheck_boot:00000000 shellDesccheck_boot
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2467   .rodata.shellCmdcheck_boot:00000000 shellCmdcheck_boot
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2498   shellCommand:00000010 shellCommandcheck_app
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2479   .rodata.shellDesccheck_app:00000000 shellDesccheck_app
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2461   .rodata.shellCmdcheck_app:00000000 shellCmdcheck_app
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2505   shellCommand:00000020 shellCommandapp_ver
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2473   .rodata.shellDescapp_ver:00000000 shellDescapp_ver
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2455   .rodata.shellCmdapp_ver:00000000 shellCmdapp_ver
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2431   .data.SrvUpgrade:00000000 SrvUpgrade
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2449   .rodata.HWVer:00000000 HWVer
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2442   .rodata.AppVer:00000000 AppVer
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2410   .rodata:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2415   .bss.Monitor:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2419   .bss.Monitor:00000000 Monitor
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2422   .bss.upgrade_buf:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2428   .data.SrvUpgrade:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2439   .rodata.AppVer:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2445   .rodata.HWVer:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2452   .rodata.shellCmdapp_ver:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2458   .rodata.shellCmdcheck_app:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2464   .rodata.shellCmdcheck_boot:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2470   .rodata.shellDescapp_ver:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2476   .rodata.shellDesccheck_app:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2482   .rodata.shellDesccheck_boot:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccTp72MZ.s:2488   shellCommand:00000000 $d

UNDEFINED SYMBOLS
memcpy
memset
SrvFileAdapter
memcmp
Storage
SrvOsCommon
vsnprintf
Shell_GetInstence
shellPrint
