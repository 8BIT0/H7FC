ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"Srv_Upgrade.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.SrvUpgrade_SetFileInfo,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	SrvUpgrade_SetFileInfo:
  26              	.LFB156:
  27              		.file 1 "Service/Srv_Upgrade.c"
   1:Service/Srv_Upgrade.c **** /*
   2:Service/Srv_Upgrade.c ****  *  Auther: 8_B!T0
   3:Service/Srv_Upgrade.c ****  *  Noticed: this file use to upgrade App / Module Firmware 
   4:Service/Srv_Upgrade.c ****  *  When at bootloader use this file can upgrade App and Module Firmware
   5:Service/Srv_Upgrade.c ****  *  When at app use this file can upgrade Bootloader and Module Firmware
   6:Service/Srv_Upgrade.c ****  *  
   7:Service/Srv_Upgrade.c ****  *                      F ------- Y ------ I
   8:Service/Srv_Upgrade.c ****  *                      still in developping
   9:Service/Srv_Upgrade.c ****  */
  10:Service/Srv_Upgrade.c **** #include "Srv_Upgrade.h"
  11:Service/Srv_Upgrade.c **** #include "util.h"
  12:Service/Srv_Upgrade.c **** #include "../System/storage/Storage.h"
  13:Service/Srv_Upgrade.c **** #include "Bsp_Flash.h"
  14:Service/Srv_Upgrade.c **** #include "Srv_FileAdapter.h"
  15:Service/Srv_Upgrade.c **** #include "shell_port.h"
  16:Service/Srv_Upgrade.c **** #include "HW_Def.h"
  17:Service/Srv_Upgrade.c **** #include "debug_util.h"
  18:Service/Srv_Upgrade.c **** 
  19:Service/Srv_Upgrade.c **** #define FIRMWARE_WAITTING_TIMEOUT   60000   /* unit: ms */
  20:Service/Srv_Upgrade.c **** #define FIRMWARE_COMMU_TIMEOUT      1000    /* unit: ms */
  21:Service/Srv_Upgrade.c **** #define DEFAULT_WINDOW_SIZE         100     /* unit: ms */
  22:Service/Srv_Upgrade.c **** 
  23:Service/Srv_Upgrade.c **** const uint8_t AppVer[3] = {0, 0, 17};
  24:Service/Srv_Upgrade.c **** #if defined MATEKH743_V1_5
  25:Service/Srv_Upgrade.c **** const uint8_t HWVer[3] = {0, 0, 1};
  26:Service/Srv_Upgrade.c **** #elif defined BATEAT32F435_AIO
  27:Service/Srv_Upgrade.c **** const uint8_t HWVer[3] = {0, 0, 2};
  28:Service/Srv_Upgrade.c **** #elif defined CCRC_AT32_20
  29:Service/Srv_Upgrade.c **** const uint8_t HWVer[3] = {0, 0, 3};
  30:Service/Srv_Upgrade.c **** #elif defined CAIFPV_AIO
  31:Service/Srv_Upgrade.c **** const uint8_t HWVer[3] = {0, 0, 4};
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 2


  32:Service/Srv_Upgrade.c **** #endif
  33:Service/Srv_Upgrade.c **** 
  34:Service/Srv_Upgrade.c **** #define AppBref "First Version of H7FC"
  35:Service/Srv_Upgrade.c **** #define AppCompileData __DATA__
  36:Service/Srv_Upgrade.c **** #define FIRMWARE_MAX_READ_SIZE (4 Kb)
  37:Service/Srv_Upgrade.c **** 
  38:Service/Srv_Upgrade.c **** #define UpgradeInfo_Sec  "Upgrade_Info"
  39:Service/Srv_Upgrade.c **** 
  40:Service/Srv_Upgrade.c **** #define UPGERADE_INFO(fmt,...) Debug_Print(&DebugPort, "[ UPGRADE INFO ] ", fmt, ##__VA_ARGS__)
  41:Service/Srv_Upgrade.c **** 
  42:Service/Srv_Upgrade.c **** typedef void (*Application_Func)(void);
  43:Service/Srv_Upgrade.c **** 
  44:Service/Srv_Upgrade.c **** static uint8_t upgrade_buf[FIRMWARE_MAX_READ_SIZE] = {0};
  45:Service/Srv_Upgrade.c **** 
  46:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Write_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
  47:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
  48:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
  49:Service/Srv_Upgrade.c **** 
  50:Service/Srv_Upgrade.c **** typedef enum
  51:Service/Srv_Upgrade.c **** {
  52:Service/Srv_Upgrade.c ****     UpgradeParam_None = 0,
  53:Service/Srv_Upgrade.c ****     UpgradeParam_InValid,
  54:Service/Srv_Upgrade.c ****     UpgradeParam_Valid,
  55:Service/Srv_Upgrade.c **** } SrvUpgrade_ParamValid_List;
  56:Service/Srv_Upgrade.c **** 
  57:Service/Srv_Upgrade.c **** typedef struct
  58:Service/Srv_Upgrade.c **** {
  59:Service/Srv_Upgrade.c ****     bool access;
  60:Service/Srv_Upgrade.c ****     uint16_t size;
  61:Service/Srv_Upgrade.c ****     uint16_t total_size;
  62:Service/Srv_Upgrade.c ****     uint8_t *p_buf;
  63:Service/Srv_Upgrade.c **** } SrvUpgrade_Stream_TypeDef;
  64:Service/Srv_Upgrade.c **** 
  65:Service/Srv_Upgrade.c **** typedef struct
  66:Service/Srv_Upgrade.c **** {
  67:Service/Srv_Upgrade.c ****     bool init_state;
  68:Service/Srv_Upgrade.c **** 
  69:Service/Srv_Upgrade.c ****     SrvUpgrade_Stage_List PollingState;
  70:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List PortDataState;
  71:Service/Srv_Upgrade.c **** 
  72:Service/Srv_Upgrade.c ****     uint32_t discard_time;
  73:Service/Srv_Upgrade.c **** 
  74:Service/Srv_Upgrade.c ****     uint32_t rec_timeout;
  75:Service/Srv_Upgrade.c ****     uint32_t rec_time;
  76:Service/Srv_Upgrade.c ****     
  77:Service/Srv_Upgrade.c ****     Storage_ItemSearchOut_TypeDef UpgradeInfo_SO;
  78:Service/Srv_Upgrade.c ****     
  79:Service/Srv_Upgrade.c ****     SrvFileAdapterObj_TypeDef *adapter_obj;
  80:Service/Srv_Upgrade.c ****     bool info_update;
  81:Service/Srv_Upgrade.c ****     FileInfo_TypeDef FileInfo;
  82:Service/Srv_Upgrade.c **** 
  83:Service/Srv_Upgrade.c ****     SrvUpgrade_Stream_TypeDef proc_stream[2];
  84:Service/Srv_Upgrade.c **** 
  85:Service/Srv_Upgrade.c ****     uint8_t LogOut_Info[1024];
  86:Service/Srv_Upgrade.c ****     uint16_t LogOut_Info_size;
  87:Service/Srv_Upgrade.c **** } SrvUpgradeMonitor_TypeDef;
  88:Service/Srv_Upgrade.c **** 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 3


  89:Service/Srv_Upgrade.c **** typedef struct
  90:Service/Srv_Upgrade.c **** {
  91:Service/Srv_Upgrade.c ****     uint32_t read_addr;
  92:Service/Srv_Upgrade.c ****     uint32_t read_size;
  93:Service/Srv_Upgrade.c **** 
  94:Service/Srv_Upgrade.c ****     uint32_t write_addr;
  95:Service/Srv_Upgrade.c ****     uint32_t write_size;
  96:Service/Srv_Upgrade.c **** 
  97:Service/Srv_Upgrade.c ****     uint32_t remain_size;
  98:Service/Srv_Upgrade.c **** } FlashMonitor_TypeDef;
  99:Service/Srv_Upgrade.c **** 
 100:Service/Srv_Upgrade.c **** /* internal virable */
 101:Service/Srv_Upgrade.c **** static SrvUpgradeMonitor_TypeDef Monitor = {
 102:Service/Srv_Upgrade.c ****     .init_state = false,
 103:Service/Srv_Upgrade.c **** };
 104:Service/Srv_Upgrade.c **** 
 105:Service/Srv_Upgrade.c **** /* internal function */
 106:Service/Srv_Upgrade.c **** static void SrvUpgrade_Collect_Info(const char *format, ...);
 107:Service/Srv_Upgrade.c **** static void SrvUpgrade_CheckUpgrade_OnBootUp(void);
 108:Service/Srv_Upgrade.c **** 
 109:Service/Srv_Upgrade.c **** /* external function */
 110:Service/Srv_Upgrade.c **** static bool SrvUpgrade_Init(void);
 111:Service/Srv_Upgrade.c **** static SrvUpgrade_Stage_List SrvUpgrade_StatePolling(uint32_t sys_time, SrvFileAdapter_Send_Func se
 112:Service/Srv_Upgrade.c **** static uint16_t SrvUpgrade_Get_Info(uint8_t *p_info, uint16_t len);
 113:Service/Srv_Upgrade.c **** static void SrvUpgrade_ClearLog(void);
 114:Service/Srv_Upgrade.c **** static bool SrvUpgrade_PushData(uint32_t sys_time, uint8_t *p_buf, uint16_t len);
 115:Service/Srv_Upgrade.c **** static void SrvUpgrade_SetFileInfo(const FileInfo_TypeDef info);
 116:Service/Srv_Upgrade.c **** 
 117:Service/Srv_Upgrade.c **** /* external function */
 118:Service/Srv_Upgrade.c **** SrvUpgrade_TypeDef SrvUpgrade = {
 119:Service/Srv_Upgrade.c ****     .init = SrvUpgrade_Init,
 120:Service/Srv_Upgrade.c ****     .polling = SrvUpgrade_StatePolling,
 121:Service/Srv_Upgrade.c ****     .get_log = SrvUpgrade_Get_Info,
 122:Service/Srv_Upgrade.c ****     .clear_log = SrvUpgrade_ClearLog,
 123:Service/Srv_Upgrade.c ****     .push_data = SrvUpgrade_PushData,
 124:Service/Srv_Upgrade.c ****     .set_fileinfo = SrvUpgrade_SetFileInfo,
 125:Service/Srv_Upgrade.c **** };
 126:Service/Srv_Upgrade.c **** 
 127:Service/Srv_Upgrade.c **** static bool SrvUpgrade_Init(void)
 128:Service/Srv_Upgrade.c **** {
 129:Service/Srv_Upgrade.c ****     if (sizeof(upgrade_buf) % 2)
 130:Service/Srv_Upgrade.c ****         return false;
 131:Service/Srv_Upgrade.c **** 
 132:Service/Srv_Upgrade.c ****     /* reset file info */
 133:Service/Srv_Upgrade.c ****     Monitor.info_update = false;
 134:Service/Srv_Upgrade.c ****     memset(&Monitor.FileInfo, 0, sizeof(Monitor.FileInfo));
 135:Service/Srv_Upgrade.c **** 
 136:Service/Srv_Upgrade.c ****     /* get data from storage */
 137:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 138:Service/Srv_Upgrade.c **** 
 139:Service/Srv_Upgrade.c ****     memset(Monitor.LogOut_Info, 0, sizeof(Monitor.LogOut_Info));
 140:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 141:Service/Srv_Upgrade.c ****     
 142:Service/Srv_Upgrade.c ****     /* set stream */
 143:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].access = false;
 144:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].size = 0;
 145:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].total_size = sizeof(upgrade_buf) / 2;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 4


 146:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].p_buf = upgrade_buf;
 147:Service/Srv_Upgrade.c **** 
 148:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].access = false;
 149:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].size = 0;
 150:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].total_size = sizeof(upgrade_buf) / 2;
 151:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].p_buf = &upgrade_buf[sizeof(upgrade_buf) / 2];
 152:Service/Srv_Upgrade.c **** 
 153:Service/Srv_Upgrade.c ****     Monitor.init_state = true;
 154:Service/Srv_Upgrade.c ****     Monitor.PollingState = Stage_Init;
 155:Service/Srv_Upgrade.c ****     Monitor.PortDataState = PortProc_None;
 156:Service/Srv_Upgrade.c ****     
 157:Service/Srv_Upgrade.c ****     /* 
 158:Service/Srv_Upgrade.c ****      * whatever on boot or app
 159:Service/Srv_Upgrade.c ****      * check upgrade on boot up
 160:Service/Srv_Upgrade.c ****      */
 161:Service/Srv_Upgrade.c ****     SrvUpgrade_CheckUpgrade_OnBootUp();
 162:Service/Srv_Upgrade.c ****     return true;
 163:Service/Srv_Upgrade.c **** }
 164:Service/Srv_Upgrade.c **** 
 165:Service/Srv_Upgrade.c **** static void SrvUpgrade_CheckUpgrade_OnBootUp(void)
 166:Service/Srv_Upgrade.c **** {
 167:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 168:Service/Srv_Upgrade.c ****     uint32_t file_size = 0;
 169:Service/Srv_Upgrade.c ****     uint16_t update_size = 0;
 170:Service/Srv_Upgrade.c ****     uint32_t addr_offset = 0;
 171:Service/Srv_Upgrade.c **** 
 172:Service/Srv_Upgrade.c ****     memset(&Monitor.UpgradeInfo_SO, 0, sizeof(Monitor.UpgradeInfo_SO));
 173:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 174:Service/Srv_Upgrade.c **** 
 175:Service/Srv_Upgrade.c ****     /* check upgrade enable control first */
 176:Service/Srv_Upgrade.c ****     Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 177:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 178:Service/Srv_Upgrade.c ****     {
 179:Service/Srv_Upgrade.c ****         Storage.get(Para_Boot, Monitor.UpgradeInfo_SO.item, (uint8_t *)(&Info), sizeof(SrvUpgradeIn
 180:Service/Srv_Upgrade.c ****         /* read parameter section */
 181:Service/Srv_Upgrade.c ****         while (file_size)
 182:Service/Srv_Upgrade.c ****         {
 183:Service/Srv_Upgrade.c ****             update_size = file_size;
 184:Service/Srv_Upgrade.c ****             if (file_size > 1024)
 185:Service/Srv_Upgrade.c ****                 update_size = 1024;
 186:Service/Srv_Upgrade.c **** 
 187:Service/Srv_Upgrade.c ****             /* read firmware from storage */
 188:Service/Srv_Upgrade.c ****             memset(upgrade_buf, 0, update_size);
 189:Service/Srv_Upgrade.c ****             Storage.read_firmware(addr_offset, upgrade_buf, update_size);
 190:Service/Srv_Upgrade.c **** 
 191:Service/Srv_Upgrade.c ****             SrvOsCommon.enter_critical();
 192:Service/Srv_Upgrade.c ****             /* write firmware to boot flash */
 193:Service/Srv_Upgrade.c ****             Storage.write_firmware(Internal_Flash, addr_offset, upgrade_buf, update_size);
 194:Service/Srv_Upgrade.c ****             SrvOsCommon.exit_critical();
 195:Service/Srv_Upgrade.c **** 
 196:Service/Srv_Upgrade.c ****             file_size -= update_size;
 197:Service/Srv_Upgrade.c ****             addr_offset += update_size;
 198:Service/Srv_Upgrade.c ****         }
 199:Service/Srv_Upgrade.c ****     }
 200:Service/Srv_Upgrade.c ****     else
 201:Service/Srv_Upgrade.c ****     {
 202:Service/Srv_Upgrade.c ****         memcpy(Info.AF_Info.HW_Ver, HWVer, sizeof(Info.AF_Info.HW_Ver));
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 5


 203:Service/Srv_Upgrade.c ****         Storage.create(Para_Boot, UpgradeInfo_Sec, (uint8_t *)(&Info), sizeof(SrvUpgradeInfo_TypeDe
 204:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 205:Service/Srv_Upgrade.c ****     }
 206:Service/Srv_Upgrade.c **** 
 207:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr == 0)
 208:Service/Srv_Upgrade.c ****     {
 209:Service/Srv_Upgrade.c ****         Monitor.init_state = false;
 210:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_UpgradeInfo_Error;
 211:Service/Srv_Upgrade.c ****     }
 212:Service/Srv_Upgrade.c **** }
 213:Service/Srv_Upgrade.c **** 
 214:Service/Srv_Upgrade.c **** static SrvUpgrade_PortDataProc_List SrvUpgrade_PortProcPolling(uint32_t sys_time)
 215:Service/Srv_Upgrade.c **** {
 216:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List ret;
 217:Service/Srv_Upgrade.c ****     Adapter_Polling_State adapter_state; 
 218:Service/Srv_Upgrade.c **** 
 219:Service/Srv_Upgrade.c ****     if (Monitor.adapter_obj == NULL)
 220:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 221:Service/Srv_Upgrade.c **** 
 222:Service/Srv_Upgrade.c ****     for (uint8_t i = 0; i < 2; i ++)
 223:Service/Srv_Upgrade.c ****     {
 224:Service/Srv_Upgrade.c ****         if (!Monitor.proc_stream[i].access && Monitor.proc_stream[i].size)
 225:Service/Srv_Upgrade.c ****         {
 226:Service/Srv_Upgrade.c ****             Monitor.proc_stream[i].access = true;
 227:Service/Srv_Upgrade.c **** 
 228:Service/Srv_Upgrade.c ****             if (SrvFileAdapter.push_to_stream(Monitor.proc_stream[i].p_buf, Monitor.proc_stream[i].
 229:Service/Srv_Upgrade.c ****             {
 230:Service/Srv_Upgrade.c ****                 memset(Monitor.proc_stream[i].p_buf, 0, Monitor.proc_stream[i].size);
 231:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 232:Service/Srv_Upgrade.c ****             }
 233:Service/Srv_Upgrade.c **** 
 234:Service/Srv_Upgrade.c ****             Monitor.proc_stream[i].access = false;
 235:Service/Srv_Upgrade.c ****         }
 236:Service/Srv_Upgrade.c ****     }
 237:Service/Srv_Upgrade.c ****     
 238:Service/Srv_Upgrade.c ****     switch((uint8_t) Monitor.PortDataState)
 239:Service/Srv_Upgrade.c ****     {
 240:Service/Srv_Upgrade.c ****         case PortProc_None:
 241:Service/Srv_Upgrade.c ****             Monitor.rec_timeout = sys_time + FIRMWARE_COMMU_TIMEOUT;
 242:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 243:Service/Srv_Upgrade.c ****             Monitor.PortDataState = PortProc_Deal_Pack;
 244:Service/Srv_Upgrade.c ****             adapter_state = SrvFileAdapter.polling(sys_time, Monitor.adapter_obj);
 245:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 246:Service/Srv_Upgrade.c ****             
 247:Service/Srv_Upgrade.c ****             /* check adapter state */
 248:Service/Srv_Upgrade.c ****             switch ((uint8_t)adapter_state)
 249:Service/Srv_Upgrade.c ****             {
 250:Service/Srv_Upgrade.c ****                 case Adapter_Proc_Done: ret = ProtProc_Finish; break;
 251:Service/Srv_Upgrade.c ****                 case Adapter_Proc_Failed: ret = PortProc_Deal_Error; break;
 252:Service/Srv_Upgrade.c ****                 default: break;
 253:Service/Srv_Upgrade.c ****             }
 254:Service/Srv_Upgrade.c ****             break;
 255:Service/Srv_Upgrade.c **** 
 256:Service/Srv_Upgrade.c ****         case PortProc_Deal_Error:
 257:Service/Srv_Upgrade.c ****             Monitor.PortDataState = PortProc_None;
 258:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Error;
 259:Service/Srv_Upgrade.c ****             break;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 6


 260:Service/Srv_Upgrade.c **** 
 261:Service/Srv_Upgrade.c ****         default:
 262:Service/Srv_Upgrade.c ****             ret = PortProc_Unknown;
 263:Service/Srv_Upgrade.c ****             break;
 264:Service/Srv_Upgrade.c ****     }
 265:Service/Srv_Upgrade.c **** 
 266:Service/Srv_Upgrade.c ****     /* check for time out */
 267:Service/Srv_Upgrade.c ****     if ((ret != ProtProc_Finish) && (sys_time >= Monitor.rec_timeout))
 268:Service/Srv_Upgrade.c ****     {
 269:Service/Srv_Upgrade.c ****         Monitor.info_update = false;
 270:Service/Srv_Upgrade.c ****         Monitor.PortDataState = PortProc_None;
 271:Service/Srv_Upgrade.c ****         ret = PortProc_Deal_TimeOut;
 272:Service/Srv_Upgrade.c ****     }
 273:Service/Srv_Upgrade.c **** 
 274:Service/Srv_Upgrade.c ****     return ret;
 275:Service/Srv_Upgrade.c **** }
 276:Service/Srv_Upgrade.c **** 
 277:Service/Srv_Upgrade.c **** static SrvUpgrade_Stage_List SrvUpgrade_On_PortProc_Finish(void)
 278:Service/Srv_Upgrade.c **** {
 279:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 280:Service/Srv_Upgrade.c ****     FileInfo_TypeDef rec_file_info;
 281:Service/Srv_Upgrade.c **** 
 282:Service/Srv_Upgrade.c ****     memset(&rec_file_info, 0, sizeof(rec_file_info));
 283:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 284:Service/Srv_Upgrade.c **** 
 285:Service/Srv_Upgrade.c ****     /* all file data received */
 286:Service/Srv_Upgrade.c ****     /* update upgrade info to storage */
 287:Service/Srv_Upgrade.c ****     Storage.get(Para_Boot, Monitor.UpgradeInfo_SO.item, (uint8_t *)&Info, sizeof(SrvUpgradeInfo_Typ
 288:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 289:Service/Srv_Upgrade.c **** 
 290:Service/Srv_Upgrade.c ****     if (Monitor.FileInfo.File_Type == FileType_APP)
 291:Service/Srv_Upgrade.c ****     {
 292:Service/Srv_Upgrade.c ****         SrvUpgrade_Collect_Info("\tApp firmware receive finished\r\n");
 293:Service/Srv_Upgrade.c **** 
 294:Service/Srv_Upgrade.c ****         if (memcmp(Info.AF_Info.HW_Ver, HWVer, sizeof(Info.AF_Info.HW_Ver)) != 0)
 295:Service/Srv_Upgrade.c ****         {
 296:Service/Srv_Upgrade.c ****             SrvUpgrade_Collect_Info("App firmware hardware version error\r\n");
 297:Service/Srv_Upgrade.c ****             return Stage_Upgrade_Error;
 298:Service/Srv_Upgrade.c ****         }
 299:Service/Srv_Upgrade.c ****         
 300:Service/Srv_Upgrade.c ****         /* update app firmware info */
 301:Service/Srv_Upgrade.c ****         Info.CTLReg.bit.App = true;
 302:Service/Srv_Upgrade.c ****         Info.AF_Info = rec_file_info;
 303:Service/Srv_Upgrade.c ****     }
 304:Service/Srv_Upgrade.c **** 
 305:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tFile size: %d\r\n", rec_file_info.File_Size);
 306:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tHW: %d.%d.%d\r\n", rec_file_info.HW_Ver[0], rec_file_info.HW_Ver[1],
 307:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tSW: %d.%d.%d\r\n", rec_file_info.SW_Ver[0], rec_file_info.SW_Ver[1],
 308:Service/Srv_Upgrade.c ****     Storage.update(Para_Boot, Monitor.UpgradeInfo_SO.item.data_addr, (uint8_t *)&Info, sizeof(SrvUp
 309:Service/Srv_Upgrade.c **** 
 310:Service/Srv_Upgrade.c ****     /* destory adapter obj */
 311:Service/Srv_Upgrade.c ****     SrvFileAdapter.destory(Monitor.adapter_obj);
 312:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 313:Service/Srv_Upgrade.c **** 
 314:Service/Srv_Upgrade.c ****     /* upgrade App */
 315:Service/Srv_Upgrade.c ****     return Stage_Reboot;
 316:Service/Srv_Upgrade.c **** }
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 7


 317:Service/Srv_Upgrade.c **** 
 318:Service/Srv_Upgrade.c **** static SrvUpgrade_Stage_List SrvUpgrade_StatePolling(uint32_t sys_time, SrvFileAdapter_Send_Func se
 319:Service/Srv_Upgrade.c **** {
 320:Service/Srv_Upgrade.c ****     uint8_t i = 0;
 321:Service/Srv_Upgrade.c ****     
 322:Service/Srv_Upgrade.c ****     if ((Monitor.FileInfo.File_Type == FileType_None) || (Monitor.FileInfo.File_Type == FileType_Al
 323:Service/Srv_Upgrade.c ****     {
 324:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_FileInfo_Error;
 325:Service/Srv_Upgrade.c ****     }
 326:Service/Srv_Upgrade.c ****     else
 327:Service/Srv_Upgrade.c ****     {
 328:Service/Srv_Upgrade.c ****         /* check file info */
 329:Service/Srv_Upgrade.c ****         if (Monitor.info_update && (Monitor.adapter_obj == NULL))
 330:Service/Srv_Upgrade.c ****         {
 331:Service/Srv_Upgrade.c ****             Monitor.adapter_obj = SrvFileAdapter.create(Monitor.FileInfo.Adapter_Type, Monitor.File
 332:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 333:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_Adapter_Error;
 334:Service/Srv_Upgrade.c ****         }
 335:Service/Srv_Upgrade.c ****     }
 336:Service/Srv_Upgrade.c **** 
 337:Service/Srv_Upgrade.c ****     if (Monitor.adapter_obj && send)
 338:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 339:Service/Srv_Upgrade.c **** 
 340:Service/Srv_Upgrade.c ****     switch ((uint8_t) Monitor.PollingState)
 341:Service/Srv_Upgrade.c ****     {
 342:Service/Srv_Upgrade.c ****         case Stage_Init:            
 343:Service/Srv_Upgrade.c ****             Monitor.PollingState = Stage_Process_PortData;
 344:Service/Srv_Upgrade.c ****             Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 345:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 346:Service/Srv_Upgrade.c **** 
 347:Service/Srv_Upgrade.c ****         case Stage_Process_PortData:
 348:Service/Srv_Upgrade.c ****             /* check double stream data */
 349:Service/Srv_Upgrade.c ****             for (i = 0; i < 2; i++)
 350:Service/Srv_Upgrade.c ****             {
 351:Service/Srv_Upgrade.c ****                 if (Monitor.proc_stream[i].size)
 352:Service/Srv_Upgrade.c ****                 {
 353:Service/Srv_Upgrade.c ****                     /* received data from port */
 354:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 355:Service/Srv_Upgrade.c ****                     break;
 356:Service/Srv_Upgrade.c ****                 }
 357:Service/Srv_Upgrade.c ****             }
 358:Service/Srv_Upgrade.c ****             
 359:Service/Srv_Upgrade.c ****             switch (SrvUpgrade_PortProcPolling(sys_time))
 360:Service/Srv_Upgrade.c ****             {
 361:Service/Srv_Upgrade.c ****                 case ProtProc_Finish:
 362:Service/Srv_Upgrade.c ****                     Monitor.PollingState = SrvUpgrade_On_PortProc_Finish();
 363:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 364:Service/Srv_Upgrade.c ****                     break;
 365:Service/Srv_Upgrade.c **** 
 366:Service/Srv_Upgrade.c ****                 /* still developping this branch */
 367:Service/Srv_Upgrade.c ****                 case PortProc_Deal_TimeOut: /* Monitor.PollingState = Stage_TimeOut;*/ break;
 368:Service/Srv_Upgrade.c ****                 case PortProc_Deal_Error: 
 369:Service/Srv_Upgrade.c ****                     Monitor.PollingState = Stage_PortData_Error;
 370:Service/Srv_Upgrade.c ****                     SrvUpgrade_Collect_Info("\tUpgrade data process error\r\n");
 371:Service/Srv_Upgrade.c ****                     break;
 372:Service/Srv_Upgrade.c **** 
 373:Service/Srv_Upgrade.c ****                 default: break;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 8


 374:Service/Srv_Upgrade.c ****             }
 375:Service/Srv_Upgrade.c **** 
 376:Service/Srv_Upgrade.c ****             /* check for processing time out when at app */
 377:Service/Srv_Upgrade.c ****             if (Monitor.discard_time <= sys_time)
 378:Service/Srv_Upgrade.c ****             {
 379:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_TimeOut;
 380:Service/Srv_Upgrade.c ****                 if (Monitor.adapter_obj)
 381:Service/Srv_Upgrade.c ****                 {
 382:Service/Srv_Upgrade.c ****                     SrvFileAdapter.destory(Monitor.adapter_obj);
 383:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 384:Service/Srv_Upgrade.c ****                 }
 385:Service/Srv_Upgrade.c ****             }
 386:Service/Srv_Upgrade.c ****             return Stage_Process_PortData;
 387:Service/Srv_Upgrade.c **** 
 388:Service/Srv_Upgrade.c ****         /* firmware upgrading */
 389:Service/Srv_Upgrade.c ****         case Stage_Reboot:
 390:Service/Srv_Upgrade.c ****             return Stage_Reboot;
 391:Service/Srv_Upgrade.c **** 
 392:Service/Srv_Upgrade.c ****         /* when at bootloader */
 393:Service/Srv_Upgrade.c ****         case Stage_ReadyToJump:
 394:Service/Srv_Upgrade.c ****             return Stage_ReadyToJump;
 395:Service/Srv_Upgrade.c **** 
 396:Service/Srv_Upgrade.c ****         /* error process */
 397:Service/Srv_Upgrade.c ****         case Stage_FileInfo_Error:
 398:Service/Srv_Upgrade.c ****             return Stage_FileInfo_Error;
 399:Service/Srv_Upgrade.c **** 
 400:Service/Srv_Upgrade.c ****         case Stage_Upgrade_Error:
 401:Service/Srv_Upgrade.c ****         case Stage_Adapter_Error:
 402:Service/Srv_Upgrade.c ****         case Stage_PortData_Error:
 403:Service/Srv_Upgrade.c ****             Monitor.PollingState = Stage_Init;
 404:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj)
 405:Service/Srv_Upgrade.c ****             {
 406:Service/Srv_Upgrade.c ****                 SrvUpgrade_Collect_Info("\tDestory adapter object\r\n");
 407:Service/Srv_Upgrade.c ****                 SrvUpgrade_Collect_Info("\tUpgrade abort\r\n");
 408:Service/Srv_Upgrade.c ****                 SrvFileAdapter.destory(Monitor.adapter_obj);
 409:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 410:Service/Srv_Upgrade.c ****             }
 411:Service/Srv_Upgrade.c ****             return Stage_Adapter_Error;
 412:Service/Srv_Upgrade.c **** 
 413:Service/Srv_Upgrade.c ****         case Stage_TimeOut:
 414:Service/Srv_Upgrade.c ****             Monitor.PollingState = Stage_Init;
 415:Service/Srv_Upgrade.c ****             return Stage_TimeOut;
 416:Service/Srv_Upgrade.c **** 
 417:Service/Srv_Upgrade.c ****         case Stage_UpgradeInfo_Error:
 418:Service/Srv_Upgrade.c ****             return Stage_UpgradeInfo_Error;
 419:Service/Srv_Upgrade.c **** 
 420:Service/Srv_Upgrade.c ****         default: return Stage_Unknow;
 421:Service/Srv_Upgrade.c ****     }
 422:Service/Srv_Upgrade.c **** }
 423:Service/Srv_Upgrade.c **** 
 424:Service/Srv_Upgrade.c **** static void SrvUpgrade_SetFileInfo(const FileInfo_TypeDef info)
 425:Service/Srv_Upgrade.c **** {
  28              		.loc 1 425 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 16
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 9


  33 0000 84B0     		sub	sp, sp, #16
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36 0002 0DF1040C 		add	ip, sp, #4
  37 0006 8CE80700 		stm	ip, {r0, r1, r2}
 426:Service/Srv_Upgrade.c ****     Monitor.info_update = true;
  38              		.loc 1 426 5 view .LVU1
  39              		.loc 1 426 25 is_stmt 0 view .LVU2
  40 000a 054B     		ldr	r3, .L3
  41 000c 0122     		movs	r2, #1
  42 000e 83F85C20 		strb	r2, [r3, #92]
 427:Service/Srv_Upgrade.c ****     memcpy(&Monitor.FileInfo, &info, sizeof(FileInfo_TypeDef));
  43              		.loc 1 427 5 is_stmt 1 view .LVU3
  44 0012 6033     		adds	r3, r3, #96
  45 0014 9CE80700 		ldm	ip, {r0, r1, r2}
  46 0018 83E80700 		stm	r3, {r0, r1, r2}
 428:Service/Srv_Upgrade.c **** }
  47              		.loc 1 428 1 is_stmt 0 view .LVU4
  48 001c 04B0     		add	sp, sp, #16
  49              	.LCFI1:
  50              		.cfi_def_cfa_offset 0
  51              		@ sp needed
  52 001e 7047     		bx	lr
  53              	.L4:
  54              		.align	2
  55              	.L3:
  56 0020 00000000 		.word	.LANCHOR0
  57              		.cfi_endproc
  58              	.LFE156:
  60              		.section	.text.SrvUpgrade_PushData,"ax",%progbits
  61              		.align	1
  62              		.syntax unified
  63              		.thumb
  64              		.thumb_func
  66              	SrvUpgrade_PushData:
  67              	.LVL0:
  68              	.LFB157:
 429:Service/Srv_Upgrade.c **** 
 430:Service/Srv_Upgrade.c **** /* call this function in receive thread or irq */
 431:Service/Srv_Upgrade.c **** static bool SrvUpgrade_PushData(uint32_t sys_time, uint8_t *p_buf, uint16_t len)
 432:Service/Srv_Upgrade.c **** {
  69              		.loc 1 432 1 is_stmt 1 view -0
  70              		.cfi_startproc
  71              		@ args = 0, pretend = 0, frame = 0
  72              		@ frame_needed = 0, uses_anonymous_args = 0
  73              		.loc 1 432 1 is_stmt 0 view .LVU6
  74 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
  75              	.LCFI2:
  76              		.cfi_def_cfa_offset 32
  77              		.cfi_offset 3, -32
  78              		.cfi_offset 4, -28
  79              		.cfi_offset 5, -24
  80              		.cfi_offset 6, -20
  81              		.cfi_offset 7, -16
  82              		.cfi_offset 8, -12
  83              		.cfi_offset 9, -8
  84              		.cfi_offset 14, -4
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 10


 433:Service/Srv_Upgrade.c ****     if (Monitor.init_state)
  85              		.loc 1 433 5 is_stmt 1 view .LVU7
  86              		.loc 1 433 16 is_stmt 0 view .LVU8
  87 0004 1E4B     		ldr	r3, .L12
  88 0006 1E78     		ldrb	r6, [r3]	@ zero_extendqisi2
  89              		.loc 1 433 8 view .LVU9
  90 0008 B6B3     		cbz	r6, .L6
  91 000a 1546     		mov	r5, r2
 434:Service/Srv_Upgrade.c ****     {
 435:Service/Srv_Upgrade.c ****         Monitor.rec_time = sys_time;
  92              		.loc 1 435 9 is_stmt 1 view .LVU10
  93              		.loc 1 435 26 is_stmt 0 view .LVU11
  94 000c D860     		str	r0, [r3, #12]
 436:Service/Srv_Upgrade.c ****         Monitor.rec_timeout = Monitor.rec_time + FIRMWARE_COMMU_TIMEOUT;
  95              		.loc 1 436 9 is_stmt 1 view .LVU12
  96              		.loc 1 436 48 is_stmt 0 view .LVU13
  97 000e 00F57A70 		add	r0, r0, #1000
  98              	.LVL1:
  99              		.loc 1 436 29 view .LVU14
 100 0012 9860     		str	r0, [r3, #8]
 437:Service/Srv_Upgrade.c **** 
 438:Service/Srv_Upgrade.c ****         for (uint8_t i = 0; i < 2; i++)
 101              		.loc 1 438 9 is_stmt 1 view .LVU15
 102              	.LBB2:
 103              		.loc 1 438 14 view .LVU16
 104              	.LVL2:
 105              		.loc 1 438 22 is_stmt 0 view .LVU17
 106 0014 0023     		movs	r3, #0
 107              		.loc 1 438 9 view .LVU18
 108 0016 01E0     		b	.L7
 109              	.LVL3:
 110              	.L8:
 111              		.loc 1 438 36 is_stmt 1 discriminator 2 view .LVU19
 112              		.loc 1 438 37 is_stmt 0 discriminator 2 view .LVU20
 113 0018 0133     		adds	r3, r3, #1
 114              	.LVL4:
 115              		.loc 1 438 37 discriminator 2 view .LVU21
 116 001a DBB2     		uxtb	r3, r3
 117              	.LVL5:
 118              	.L7:
 119              		.loc 1 438 29 is_stmt 1 discriminator 1 view .LVU22
 120              		.loc 1 438 9 is_stmt 0 discriminator 1 view .LVU23
 121 001c 012B     		cmp	r3, #1
 122 001e 2AD8     		bhi	.L11
 439:Service/Srv_Upgrade.c ****         {
 440:Service/Srv_Upgrade.c ****             if ((!Monitor.proc_stream[i].access) && \
 123              		.loc 1 440 13 is_stmt 1 view .LVU24
 124              		.loc 1 440 41 is_stmt 0 view .LVU25
 125 0020 03EB4300 		add	r0, r3, r3, lsl #1
 126 0024 164C     		ldr	r4, .L12
 127              		.loc 1 440 41 view .LVU26
 128 0026 04EB8000 		add	r0, r4, r0, lsl #2
 129 002a 90F86C20 		ldrb	r2, [r0, #108]	@ zero_extendqisi2
 130              		.loc 1 440 16 view .LVU27
 131 002e 002A     		cmp	r2, #0
 132 0030 F2D1     		bne	.L8
 441:Service/Srv_Upgrade.c ****                 ((Monitor.proc_stream[i].size + len) <= Monitor.proc_stream[i].total_size))
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 11


 133              		.loc 1 441 41 discriminator 1 view .LVU28
 134 0032 03EB4302 		add	r2, r3, r3, lsl #1
 135 0036 04EB8202 		add	r2, r4, r2, lsl #2
 136 003a B2F86E00 		ldrh	r0, [r2, #110]
 137              		.loc 1 441 47 discriminator 1 view .LVU29
 138 003e 2C18     		adds	r4, r5, r0
 139              		.loc 1 441 79 discriminator 1 view .LVU30
 140 0040 B2F87020 		ldrh	r2, [r2, #112]
 440:Service/Srv_Upgrade.c ****                 ((Monitor.proc_stream[i].size + len) <= Monitor.proc_stream[i].total_size))
 141              		.loc 1 440 50 discriminator 1 view .LVU31
 142 0044 9442     		cmp	r4, r2
 143 0046 E7DC     		bgt	.L8
 442:Service/Srv_Upgrade.c ****             {
 443:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].access = true;
 144              		.loc 1 443 17 is_stmt 1 view .LVU32
 145              		.loc 1 443 47 is_stmt 0 view .LVU33
 146 0048 DFF83480 		ldr	r8, .L12
 147              		.loc 1 443 47 view .LVU34
 148 004c 03EB4304 		add	r4, r3, r3, lsl #1
 149 0050 08EB8404 		add	r4, r8, r4, lsl #2
 150 0054 0123     		movs	r3, #1
 151              	.LVL6:
 152              		.loc 1 443 47 view .LVU35
 153 0056 84F86C30 		strb	r3, [r4, #108]
 444:Service/Srv_Upgrade.c ****                 memcpy(&Monitor.proc_stream[i].p_buf[Monitor.proc_stream[i].size], p_buf, len);
 154              		.loc 1 444 17 is_stmt 1 view .LVU36
 155              		.loc 1 444 47 is_stmt 0 view .LVU37
 156 005a 636F     		ldr	r3, [r4, #116]
 157              		.loc 1 444 17 view .LVU38
 158 005c 2A46     		mov	r2, r5
 159 005e 1844     		add	r0, r0, r3
 160 0060 FFF7FEFF 		bl	memcpy
 161              	.LVL7:
 445:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size += len;
 162              		.loc 1 445 17 is_stmt 1 view .LVU39
 163              		.loc 1 445 45 is_stmt 0 view .LVU40
 164 0064 B4F86E30 		ldrh	r3, [r4, #110]
 165 0068 1D44     		add	r5, r5, r3
 166 006a A4F86E50 		strh	r5, [r4, #110]	@ movhi
 446:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].access = false;
 167              		.loc 1 446 17 is_stmt 1 view .LVU41
 168              		.loc 1 446 47 is_stmt 0 view .LVU42
 169 006e 0023     		movs	r3, #0
 170 0070 84F86C30 		strb	r3, [r4, #108]
 447:Service/Srv_Upgrade.c ****                 return true;
 171              		.loc 1 447 17 is_stmt 1 view .LVU43
 172              		.loc 1 447 24 is_stmt 0 view .LVU44
 173 0074 00E0     		b	.L6
 174              	.LVL8:
 175              	.L11:
 176              		.loc 1 447 24 view .LVU45
 177              	.LBE2:
 448:Service/Srv_Upgrade.c ****             }
 449:Service/Srv_Upgrade.c ****         }
 450:Service/Srv_Upgrade.c ****     }
 451:Service/Srv_Upgrade.c **** 
 452:Service/Srv_Upgrade.c ****     return false;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 12


 178              		.loc 1 452 12 view .LVU46
 179 0076 0026     		movs	r6, #0
 180              	.LVL9:
 181              	.L6:
 453:Service/Srv_Upgrade.c **** }
 182              		.loc 1 453 1 view .LVU47
 183 0078 3046     		mov	r0, r6
 184 007a BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 185              	.L13:
 186 007e 00BF     		.align	2
 187              	.L12:
 188 0080 00000000 		.word	.LANCHOR0
 189              		.cfi_endproc
 190              	.LFE157:
 192              		.section	.text.SrvUpgrade_Get_Info,"ax",%progbits
 193              		.align	1
 194              		.syntax unified
 195              		.thumb
 196              		.thumb_func
 198              	SrvUpgrade_Get_Info:
 199              	.LVL10:
 200              	.LFB160:
 454:Service/Srv_Upgrade.c **** 
 455:Service/Srv_Upgrade.c **** static void SrvUpgrade_Set_FileInfo(const FileInfo_TypeDef info)
 456:Service/Srv_Upgrade.c **** {
 457:Service/Srv_Upgrade.c ****     memcpy(&Monitor.FileInfo, &info, sizeof(FileInfo_TypeDef));
 458:Service/Srv_Upgrade.c **** }
 459:Service/Srv_Upgrade.c **** 
 460:Service/Srv_Upgrade.c **** static void SrvUpgrade_Collect_Info(const char *format, ...)
 461:Service/Srv_Upgrade.c **** {
 462:Service/Srv_Upgrade.c ****     va_list args;
 463:Service/Srv_Upgrade.c ****     uint16_t buf_remain = 0;
 464:Service/Srv_Upgrade.c ****     uint16_t buf_capacity = sizeof(Monitor.LogOut_Info);
 465:Service/Srv_Upgrade.c ****     int16_t send_len = 0;
 466:Service/Srv_Upgrade.c **** 
 467:Service/Srv_Upgrade.c ****     if (format && (Monitor.LogOut_Info_size < buf_capacity))
 468:Service/Srv_Upgrade.c ****     {
 469:Service/Srv_Upgrade.c ****         buf_remain = buf_capacity - Monitor.LogOut_Info_size;
 470:Service/Srv_Upgrade.c **** 
 471:Service/Srv_Upgrade.c ****         va_start(args, format);
 472:Service/Srv_Upgrade.c **** 
 473:Service/Srv_Upgrade.c ****         send_len = vsnprintf((char *)(Monitor.LogOut_Info + Monitor.LogOut_Info_size), buf_remain, 
 474:Service/Srv_Upgrade.c ****         if (send_len > 0)
 475:Service/Srv_Upgrade.c ****             Monitor.LogOut_Info_size += send_len;
 476:Service/Srv_Upgrade.c **** 
 477:Service/Srv_Upgrade.c ****         va_end(args);
 478:Service/Srv_Upgrade.c ****     }
 479:Service/Srv_Upgrade.c **** }
 480:Service/Srv_Upgrade.c **** 
 481:Service/Srv_Upgrade.c **** static uint16_t SrvUpgrade_Get_Info(uint8_t *p_info, uint16_t len)
 482:Service/Srv_Upgrade.c **** {
 201              		.loc 1 482 1 is_stmt 1 view -0
 202              		.cfi_startproc
 203              		@ args = 0, pretend = 0, frame = 0
 204              		@ frame_needed = 0, uses_anonymous_args = 0
 483:Service/Srv_Upgrade.c ****     uint16_t log_size = 0;
 205              		.loc 1 483 5 view .LVU49
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 13


 484:Service/Srv_Upgrade.c **** 
 485:Service/Srv_Upgrade.c ****     if (p_info && len && (len >= Monitor.LogOut_Info_size) && Monitor.init_state)
 206              		.loc 1 485 5 view .LVU50
 207              		.loc 1 485 8 is_stmt 0 view .LVU51
 208 0000 98B1     		cbz	r0, .L16
 209              		.loc 1 485 16 discriminator 1 view .LVU52
 210 0002 A1B1     		cbz	r1, .L17
 211              		.loc 1 485 41 discriminator 2 view .LVU53
 212 0004 0C4A     		ldr	r2, .L25
 213 0006 B2F88424 		ldrh	r2, [r2, #1156]
 214              		.loc 1 485 23 discriminator 2 view .LVU54
 215 000a 8A42     		cmp	r2, r1
 216 000c 11D8     		bhi	.L18
 217              		.loc 1 485 70 discriminator 3 view .LVU55
 218 000e 0A49     		ldr	r1, .L25
 219              	.LVL11:
 220              		.loc 1 485 70 discriminator 3 view .LVU56
 221 0010 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
 222              		.loc 1 485 60 discriminator 3 view .LVU57
 223 0012 09B9     		cbnz	r1, .L24
 483:Service/Srv_Upgrade.c ****     uint16_t log_size = 0;
 224              		.loc 1 483 14 view .LVU58
 225 0014 0020     		movs	r0, #0
 226              	.LVL12:
 486:Service/Srv_Upgrade.c ****     {
 487:Service/Srv_Upgrade.c ****         log_size = Monitor.LogOut_Info_size;
 488:Service/Srv_Upgrade.c ****         memcpy(p_info, Monitor.LogOut_Info, Monitor.LogOut_Info_size);
 489:Service/Srv_Upgrade.c ****         log_size = Monitor.LogOut_Info_size;
 490:Service/Srv_Upgrade.c ****     }
 491:Service/Srv_Upgrade.c **** 
 492:Service/Srv_Upgrade.c ****     return log_size;
 227              		.loc 1 492 5 is_stmt 1 view .LVU59
 493:Service/Srv_Upgrade.c **** }
 228              		.loc 1 493 1 is_stmt 0 view .LVU60
 229 0016 7047     		bx	lr
 230              	.LVL13:
 231              	.L24:
 482:Service/Srv_Upgrade.c ****     uint16_t log_size = 0;
 232              		.loc 1 482 1 view .LVU61
 233 0018 10B5     		push	{r4, lr}
 234              	.LCFI3:
 235              		.cfi_def_cfa_offset 8
 236              		.cfi_offset 4, -8
 237              		.cfi_offset 14, -4
 487:Service/Srv_Upgrade.c ****         memcpy(p_info, Monitor.LogOut_Info, Monitor.LogOut_Info_size);
 238              		.loc 1 487 9 is_stmt 1 view .LVU62
 239              	.LVL14:
 488:Service/Srv_Upgrade.c ****         log_size = Monitor.LogOut_Info_size;
 240              		.loc 1 488 9 view .LVU63
 241 001a 074C     		ldr	r4, .L25
 242 001c 04F18401 		add	r1, r4, #132
 243 0020 FFF7FEFF 		bl	memcpy
 244              	.LVL15:
 489:Service/Srv_Upgrade.c ****     }
 245              		.loc 1 489 9 view .LVU64
 489:Service/Srv_Upgrade.c ****     }
 246              		.loc 1 489 18 is_stmt 0 view .LVU65
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 14


 247 0024 B4F88404 		ldrh	r0, [r4, #1156]
 248              	.LVL16:
 492:Service/Srv_Upgrade.c **** }
 249              		.loc 1 492 5 is_stmt 1 view .LVU66
 250              		.loc 1 493 1 is_stmt 0 view .LVU67
 251 0028 10BD     		pop	{r4, pc}
 252              	.LVL17:
 253              	.L16:
 254              	.LCFI4:
 255              		.cfi_def_cfa_offset 0
 256              		.cfi_restore 4
 257              		.cfi_restore 14
 483:Service/Srv_Upgrade.c **** 
 258              		.loc 1 483 14 view .LVU68
 259 002a 0020     		movs	r0, #0
 260              	.LVL18:
 483:Service/Srv_Upgrade.c **** 
 261              		.loc 1 483 14 view .LVU69
 262 002c 7047     		bx	lr
 263              	.LVL19:
 264              	.L17:
 483:Service/Srv_Upgrade.c **** 
 265              		.loc 1 483 14 view .LVU70
 266 002e 0846     		mov	r0, r1
 267              	.LVL20:
 483:Service/Srv_Upgrade.c **** 
 268              		.loc 1 483 14 view .LVU71
 269 0030 7047     		bx	lr
 270              	.LVL21:
 271              	.L18:
 483:Service/Srv_Upgrade.c **** 
 272              		.loc 1 483 14 view .LVU72
 273 0032 0020     		movs	r0, #0
 274              	.LVL22:
 483:Service/Srv_Upgrade.c **** 
 275              		.loc 1 483 14 view .LVU73
 276 0034 7047     		bx	lr
 277              	.L26:
 278 0036 00BF     		.align	2
 279              	.L25:
 280 0038 00000000 		.word	.LANCHOR0
 281              		.cfi_endproc
 282              	.LFE160:
 284              		.section	.text.SrvUpgrade_ClearLog,"ax",%progbits
 285              		.align	1
 286              		.syntax unified
 287              		.thumb
 288              		.thumb_func
 290              	SrvUpgrade_ClearLog:
 291              	.LFB161:
 494:Service/Srv_Upgrade.c **** 
 495:Service/Srv_Upgrade.c **** static void SrvUpgrade_ClearLog(void)
 496:Service/Srv_Upgrade.c **** {
 292              		.loc 1 496 1 is_stmt 1 view -0
 293              		.cfi_startproc
 294              		@ args = 0, pretend = 0, frame = 0
 295              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 15


 296 0000 10B5     		push	{r4, lr}
 297              	.LCFI5:
 298              		.cfi_def_cfa_offset 8
 299              		.cfi_offset 4, -8
 300              		.cfi_offset 14, -4
 497:Service/Srv_Upgrade.c ****     memset(Monitor.LogOut_Info, 0, sizeof(Monitor.LogOut_Info));
 301              		.loc 1 497 5 view .LVU75
 302 0002 064C     		ldr	r4, .L29
 303 0004 4FF48062 		mov	r2, #1024
 304 0008 0021     		movs	r1, #0
 305 000a 04F18400 		add	r0, r4, #132
 306 000e FFF7FEFF 		bl	memset
 307              	.LVL23:
 498:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 308              		.loc 1 498 5 view .LVU76
 309              		.loc 1 498 30 is_stmt 0 view .LVU77
 310 0012 0023     		movs	r3, #0
 311 0014 A4F88434 		strh	r3, [r4, #1156]	@ movhi
 499:Service/Srv_Upgrade.c **** }
 312              		.loc 1 499 1 view .LVU78
 313 0018 10BD     		pop	{r4, pc}
 314              	.L30:
 315 001a 00BF     		.align	2
 316              	.L29:
 317 001c 00000000 		.word	.LANCHOR0
 318              		.cfi_endproc
 319              	.LFE161:
 321              		.section	.text.SrvUpgrade_PortProcPolling,"ax",%progbits
 322              		.align	1
 323              		.syntax unified
 324              		.thumb
 325              		.thumb_func
 327              	SrvUpgrade_PortProcPolling:
 328              	.LVL24:
 329              	.LFB153:
 215:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List ret;
 330              		.loc 1 215 1 is_stmt 1 view -0
 331              		.cfi_startproc
 332              		@ args = 0, pretend = 0, frame = 0
 333              		@ frame_needed = 0, uses_anonymous_args = 0
 215:Service/Srv_Upgrade.c ****     SrvUpgrade_PortDataProc_List ret;
 334              		.loc 1 215 1 is_stmt 0 view .LVU80
 335 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 336              	.LCFI6:
 337              		.cfi_def_cfa_offset 24
 338              		.cfi_offset 3, -24
 339              		.cfi_offset 4, -20
 340              		.cfi_offset 5, -16
 341              		.cfi_offset 6, -12
 342              		.cfi_offset 7, -8
 343              		.cfi_offset 14, -4
 216:Service/Srv_Upgrade.c ****     Adapter_Polling_State adapter_state; 
 344              		.loc 1 216 5 is_stmt 1 view .LVU81
 217:Service/Srv_Upgrade.c **** 
 345              		.loc 1 217 5 view .LVU82
 219:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 346              		.loc 1 219 5 view .LVU83
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 16


 219:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 347              		.loc 1 219 16 is_stmt 0 view .LVU84
 348 0002 384B     		ldr	r3, .L48
 349 0004 9B6D     		ldr	r3, [r3, #88]
 219:Service/Srv_Upgrade.c ****         return PortProc_Deal_Error;
 350              		.loc 1 219 8 view .LVU85
 351 0006 002B     		cmp	r3, #0
 352 0008 68D0     		beq	.L40
 353 000a 0646     		mov	r6, r0
 354              	.LBB3:
 222:Service/Srv_Upgrade.c ****     {
 355              		.loc 1 222 18 view .LVU86
 356 000c 0024     		movs	r4, #0
 357 000e 09E0     		b	.L33
 358              	.LVL25:
 359              	.L35:
 234:Service/Srv_Upgrade.c ****         }
 360              		.loc 1 234 13 is_stmt 1 view .LVU87
 234:Service/Srv_Upgrade.c ****         }
 361              		.loc 1 234 43 is_stmt 0 view .LVU88
 362 0010 05EB4505 		add	r5, r5, r5, lsl #1
 363 0014 334B     		ldr	r3, .L48
 364 0016 03EB8505 		add	r5, r3, r5, lsl #2
 365 001a 0023     		movs	r3, #0
 366 001c 85F86C30 		strb	r3, [r5, #108]
 367              	.L34:
 222:Service/Srv_Upgrade.c ****     {
 368              		.loc 1 222 32 is_stmt 1 discriminator 2 view .LVU89
 222:Service/Srv_Upgrade.c ****     {
 369              		.loc 1 222 34 is_stmt 0 discriminator 2 view .LVU90
 370 0020 0134     		adds	r4, r4, #1
 371              	.LVL26:
 222:Service/Srv_Upgrade.c ****     {
 372              		.loc 1 222 34 discriminator 2 view .LVU91
 373 0022 E4B2     		uxtb	r4, r4
 374              	.LVL27:
 375              	.L33:
 222:Service/Srv_Upgrade.c ****     {
 376              		.loc 1 222 25 is_stmt 1 discriminator 1 view .LVU92
 222:Service/Srv_Upgrade.c ****     {
 377              		.loc 1 222 5 is_stmt 0 discriminator 1 view .LVU93
 378 0024 012C     		cmp	r4, #1
 379 0026 2DD8     		bhi	.L45
 224:Service/Srv_Upgrade.c ****         {
 380              		.loc 1 224 9 is_stmt 1 view .LVU94
 224:Service/Srv_Upgrade.c ****         {
 381              		.loc 1 224 36 is_stmt 0 view .LVU95
 382 0028 2546     		mov	r5, r4
 383 002a 04EB4403 		add	r3, r4, r4, lsl #1
 384 002e 2D4A     		ldr	r2, .L48
 385 0030 02EB8303 		add	r3, r2, r3, lsl #2
 386 0034 93F86C30 		ldrb	r3, [r3, #108]	@ zero_extendqisi2
 224:Service/Srv_Upgrade.c ****         {
 387              		.loc 1 224 12 view .LVU96
 388 0038 002B     		cmp	r3, #0
 389 003a F1D1     		bne	.L34
 224:Service/Srv_Upgrade.c ****         {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 17


 390              		.loc 1 224 69 discriminator 1 view .LVU97
 391 003c 04EB4403 		add	r3, r4, r4, lsl #1
 392 0040 02EB8303 		add	r3, r2, r3, lsl #2
 393 0044 B3F86E10 		ldrh	r1, [r3, #110]
 224:Service/Srv_Upgrade.c ****         {
 394              		.loc 1 224 44 discriminator 1 view .LVU98
 395 0048 0029     		cmp	r1, #0
 396 004a E9D0     		beq	.L34
 226:Service/Srv_Upgrade.c **** 
 397              		.loc 1 226 13 is_stmt 1 view .LVU99
 226:Service/Srv_Upgrade.c **** 
 398              		.loc 1 226 43 is_stmt 0 view .LVU100
 399 004c 04EB4403 		add	r3, r4, r4, lsl #1
 400 0050 02EB8303 		add	r3, r2, r3, lsl #2
 401 0054 0122     		movs	r2, #1
 402 0056 83F86C20 		strb	r2, [r3, #108]
 228:Service/Srv_Upgrade.c ****             {
 403              		.loc 1 228 13 is_stmt 1 view .LVU101
 228:Service/Srv_Upgrade.c ****             {
 404              		.loc 1 228 31 is_stmt 0 view .LVU102
 405 005a 234A     		ldr	r2, .L48+4
 406 005c 5268     		ldr	r2, [r2, #4]
 228:Service/Srv_Upgrade.c ****             {
 407              		.loc 1 228 17 view .LVU103
 408 005e 586F     		ldr	r0, [r3, #116]
 409 0060 9047     		blx	r2
 410              	.LVL28:
 228:Service/Srv_Upgrade.c ****             {
 411              		.loc 1 228 16 view .LVU104
 412 0062 0028     		cmp	r0, #0
 413 0064 D4D0     		beq	.L35
 230:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 414              		.loc 1 230 17 is_stmt 1 view .LVU105
 230:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 415              		.loc 1 230 46 is_stmt 0 view .LVU106
 416 0066 04EB4407 		add	r7, r4, r4, lsl #1
 417 006a 1E4B     		ldr	r3, .L48
 418 006c 03EB8707 		add	r7, r3, r7, lsl #2
 230:Service/Srv_Upgrade.c ****                 Monitor.proc_stream[i].size = 0;
 419              		.loc 1 230 17 view .LVU107
 420 0070 B7F86E20 		ldrh	r2, [r7, #110]
 421 0074 0021     		movs	r1, #0
 422 0076 786F     		ldr	r0, [r7, #116]
 423 0078 FFF7FEFF 		bl	memset
 424              	.LVL29:
 231:Service/Srv_Upgrade.c ****             }
 425              		.loc 1 231 17 is_stmt 1 view .LVU108
 231:Service/Srv_Upgrade.c ****             }
 426              		.loc 1 231 45 is_stmt 0 view .LVU109
 427 007c 0023     		movs	r3, #0
 428 007e A7F86E30 		strh	r3, [r7, #110]	@ movhi
 429 0082 C5E7     		b	.L35
 430              	.L45:
 431              	.LBE3:
 238:Service/Srv_Upgrade.c ****     {
 432              		.loc 1 238 5 is_stmt 1 view .LVU110
 238:Service/Srv_Upgrade.c ****     {
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 18


 433              		.loc 1 238 29 is_stmt 0 view .LVU111
 434 0084 174B     		ldr	r3, .L48
 435 0086 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
 238:Service/Srv_Upgrade.c ****     {
 436              		.loc 1 238 5 view .LVU112
 437 0088 0128     		cmp	r0, #1
 438 008a 0CD0     		beq	.L37
 439 008c 0228     		cmp	r0, #2
 440 008e 18D0     		beq	.L38
 441 0090 28B1     		cbz	r0, .L46
 442 0092 0620     		movs	r0, #6
 443              	.L39:
 267:Service/Srv_Upgrade.c ****     {
 444              		.loc 1 267 57 discriminator 1 view .LVU113
 445 0094 134B     		ldr	r3, .L48
 446 0096 9B68     		ldr	r3, [r3, #8]
 267:Service/Srv_Upgrade.c ****     {
 447              		.loc 1 267 34 discriminator 1 view .LVU114
 448 0098 B342     		cmp	r3, r6
 449 009a 18D9     		bls	.L47
 450              	.LVL30:
 451              	.L32:
 275:Service/Srv_Upgrade.c **** 
 452              		.loc 1 275 1 view .LVU115
 453 009c F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 454              	.LVL31:
 455              	.L46:
 241:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 456              		.loc 1 241 13 is_stmt 1 view .LVU116
 241:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 457              		.loc 1 241 44 is_stmt 0 view .LVU117
 458 009e 06F57A73 		add	r3, r6, #1000
 241:Service/Srv_Upgrade.c ****         case PortProc_Deal_Pack:
 459              		.loc 1 241 33 view .LVU118
 460 00a2 104A     		ldr	r2, .L48
 461 00a4 9360     		str	r3, [r2, #8]
 462              	.L37:
 243:Service/Srv_Upgrade.c ****             adapter_state = SrvFileAdapter.polling(sys_time, Monitor.adapter_obj);
 463              		.loc 1 243 13 is_stmt 1 view .LVU119
 243:Service/Srv_Upgrade.c ****             adapter_state = SrvFileAdapter.polling(sys_time, Monitor.adapter_obj);
 464              		.loc 1 243 35 is_stmt 0 view .LVU120
 465 00a6 0F4B     		ldr	r3, .L48
 466 00a8 0122     		movs	r2, #1
 467 00aa 9A70     		strb	r2, [r3, #2]
 244:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 468              		.loc 1 244 13 is_stmt 1 view .LVU121
 244:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 469              		.loc 1 244 43 is_stmt 0 view .LVU122
 470 00ac 0E4A     		ldr	r2, .L48+4
 471 00ae 1269     		ldr	r2, [r2, #16]
 244:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Pack;
 472              		.loc 1 244 29 view .LVU123
 473 00b0 996D     		ldr	r1, [r3, #88]
 474 00b2 3046     		mov	r0, r6
 475 00b4 9047     		blx	r2
 476              	.LVL32:
 245:Service/Srv_Upgrade.c ****             
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 19


 477              		.loc 1 245 13 is_stmt 1 view .LVU124
 248:Service/Srv_Upgrade.c ****             {
 478              		.loc 1 248 13 view .LVU125
 479 00b6 0228     		cmp	r0, #2
 480 00b8 12D0     		beq	.L42
 481 00ba 0328     		cmp	r0, #3
 482 00bc 05D1     		bne	.L43
 483 00be 0220     		movs	r0, #2
 484              	.LVL33:
 248:Service/Srv_Upgrade.c ****             {
 485              		.loc 1 248 13 is_stmt 0 view .LVU126
 486 00c0 E8E7     		b	.L39
 487              	.LVL34:
 488              	.L38:
 257:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Error;
 489              		.loc 1 257 13 is_stmt 1 view .LVU127
 257:Service/Srv_Upgrade.c ****             ret = PortProc_Deal_Error;
 490              		.loc 1 257 35 is_stmt 0 view .LVU128
 491 00c2 084B     		ldr	r3, .L48
 492 00c4 0022     		movs	r2, #0
 493 00c6 9A70     		strb	r2, [r3, #2]
 258:Service/Srv_Upgrade.c ****             break;
 494              		.loc 1 258 13 is_stmt 1 view .LVU129
 495              	.LVL35:
 259:Service/Srv_Upgrade.c **** 
 496              		.loc 1 259 13 view .LVU130
 267:Service/Srv_Upgrade.c ****     {
 497              		.loc 1 267 5 view .LVU131
 498 00c8 E4E7     		b	.L39
 499              	.LVL36:
 500              	.L43:
 245:Service/Srv_Upgrade.c ****             
 501              		.loc 1 245 17 is_stmt 0 view .LVU132
 502 00ca 0120     		movs	r0, #1
 503              	.LVL37:
 245:Service/Srv_Upgrade.c ****             
 504              		.loc 1 245 17 view .LVU133
 505 00cc E2E7     		b	.L39
 506              	.LVL38:
 507              	.L47:
 269:Service/Srv_Upgrade.c ****         Monitor.PortDataState = PortProc_None;
 508              		.loc 1 269 9 is_stmt 1 view .LVU134
 269:Service/Srv_Upgrade.c ****         Monitor.PortDataState = PortProc_None;
 509              		.loc 1 269 29 is_stmt 0 view .LVU135
 510 00ce 054B     		ldr	r3, .L48
 511 00d0 0022     		movs	r2, #0
 512 00d2 83F85C20 		strb	r2, [r3, #92]
 270:Service/Srv_Upgrade.c ****         ret = PortProc_Deal_TimeOut;
 513              		.loc 1 270 9 is_stmt 1 view .LVU136
 270:Service/Srv_Upgrade.c ****         ret = PortProc_Deal_TimeOut;
 514              		.loc 1 270 31 is_stmt 0 view .LVU137
 515 00d6 9A70     		strb	r2, [r3, #2]
 271:Service/Srv_Upgrade.c ****     }
 516              		.loc 1 271 9 is_stmt 1 view .LVU138
 517              	.LVL39:
 271:Service/Srv_Upgrade.c ****     }
 518              		.loc 1 271 13 is_stmt 0 view .LVU139
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 20


 519 00d8 0420     		movs	r0, #4
 520 00da DFE7     		b	.L32
 521              	.LVL40:
 522              	.L40:
 220:Service/Srv_Upgrade.c **** 
 523              		.loc 1 220 16 view .LVU140
 524 00dc 0220     		movs	r0, #2
 525              	.LVL41:
 220:Service/Srv_Upgrade.c **** 
 526              		.loc 1 220 16 view .LVU141
 527 00de DDE7     		b	.L32
 528              	.LVL42:
 529              	.L42:
 220:Service/Srv_Upgrade.c **** 
 530              		.loc 1 220 16 view .LVU142
 531 00e0 0320     		movs	r0, #3
 532              	.LVL43:
 220:Service/Srv_Upgrade.c **** 
 533              		.loc 1 220 16 view .LVU143
 534 00e2 DBE7     		b	.L32
 535              	.L49:
 536              		.align	2
 537              	.L48:
 538 00e4 00000000 		.word	.LANCHOR0
 539 00e8 00000000 		.word	SrvFileAdapter
 540              		.cfi_endproc
 541              	.LFE153:
 543              		.section	.rodata.SrvUpgrade_CheckUpgrade_OnBootUp.str1.4,"aMS",%progbits,1
 544              		.align	2
 545              	.LC0:
 546 0000 55706772 		.ascii	"Upgrade_Info\000"
 546      6164655F 
 546      496E666F 
 546      00
 547              		.section	.text.SrvUpgrade_CheckUpgrade_OnBootUp,"ax",%progbits
 548              		.align	1
 549              		.syntax unified
 550              		.thumb
 551              		.thumb_func
 553              	SrvUpgrade_CheckUpgrade_OnBootUp:
 554              	.LFB152:
 166:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 555              		.loc 1 166 1 is_stmt 1 view -0
 556              		.cfi_startproc
 557              		@ args = 0, pretend = 0, frame = 88
 558              		@ frame_needed = 0, uses_anonymous_args = 0
 559 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 560              	.LCFI7:
 561              		.cfi_def_cfa_offset 28
 562              		.cfi_offset 4, -28
 563              		.cfi_offset 5, -24
 564              		.cfi_offset 6, -20
 565              		.cfi_offset 7, -16
 566              		.cfi_offset 8, -12
 567              		.cfi_offset 9, -8
 568              		.cfi_offset 14, -4
 569 0004 A7B0     		sub	sp, sp, #156
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 21


 570              	.LCFI8:
 571              		.cfi_def_cfa_offset 184
 167:Service/Srv_Upgrade.c ****     uint32_t file_size = 0;
 572              		.loc 1 167 5 view .LVU145
 168:Service/Srv_Upgrade.c ****     uint16_t update_size = 0;
 573              		.loc 1 168 5 view .LVU146
 574              	.LVL44:
 169:Service/Srv_Upgrade.c ****     uint32_t addr_offset = 0;
 575              		.loc 1 169 5 view .LVU147
 170:Service/Srv_Upgrade.c **** 
 576              		.loc 1 170 5 view .LVU148
 172:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 577              		.loc 1 172 5 view .LVU149
 578 0006 344C     		ldr	r4, .L56
 579 0008 04F11005 		add	r5, r4, #16
 580 000c 4526     		movs	r6, #69
 581 000e 3246     		mov	r2, r6
 582 0010 0021     		movs	r1, #0
 583 0012 2846     		mov	r0, r5
 584 0014 FFF7FEFF 		bl	memset
 585              	.LVL45:
 173:Service/Srv_Upgrade.c **** 
 586              		.loc 1 173 5 view .LVU150
 587 0018 0021     		movs	r1, #0
 588 001a 2291     		str	r1, [sp, #136]
 589 001c 2391     		str	r1, [sp, #140]
 590 001e 2491     		str	r1, [sp, #144]
 591 0020 8DF89410 		strb	r1, [sp, #148]
 176:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 592              		.loc 1 176 5 view .LVU151
 176:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 593              		.loc 1 176 37 is_stmt 0 view .LVU152
 594 0024 2D4B     		ldr	r3, .L56+4
 595 0026 5B68     		ldr	r3, [r3, #4]
 176:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 596              		.loc 1 176 30 view .LVU153
 597 0028 2D4A     		ldr	r2, .L56+8
 598 002a 10A8     		add	r0, sp, #64
 599 002c 9847     		blx	r3
 600              	.LVL46:
 601 002e 3246     		mov	r2, r6
 602 0030 10A9     		add	r1, sp, #64
 603 0032 2846     		mov	r0, r5
 604 0034 FFF7FEFF 		bl	memcpy
 605              	.LVL47:
 177:Service/Srv_Upgrade.c ****     {
 606              		.loc 1 177 5 is_stmt 1 view .LVU154
 177:Service/Srv_Upgrade.c ****     {
 607              		.loc 1 177 31 is_stmt 0 view .LVU155
 608 0038 2369     		ldr	r3, [r4, #16]
 177:Service/Srv_Upgrade.c ****     {
 609              		.loc 1 177 8 view .LVU156
 610 003a 9BB3     		cbz	r3, .L51
 179:Service/Srv_Upgrade.c ****         /* read parameter section */
 611              		.loc 1 179 9 is_stmt 1 view .LVU157
 179:Service/Srv_Upgrade.c ****         /* read parameter section */
 612              		.loc 1 179 16 is_stmt 0 view .LVU158
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 22


 613 003c 274B     		ldr	r3, .L56+4
 614 003e 1E69     		ldr	r6, [r3, #16]
 179:Service/Srv_Upgrade.c ****         /* read parameter section */
 615              		.loc 1 179 9 view .LVU159
 616 0040 0D22     		movs	r2, #13
 617 0042 0E92     		str	r2, [sp, #56]
 618 0044 22AA     		add	r2, sp, #136
 619 0046 0D92     		str	r2, [sp, #52]
 620 0048 D4F81590 		ldr	r9, [r4, #21]	@ unaligned
 621 004c D4F81980 		ldr	r8, [r4, #25]	@ unaligned
 622 0050 D4F81D70 		ldr	r7, [r4, #29]	@ unaligned
 623 0054 04F1210C 		add	ip, r4, #33
 624 0058 6D46     		mov	r5, sp
 625 005a 5134     		adds	r4, r4, #81
 626              	.L52:
 627 005c AE46     		mov	lr, r5
 628 005e DCF80000 		ldr	r0, [ip]	@ unaligned
 629 0062 DCF80410 		ldr	r1, [ip, #4]	@ unaligned
 630 0066 DCF80820 		ldr	r2, [ip, #8]	@ unaligned
 631 006a DCF80C30 		ldr	r3, [ip, #12]	@ unaligned
 632 006e AEE80F00 		stmia	lr!, {r0, r1, r2, r3}
 633 0072 0CF1100C 		add	ip, ip, #16
 634 0076 7546     		mov	r5, lr
 635 0078 A445     		cmp	ip, r4
 636 007a EFD1     		bne	.L52
 637 007c DCF80000 		ldr	r0, [ip]	@ unaligned
 638 0080 CEF80000 		str	r0, [lr]
 639 0084 4946     		mov	r1, r9
 640 0086 4246     		mov	r2, r8
 641 0088 3B46     		mov	r3, r7
 642 008a 0020     		movs	r0, #0
 643 008c B047     		blx	r6
 644              	.LVL48:
 181:Service/Srv_Upgrade.c ****         {
 645              		.loc 1 181 9 is_stmt 1 view .LVU160
 181:Service/Srv_Upgrade.c ****         {
 646              		.loc 1 181 15 view .LVU161
 647              	.L53:
 207:Service/Srv_Upgrade.c ****     {
 648              		.loc 1 207 5 view .LVU162
 207:Service/Srv_Upgrade.c ****     {
 649              		.loc 1 207 31 is_stmt 0 view .LVU163
 650 008e 124B     		ldr	r3, .L56
 651 0090 1B69     		ldr	r3, [r3, #16]
 207:Service/Srv_Upgrade.c ****     {
 652              		.loc 1 207 8 view .LVU164
 653 0092 23B9     		cbnz	r3, .L50
 209:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_UpgradeInfo_Error;
 654              		.loc 1 209 9 is_stmt 1 view .LVU165
 209:Service/Srv_Upgrade.c ****         Monitor.PollingState = Stage_UpgradeInfo_Error;
 655              		.loc 1 209 28 is_stmt 0 view .LVU166
 656 0094 104B     		ldr	r3, .L56
 657 0096 0022     		movs	r2, #0
 658 0098 1A70     		strb	r2, [r3]
 210:Service/Srv_Upgrade.c ****     }
 659              		.loc 1 210 9 is_stmt 1 view .LVU167
 210:Service/Srv_Upgrade.c ****     }
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 23


 660              		.loc 1 210 30 is_stmt 0 view .LVU168
 661 009a 0222     		movs	r2, #2
 662 009c 5A70     		strb	r2, [r3, #1]
 663              	.L50:
 212:Service/Srv_Upgrade.c **** 
 664              		.loc 1 212 1 view .LVU169
 665 009e 27B0     		add	sp, sp, #156
 666              	.LCFI9:
 667              		.cfi_remember_state
 668              		.cfi_def_cfa_offset 28
 669              		@ sp needed
 670 00a0 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 671              	.L51:
 672              	.LCFI10:
 673              		.cfi_restore_state
 202:Service/Srv_Upgrade.c ****         Storage.create(Para_Boot, UpgradeInfo_Sec, (uint8_t *)(&Info), sizeof(SrvUpgradeInfo_TypeDe
 674              		.loc 1 202 9 is_stmt 1 view .LVU170
 675 00a4 0F4B     		ldr	r3, .L56+12
 676 00a6 1A88     		ldrh	r2, [r3]	@ unaligned
 677 00a8 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 678 00aa ADF88E20 		strh	r2, [sp, #142]	@ unaligned
 679 00ae 8DF89030 		strb	r3, [sp, #144]
 203:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 680              		.loc 1 203 9 view .LVU171
 203:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 681              		.loc 1 203 16 is_stmt 0 view .LVU172
 682 00b2 0A4D     		ldr	r5, .L56+4
 683 00b4 AE68     		ldr	r6, [r5, #8]
 203:Service/Srv_Upgrade.c ****         Monitor.UpgradeInfo_SO = Storage.search(Para_Boot, UpgradeInfo_Sec);
 684              		.loc 1 203 9 view .LVU173
 685 00b6 0A4C     		ldr	r4, .L56+8
 686 00b8 0D23     		movs	r3, #13
 687 00ba 22AA     		add	r2, sp, #136
 688 00bc 2146     		mov	r1, r4
 689 00be 0020     		movs	r0, #0
 690 00c0 B047     		blx	r6
 691              	.LVL49:
 204:Service/Srv_Upgrade.c ****     }
 692              		.loc 1 204 9 is_stmt 1 view .LVU174
 204:Service/Srv_Upgrade.c ****     }
 693              		.loc 1 204 41 is_stmt 0 view .LVU175
 694 00c2 6B68     		ldr	r3, [r5, #4]
 204:Service/Srv_Upgrade.c ****     }
 695              		.loc 1 204 34 view .LVU176
 696 00c4 2246     		mov	r2, r4
 697 00c6 0021     		movs	r1, #0
 698 00c8 10A8     		add	r0, sp, #64
 699 00ca 9847     		blx	r3
 700              	.LVL50:
 701 00cc 4522     		movs	r2, #69
 702 00ce 10A9     		add	r1, sp, #64
 703 00d0 0548     		ldr	r0, .L56+16
 704 00d2 FFF7FEFF 		bl	memcpy
 705              	.LVL51:
 706 00d6 DAE7     		b	.L53
 707              	.L57:
 708              		.align	2
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 24


 709              	.L56:
 710 00d8 00000000 		.word	.LANCHOR0
 711 00dc 00000000 		.word	Storage
 712 00e0 00000000 		.word	.LC0
 713 00e4 00000000 		.word	.LANCHOR1
 714 00e8 10000000 		.word	.LANCHOR0+16
 715              		.cfi_endproc
 716              	.LFE152:
 718              		.section	.text.SrvUpgrade_Init,"ax",%progbits
 719              		.align	1
 720              		.syntax unified
 721              		.thumb
 722              		.thumb_func
 724              	SrvUpgrade_Init:
 725              	.LFB151:
 128:Service/Srv_Upgrade.c ****     if (sizeof(upgrade_buf) % 2)
 726              		.loc 1 128 1 is_stmt 1 view -0
 727              		.cfi_startproc
 728              		@ args = 0, pretend = 0, frame = 0
 729              		@ frame_needed = 0, uses_anonymous_args = 0
 730 0000 70B5     		push	{r4, r5, r6, lr}
 731              	.LCFI11:
 732              		.cfi_def_cfa_offset 16
 733              		.cfi_offset 4, -16
 734              		.cfi_offset 5, -12
 735              		.cfi_offset 6, -8
 736              		.cfi_offset 14, -4
 129:Service/Srv_Upgrade.c ****         return false;
 737              		.loc 1 129 5 view .LVU178
 133:Service/Srv_Upgrade.c ****     memset(&Monitor.FileInfo, 0, sizeof(Monitor.FileInfo));
 738              		.loc 1 133 5 view .LVU179
 133:Service/Srv_Upgrade.c ****     memset(&Monitor.FileInfo, 0, sizeof(Monitor.FileInfo));
 739              		.loc 1 133 25 is_stmt 0 view .LVU180
 740 0002 154C     		ldr	r4, .L60
 741 0004 0025     		movs	r5, #0
 742 0006 84F85C50 		strb	r5, [r4, #92]
 134:Service/Srv_Upgrade.c **** 
 743              		.loc 1 134 5 is_stmt 1 view .LVU181
 744 000a 2566     		str	r5, [r4, #96]
 745 000c 6566     		str	r5, [r4, #100]
 746 000e A566     		str	r5, [r4, #104]
 137:Service/Srv_Upgrade.c **** 
 747              		.loc 1 137 5 view .LVU182
 137:Service/Srv_Upgrade.c **** 
 748              		.loc 1 137 30 is_stmt 0 view .LVU183
 749 0010 A4F88454 		strh	r5, [r4, #1156]	@ movhi
 139:Service/Srv_Upgrade.c ****     Monitor.LogOut_Info_size = 0;
 750              		.loc 1 139 5 is_stmt 1 view .LVU184
 751 0014 4FF48062 		mov	r2, #1024
 752 0018 2946     		mov	r1, r5
 753 001a 04F18400 		add	r0, r4, #132
 754 001e FFF7FEFF 		bl	memset
 755              	.LVL52:
 140:Service/Srv_Upgrade.c ****     
 756              		.loc 1 140 5 view .LVU185
 143:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].size = 0;
 757              		.loc 1 143 5 view .LVU186
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 25


 143:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].size = 0;
 758              		.loc 1 143 35 is_stmt 0 view .LVU187
 759 0022 84F86C50 		strb	r5, [r4, #108]
 144:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].total_size = sizeof(upgrade_buf) / 2;
 760              		.loc 1 144 5 is_stmt 1 view .LVU188
 144:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].total_size = sizeof(upgrade_buf) / 2;
 761              		.loc 1 144 33 is_stmt 0 view .LVU189
 762 0026 A4F86E50 		strh	r5, [r4, #110]	@ movhi
 145:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].p_buf = upgrade_buf;
 763              		.loc 1 145 5 is_stmt 1 view .LVU190
 145:Service/Srv_Upgrade.c ****     Monitor.proc_stream[0].p_buf = upgrade_buf;
 764              		.loc 1 145 39 is_stmt 0 view .LVU191
 765 002a 4FF40062 		mov	r2, #2048
 766 002e A4F87020 		strh	r2, [r4, #112]	@ movhi
 146:Service/Srv_Upgrade.c **** 
 767              		.loc 1 146 5 is_stmt 1 view .LVU192
 146:Service/Srv_Upgrade.c **** 
 768              		.loc 1 146 34 is_stmt 0 view .LVU193
 769 0032 0A4B     		ldr	r3, .L60+4
 770 0034 6367     		str	r3, [r4, #116]
 148:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].size = 0;
 771              		.loc 1 148 5 is_stmt 1 view .LVU194
 148:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].size = 0;
 772              		.loc 1 148 35 is_stmt 0 view .LVU195
 773 0036 84F87850 		strb	r5, [r4, #120]
 149:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].total_size = sizeof(upgrade_buf) / 2;
 774              		.loc 1 149 5 is_stmt 1 view .LVU196
 149:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].total_size = sizeof(upgrade_buf) / 2;
 775              		.loc 1 149 33 is_stmt 0 view .LVU197
 776 003a A4F87A50 		strh	r5, [r4, #122]	@ movhi
 150:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].p_buf = &upgrade_buf[sizeof(upgrade_buf) / 2];
 777              		.loc 1 150 5 is_stmt 1 view .LVU198
 150:Service/Srv_Upgrade.c ****     Monitor.proc_stream[1].p_buf = &upgrade_buf[sizeof(upgrade_buf) / 2];
 778              		.loc 1 150 39 is_stmt 0 view .LVU199
 779 003e A4F87C20 		strh	r2, [r4, #124]	@ movhi
 151:Service/Srv_Upgrade.c **** 
 780              		.loc 1 151 5 is_stmt 1 view .LVU200
 151:Service/Srv_Upgrade.c **** 
 781              		.loc 1 151 34 is_stmt 0 view .LVU201
 782 0042 1344     		add	r3, r3, r2
 783 0044 C4F88030 		str	r3, [r4, #128]
 153:Service/Srv_Upgrade.c ****     Monitor.PollingState = Stage_Init;
 784              		.loc 1 153 5 is_stmt 1 view .LVU202
 153:Service/Srv_Upgrade.c ****     Monitor.PollingState = Stage_Init;
 785              		.loc 1 153 24 is_stmt 0 view .LVU203
 786 0048 0126     		movs	r6, #1
 787 004a 2670     		strb	r6, [r4]
 154:Service/Srv_Upgrade.c ****     Monitor.PortDataState = PortProc_None;
 788              		.loc 1 154 5 is_stmt 1 view .LVU204
 154:Service/Srv_Upgrade.c ****     Monitor.PortDataState = PortProc_None;
 789              		.loc 1 154 26 is_stmt 0 view .LVU205
 790 004c 6570     		strb	r5, [r4, #1]
 155:Service/Srv_Upgrade.c ****     
 791              		.loc 1 155 5 is_stmt 1 view .LVU206
 155:Service/Srv_Upgrade.c ****     
 792              		.loc 1 155 27 is_stmt 0 view .LVU207
 793 004e A570     		strb	r5, [r4, #2]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 26


 161:Service/Srv_Upgrade.c ****     return true;
 794              		.loc 1 161 5 is_stmt 1 view .LVU208
 795 0050 FFF7FEFF 		bl	SrvUpgrade_CheckUpgrade_OnBootUp
 796              	.LVL53:
 162:Service/Srv_Upgrade.c **** }
 797              		.loc 1 162 5 view .LVU209
 163:Service/Srv_Upgrade.c **** 
 798              		.loc 1 163 1 is_stmt 0 view .LVU210
 799 0054 3046     		mov	r0, r6
 800 0056 70BD     		pop	{r4, r5, r6, pc}
 801              	.L61:
 802              		.align	2
 803              	.L60:
 804 0058 00000000 		.word	.LANCHOR0
 805 005c 00000000 		.word	upgrade_buf
 806              		.cfi_endproc
 807              	.LFE151:
 809              		.section	.text.SrvUpgrade_Collect_Info,"ax",%progbits
 810              		.align	1
 811              		.syntax unified
 812              		.thumb
 813              		.thumb_func
 815              	SrvUpgrade_Collect_Info:
 816              	.LVL54:
 817              	.LFB159:
 461:Service/Srv_Upgrade.c ****     va_list args;
 818              		.loc 1 461 1 is_stmt 1 view -0
 819              		.cfi_startproc
 820              		@ args = 4, pretend = 16, frame = 8
 821              		@ frame_needed = 0, uses_anonymous_args = 1
 461:Service/Srv_Upgrade.c ****     va_list args;
 822              		.loc 1 461 1 is_stmt 0 view .LVU212
 823 0000 0FB4     		push	{r0, r1, r2, r3}
 824              	.LCFI12:
 825              		.cfi_def_cfa_offset 16
 826              		.cfi_offset 0, -16
 827              		.cfi_offset 1, -12
 828              		.cfi_offset 2, -8
 829              		.cfi_offset 3, -4
 830 0002 10B5     		push	{r4, lr}
 831              	.LCFI13:
 832              		.cfi_def_cfa_offset 24
 833              		.cfi_offset 4, -24
 834              		.cfi_offset 14, -20
 835 0004 82B0     		sub	sp, sp, #8
 836              	.LCFI14:
 837              		.cfi_def_cfa_offset 32
 838 0006 049A     		ldr	r2, [sp, #16]
 462:Service/Srv_Upgrade.c ****     uint16_t buf_remain = 0;
 839              		.loc 1 462 5 is_stmt 1 view .LVU213
 463:Service/Srv_Upgrade.c ****     uint16_t buf_capacity = sizeof(Monitor.LogOut_Info);
 840              		.loc 1 463 5 view .LVU214
 841              	.LVL55:
 464:Service/Srv_Upgrade.c ****     int16_t send_len = 0;
 842              		.loc 1 464 5 view .LVU215
 465:Service/Srv_Upgrade.c **** 
 843              		.loc 1 465 5 view .LVU216
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 27


 467:Service/Srv_Upgrade.c ****     {
 844              		.loc 1 467 5 view .LVU217
 467:Service/Srv_Upgrade.c ****     {
 845              		.loc 1 467 8 is_stmt 0 view .LVU218
 846 0008 2AB1     		cbz	r2, .L62
 467:Service/Srv_Upgrade.c ****     {
 847              		.loc 1 467 27 discriminator 1 view .LVU219
 848 000a 114B     		ldr	r3, .L67
 849 000c B3F88414 		ldrh	r1, [r3, #1156]
 467:Service/Srv_Upgrade.c ****     {
 850              		.loc 1 467 16 discriminator 1 view .LVU220
 851 0010 B1F5806F 		cmp	r1, #1024
 852 0014 04D3     		bcc	.L66
 853              	.LVL56:
 854              	.L62:
 479:Service/Srv_Upgrade.c **** 
 855              		.loc 1 479 1 view .LVU221
 856 0016 02B0     		add	sp, sp, #8
 857              	.LCFI15:
 858              		.cfi_remember_state
 859              		.cfi_def_cfa_offset 24
 860              		@ sp needed
 861 0018 BDE81040 		pop	{r4, lr}
 862              	.LCFI16:
 863              		.cfi_restore 14
 864              		.cfi_restore 4
 865              		.cfi_def_cfa_offset 16
 866 001c 04B0     		add	sp, sp, #16
 867              	.LCFI17:
 868              		.cfi_restore 3
 869              		.cfi_restore 2
 870              		.cfi_restore 1
 871              		.cfi_restore 0
 872              		.cfi_def_cfa_offset 0
 873 001e 7047     		bx	lr
 874              	.LVL57:
 875              	.L66:
 876              	.LCFI18:
 877              		.cfi_restore_state
 469:Service/Srv_Upgrade.c **** 
 878              		.loc 1 469 9 is_stmt 1 view .LVU222
 469:Service/Srv_Upgrade.c **** 
 879              		.loc 1 469 20 is_stmt 0 view .LVU223
 880 0020 C1F58061 		rsb	r1, r1, #1024
 881              	.LVL58:
 471:Service/Srv_Upgrade.c **** 
 882              		.loc 1 471 9 is_stmt 1 view .LVU224
 883 0024 05AB     		add	r3, sp, #20
 884 0026 0193     		str	r3, [sp, #4]
 473:Service/Srv_Upgrade.c ****         if (send_len > 0)
 885              		.loc 1 473 9 view .LVU225
 473:Service/Srv_Upgrade.c ****         if (send_len > 0)
 886              		.loc 1 473 68 is_stmt 0 view .LVU226
 887 0028 094C     		ldr	r4, .L67
 888 002a B4F88404 		ldrh	r0, [r4, #1156]
 473:Service/Srv_Upgrade.c ****         if (send_len > 0)
 889              		.loc 1 473 20 view .LVU227
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 28


 890 002e 8434     		adds	r4, r4, #132
 891 0030 89B2     		uxth	r1, r1
 473:Service/Srv_Upgrade.c ****         if (send_len > 0)
 892              		.loc 1 473 20 view .LVU228
 893 0032 2044     		add	r0, r0, r4
 894 0034 FFF7FEFF 		bl	vsnprintf
 895              	.LVL59:
 473:Service/Srv_Upgrade.c ****         if (send_len > 0)
 896              		.loc 1 473 18 view .LVU229
 897 0038 03B2     		sxth	r3, r0
 898              	.LVL60:
 474:Service/Srv_Upgrade.c ****             Monitor.LogOut_Info_size += send_len;
 899              		.loc 1 474 9 is_stmt 1 view .LVU230
 474:Service/Srv_Upgrade.c ****             Monitor.LogOut_Info_size += send_len;
 900              		.loc 1 474 12 is_stmt 0 view .LVU231
 901 003a 002B     		cmp	r3, #0
 902 003c EBDD     		ble	.L62
 475:Service/Srv_Upgrade.c **** 
 903              		.loc 1 475 13 is_stmt 1 view .LVU232
 475:Service/Srv_Upgrade.c **** 
 904              		.loc 1 475 38 is_stmt 0 view .LVU233
 905 003e A4F18403 		sub	r3, r4, #132
 906              	.LVL61:
 475:Service/Srv_Upgrade.c **** 
 907              		.loc 1 475 38 view .LVU234
 908 0042 B3F88424 		ldrh	r2, [r3, #1156]
 909 0046 1044     		add	r0, r0, r2
 910              	.LVL62:
 475:Service/Srv_Upgrade.c **** 
 911              		.loc 1 475 38 view .LVU235
 912 0048 A3F88404 		strh	r0, [r3, #1156]	@ movhi
 477:Service/Srv_Upgrade.c ****     }
 913              		.loc 1 477 9 is_stmt 1 view .LVU236
 479:Service/Srv_Upgrade.c **** 
 914              		.loc 1 479 1 is_stmt 0 view .LVU237
 915 004c E3E7     		b	.L62
 916              	.L68:
 917 004e 00BF     		.align	2
 918              	.L67:
 919 0050 00000000 		.word	.LANCHOR0
 920              		.cfi_endproc
 921              	.LFE159:
 923              		.section	.rodata.SrvUpgrade_On_PortProc_Finish.str1.4,"aMS",%progbits,1
 924              		.align	2
 925              	.LC2:
 926 0000 09417070 		.ascii	"\011App firmware receive finished\015\012\000"
 926      20666972 
 926      6D776172 
 926      65207265 
 926      63656976 
 927 0021 000000   		.align	2
 928              	.LC3:
 929 0024 41707020 		.ascii	"App firmware hardware version error\015\012\000"
 929      6669726D 
 929      77617265 
 929      20686172 
 929      64776172 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 29


 930 004a 0000     		.align	2
 931              	.LC4:
 932 004c 0946696C 		.ascii	"\011File size: %d\015\012\000"
 932      65207369 
 932      7A653A20 
 932      25640D0A 
 932      00
 933 005d 000000   		.align	2
 934              	.LC5:
 935 0060 0948573A 		.ascii	"\011HW: %d.%d.%d\015\012\000"
 935      2025642E 
 935      25642E25 
 935      640D0A00 
 936              		.align	2
 937              	.LC6:
 938 0070 0953573A 		.ascii	"\011SW: %d.%d.%d\015\012\000"
 938      2025642E 
 938      25642E25 
 938      640D0A00 
 939              		.section	.text.SrvUpgrade_On_PortProc_Finish,"ax",%progbits
 940              		.align	1
 941              		.syntax unified
 942              		.thumb
 943              		.thumb_func
 945              	SrvUpgrade_On_PortProc_Finish:
 946              	.LFB154:
 278:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 947              		.loc 1 278 1 is_stmt 1 view -0
 948              		.cfi_startproc
 949              		@ args = 0, pretend = 0, frame = 48
 950              		@ frame_needed = 0, uses_anonymous_args = 0
 951 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 952              	.LCFI19:
 953              		.cfi_def_cfa_offset 28
 954              		.cfi_offset 4, -28
 955              		.cfi_offset 5, -24
 956              		.cfi_offset 6, -20
 957              		.cfi_offset 7, -16
 958              		.cfi_offset 8, -12
 959              		.cfi_offset 9, -8
 960              		.cfi_offset 14, -4
 961 0004 9DB0     		sub	sp, sp, #116
 962              	.LCFI20:
 963              		.cfi_def_cfa_offset 144
 279:Service/Srv_Upgrade.c ****     FileInfo_TypeDef rec_file_info;
 964              		.loc 1 279 5 view .LVU239
 280:Service/Srv_Upgrade.c **** 
 965              		.loc 1 280 5 view .LVU240
 282:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 966              		.loc 1 282 5 view .LVU241
 967 0006 0023     		movs	r3, #0
 968 0008 1593     		str	r3, [sp, #84]
 969 000a 1693     		str	r3, [sp, #88]
 970 000c 1793     		str	r3, [sp, #92]
 283:Service/Srv_Upgrade.c **** 
 971              		.loc 1 283 5 view .LVU242
 972 000e 18AA     		add	r2, sp, #96
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 30


 973 0010 1893     		str	r3, [sp, #96]
 974 0012 1993     		str	r3, [sp, #100]
 975 0014 1A93     		str	r3, [sp, #104]
 976 0016 8DF86C30 		strb	r3, [sp, #108]
 287:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 977              		.loc 1 287 5 view .LVU243
 287:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 978              		.loc 1 287 12 is_stmt 0 view .LVU244
 979 001a 3F4B     		ldr	r3, .L77
 980 001c 1E69     		ldr	r6, [r3, #16]
 287:Service/Srv_Upgrade.c ****     rec_file_info = SrvFileAdapter.get_file_info(Monitor.adapter_obj);
 981              		.loc 1 287 5 view .LVU245
 982 001e 3F4B     		ldr	r3, .L77+4
 983 0020 0D21     		movs	r1, #13
 984 0022 0E91     		str	r1, [sp, #56]
 985 0024 0D92     		str	r2, [sp, #52]
 986 0026 D3F81590 		ldr	r9, [r3, #21]	@ unaligned
 987 002a D3F81980 		ldr	r8, [r3, #25]	@ unaligned
 988 002e D3F81D70 		ldr	r7, [r3, #29]	@ unaligned
 989 0032 03F1210C 		add	ip, r3, #33
 990 0036 6D46     		mov	r5, sp
 991 0038 03F1510E 		add	lr, r3, #81
 992              	.L70:
 993 003c 2C46     		mov	r4, r5
 994 003e DCF80000 		ldr	r0, [ip]	@ unaligned
 995 0042 DCF80410 		ldr	r1, [ip, #4]	@ unaligned
 996 0046 DCF80820 		ldr	r2, [ip, #8]	@ unaligned
 997 004a DCF80C30 		ldr	r3, [ip, #12]	@ unaligned
 998 004e 0FC4     		stmia	r4!, {r0, r1, r2, r3}
 999 0050 0CF1100C 		add	ip, ip, #16
 1000 0054 2546     		mov	r5, r4
 1001 0056 F445     		cmp	ip, lr
 1002 0058 F0D1     		bne	.L70
 1003 005a DCF80000 		ldr	r0, [ip]	@ unaligned
 1004 005e 2060     		str	r0, [r4]
 1005 0060 4946     		mov	r1, r9
 1006 0062 4246     		mov	r2, r8
 1007 0064 3B46     		mov	r3, r7
 1008 0066 0020     		movs	r0, #0
 1009 0068 B047     		blx	r6
 1010              	.LVL63:
 288:Service/Srv_Upgrade.c **** 
 1011              		.loc 1 288 5 is_stmt 1 view .LVU246
 288:Service/Srv_Upgrade.c **** 
 1012              		.loc 1 288 35 is_stmt 0 view .LVU247
 1013 006a 2D4B     		ldr	r3, .L77+8
 1014 006c 5B69     		ldr	r3, [r3, #20]
 288:Service/Srv_Upgrade.c **** 
 1015              		.loc 1 288 21 view .LVU248
 1016 006e 10AC     		add	r4, sp, #64
 1017 0070 2A4D     		ldr	r5, .L77+4
 1018 0072 A96D     		ldr	r1, [r5, #88]
 1019 0074 2046     		mov	r0, r4
 1020 0076 9847     		blx	r3
 1021              	.LVL64:
 1022 0078 15AB     		add	r3, sp, #84
 1023 007a 94E80700 		ldm	r4, {r0, r1, r2}
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 31


 1024 007e 83E80700 		stm	r3, {r0, r1, r2}
 290:Service/Srv_Upgrade.c ****     {
 1025              		.loc 1 290 5 is_stmt 1 view .LVU249
 290:Service/Srv_Upgrade.c ****     {
 1026              		.loc 1 290 25 is_stmt 0 view .LVU250
 1027 0082 95F86030 		ldrb	r3, [r5, #96]	@ zero_extendqisi2
 290:Service/Srv_Upgrade.c ****     {
 1028              		.loc 1 290 8 view .LVU251
 1029 0086 012B     		cmp	r3, #1
 1030 0088 27D0     		beq	.L75
 1031              	.L71:
 305:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tHW: %d.%d.%d\r\n", rec_file_info.HW_Ver[0], rec_file_info.HW_Ver[1],
 1032              		.loc 1 305 5 is_stmt 1 view .LVU252
 1033 008a 1799     		ldr	r1, [sp, #92]
 1034 008c 2548     		ldr	r0, .L77+12
 1035 008e FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1036              	.LVL65:
 306:Service/Srv_Upgrade.c ****     SrvUpgrade_Collect_Info("\tSW: %d.%d.%d\r\n", rec_file_info.SW_Ver[0], rec_file_info.SW_Ver[1],
 1037              		.loc 1 306 5 view .LVU253
 1038 0092 9DF85B30 		ldrb	r3, [sp, #91]	@ zero_extendqisi2
 1039 0096 9DF85A20 		ldrb	r2, [sp, #90]	@ zero_extendqisi2
 1040 009a 9DF85910 		ldrb	r1, [sp, #89]	@ zero_extendqisi2
 1041 009e 2248     		ldr	r0, .L77+16
 1042 00a0 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1043              	.LVL66:
 307:Service/Srv_Upgrade.c ****     Storage.update(Para_Boot, Monitor.UpgradeInfo_SO.item.data_addr, (uint8_t *)&Info, sizeof(SrvUp
 1044              		.loc 1 307 5 view .LVU254
 1045 00a4 9DF85830 		ldrb	r3, [sp, #88]	@ zero_extendqisi2
 1046 00a8 9DF85720 		ldrb	r2, [sp, #87]	@ zero_extendqisi2
 1047 00ac 9DF85610 		ldrb	r1, [sp, #86]	@ zero_extendqisi2
 1048 00b0 1E48     		ldr	r0, .L77+20
 1049 00b2 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1050              	.LVL67:
 308:Service/Srv_Upgrade.c **** 
 1051              		.loc 1 308 5 view .LVU255
 308:Service/Srv_Upgrade.c **** 
 1052              		.loc 1 308 12 is_stmt 0 view .LVU256
 1053 00b6 184B     		ldr	r3, .L77
 1054 00b8 DD68     		ldr	r5, [r3, #12]
 308:Service/Srv_Upgrade.c **** 
 1055              		.loc 1 308 5 view .LVU257
 1056 00ba 184C     		ldr	r4, .L77+4
 1057 00bc 0D23     		movs	r3, #13
 1058 00be 18AA     		add	r2, sp, #96
 1059 00c0 216C     		ldr	r1, [r4, #64]
 1060 00c2 0020     		movs	r0, #0
 1061 00c4 A847     		blx	r5
 1062              	.LVL68:
 311:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 1063              		.loc 1 311 5 is_stmt 1 view .LVU258
 311:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 1064              		.loc 1 311 19 is_stmt 0 view .LVU259
 1065 00c6 164B     		ldr	r3, .L77+8
 1066 00c8 9B68     		ldr	r3, [r3, #8]
 311:Service/Srv_Upgrade.c ****     Monitor.adapter_obj = NULL;
 1067              		.loc 1 311 5 view .LVU260
 1068 00ca A06D     		ldr	r0, [r4, #88]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 32


 1069 00cc 9847     		blx	r3
 1070              	.LVL69:
 312:Service/Srv_Upgrade.c **** 
 1071              		.loc 1 312 5 is_stmt 1 view .LVU261
 312:Service/Srv_Upgrade.c **** 
 1072              		.loc 1 312 25 is_stmt 0 view .LVU262
 1073 00ce 0023     		movs	r3, #0
 1074 00d0 A365     		str	r3, [r4, #88]
 315:Service/Srv_Upgrade.c **** }
 1075              		.loc 1 315 5 is_stmt 1 view .LVU263
 315:Service/Srv_Upgrade.c **** }
 1076              		.loc 1 315 12 is_stmt 0 view .LVU264
 1077 00d2 0120     		movs	r0, #1
 1078              	.L73:
 316:Service/Srv_Upgrade.c **** 
 1079              		.loc 1 316 1 view .LVU265
 1080 00d4 1DB0     		add	sp, sp, #116
 1081              	.LCFI21:
 1082              		.cfi_remember_state
 1083              		.cfi_def_cfa_offset 28
 1084              		@ sp needed
 1085 00d6 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 1086              	.L75:
 1087              	.LCFI22:
 1088              		.cfi_restore_state
 292:Service/Srv_Upgrade.c **** 
 1089              		.loc 1 292 9 is_stmt 1 view .LVU266
 1090 00da 1548     		ldr	r0, .L77+24
 1091 00dc FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1092              	.LVL70:
 294:Service/Srv_Upgrade.c ****         {
 1093              		.loc 1 294 9 view .LVU267
 294:Service/Srv_Upgrade.c ****         {
 1094              		.loc 1 294 13 is_stmt 0 view .LVU268
 1095 00e0 0322     		movs	r2, #3
 1096 00e2 1449     		ldr	r1, .L77+28
 1097 00e4 0DF16600 		add	r0, sp, #102
 1098 00e8 FFF7FEFF 		bl	memcmp
 1099              	.LVL71:
 294:Service/Srv_Upgrade.c ****         {
 1100              		.loc 1 294 12 view .LVU269
 1101 00ec 70B9     		cbnz	r0, .L76
 301:Service/Srv_Upgrade.c ****         Info.AF_Info = rec_file_info;
 1102              		.loc 1 301 9 is_stmt 1 view .LVU270
 301:Service/Srv_Upgrade.c ****         Info.AF_Info = rec_file_info;
 1103              		.loc 1 301 29 is_stmt 0 view .LVU271
 1104 00ee 9DF86030 		ldrb	r3, [sp, #96]	@ zero_extendqisi2
 1105 00f2 43F00103 		orr	r3, r3, #1
 1106 00f6 8DF86030 		strb	r3, [sp, #96]
 302:Service/Srv_Upgrade.c ****     }
 1107              		.loc 1 302 9 is_stmt 1 view .LVU272
 302:Service/Srv_Upgrade.c ****     }
 1108              		.loc 1 302 22 is_stmt 0 view .LVU273
 1109 00fa 15AB     		add	r3, sp, #84
 1110 00fc 07CB     		ldmia	r3!, {r0, r1, r2}
 1111 00fe CDF86100 		str	r0, [sp, #97]	@ unaligned
 1112 0102 CDF86510 		str	r1, [sp, #101]	@ unaligned
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 33


 1113 0106 CDF86920 		str	r2, [sp, #105]	@ unaligned
 1114 010a BEE7     		b	.L71
 1115              	.L76:
 296:Service/Srv_Upgrade.c ****             return Stage_Upgrade_Error;
 1116              		.loc 1 296 13 is_stmt 1 view .LVU274
 1117 010c 0A48     		ldr	r0, .L77+32
 1118 010e FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1119              	.LVL72:
 297:Service/Srv_Upgrade.c ****         }
 1120              		.loc 1 297 13 view .LVU275
 297:Service/Srv_Upgrade.c ****         }
 1121              		.loc 1 297 20 is_stmt 0 view .LVU276
 1122 0112 0620     		movs	r0, #6
 1123 0114 DEE7     		b	.L73
 1124              	.L78:
 1125 0116 00BF     		.align	2
 1126              	.L77:
 1127 0118 00000000 		.word	Storage
 1128 011c 00000000 		.word	.LANCHOR0
 1129 0120 00000000 		.word	SrvFileAdapter
 1130 0124 4C000000 		.word	.LC4
 1131 0128 60000000 		.word	.LC5
 1132 012c 70000000 		.word	.LC6
 1133 0130 00000000 		.word	.LC2
 1134 0134 00000000 		.word	.LANCHOR2
 1135 0138 24000000 		.word	.LC3
 1136              		.cfi_endproc
 1137              	.LFE154:
 1139              		.section	.rodata.SrvUpgrade_StatePolling.str1.4,"aMS",%progbits,1
 1140              		.align	2
 1141              	.LC7:
 1142 0000 09557067 		.ascii	"\011Upgrade data process error\015\012\000"
 1142      72616465 
 1142      20646174 
 1142      61207072 
 1142      6F636573 
 1143 001e 0000     		.align	2
 1144              	.LC8:
 1145 0020 09446573 		.ascii	"\011Destory adapter object\015\012\000"
 1145      746F7279 
 1145      20616461 
 1145      70746572 
 1145      206F626A 
 1146 003a 0000     		.align	2
 1147              	.LC9:
 1148 003c 09557067 		.ascii	"\011Upgrade abort\015\012\000"
 1148      72616465 
 1148      2061626F 
 1148      72740D0A 
 1148      00
 1149              		.section	.text.SrvUpgrade_StatePolling,"ax",%progbits
 1150              		.align	1
 1151              		.syntax unified
 1152              		.thumb
 1153              		.thumb_func
 1155              	SrvUpgrade_StatePolling:
 1156              	.LVL73:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 34


 1157              	.LFB155:
 319:Service/Srv_Upgrade.c ****     uint8_t i = 0;
 1158              		.loc 1 319 1 is_stmt 1 view -0
 1159              		.cfi_startproc
 1160              		@ args = 0, pretend = 0, frame = 0
 1161              		@ frame_needed = 0, uses_anonymous_args = 0
 319:Service/Srv_Upgrade.c ****     uint8_t i = 0;
 1162              		.loc 1 319 1 is_stmt 0 view .LVU278
 1163 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 1164              	.LCFI23:
 1165              		.cfi_def_cfa_offset 24
 1166              		.cfi_offset 3, -24
 1167              		.cfi_offset 4, -20
 1168              		.cfi_offset 5, -16
 1169              		.cfi_offset 6, -12
 1170              		.cfi_offset 7, -8
 1171              		.cfi_offset 14, -4
 1172 0002 0546     		mov	r5, r0
 1173 0004 0C46     		mov	r4, r1
 320:Service/Srv_Upgrade.c ****     
 1174              		.loc 1 320 5 is_stmt 1 view .LVU279
 1175              	.LVL74:
 322:Service/Srv_Upgrade.c ****     {
 1176              		.loc 1 322 5 view .LVU280
 322:Service/Srv_Upgrade.c ****     {
 1177              		.loc 1 322 26 is_stmt 0 view .LVU281
 1178 0006 484B     		ldr	r3, .L99
 1179 0008 93F86030 		ldrb	r3, [r3, #96]	@ zero_extendqisi2
 322:Service/Srv_Upgrade.c ****     {
 1180              		.loc 1 322 8 view .LVU282
 1181 000c B3B1     		cbz	r3, .L80
 322:Service/Srv_Upgrade.c ****     {
 1182              		.loc 1 322 55 discriminator 1 view .LVU283
 1183 000e 022B     		cmp	r3, #2
 1184 0010 14D0     		beq	.L80
 329:Service/Srv_Upgrade.c ****         {
 1185              		.loc 1 329 9 is_stmt 1 view .LVU284
 329:Service/Srv_Upgrade.c ****         {
 1186              		.loc 1 329 20 is_stmt 0 view .LVU285
 1187 0012 454B     		ldr	r3, .L99
 1188 0014 93F85C30 		ldrb	r3, [r3, #92]	@ zero_extendqisi2
 329:Service/Srv_Upgrade.c ****         {
 1189              		.loc 1 329 12 view .LVU286
 1190 0018 9BB1     		cbz	r3, .L82
 329:Service/Srv_Upgrade.c ****         {
 1191              		.loc 1 329 44 discriminator 1 view .LVU287
 1192 001a 434B     		ldr	r3, .L99
 1193 001c 9B6D     		ldr	r3, [r3, #88]
 329:Service/Srv_Upgrade.c ****         {
 1194              		.loc 1 329 33 discriminator 1 view .LVU288
 1195 001e 83B9     		cbnz	r3, .L82
 331:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1196              		.loc 1 331 13 is_stmt 1 view .LVU289
 331:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1197              		.loc 1 331 49 is_stmt 0 view .LVU290
 1198 0020 424B     		ldr	r3, .L99+4
 1199 0022 1F68     		ldr	r7, [r3]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 35


 331:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1200              		.loc 1 331 35 view .LVU291
 1201 0024 404E     		ldr	r6, .L99
 1202 0026 06F16003 		add	r3, r6, #96
 1203 002a 0ECB     		ldm	r3, {r1, r2, r3}
 1204              	.LVL75:
 331:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1205              		.loc 1 331 35 view .LVU292
 1206 002c 96F86100 		ldrb	r0, [r6, #97]	@ zero_extendqisi2
 1207              	.LVL76:
 331:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1208              		.loc 1 331 35 view .LVU293
 1209 0030 B847     		blx	r7
 1210              	.LVL77:
 331:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj == NULL)
 1211              		.loc 1 331 33 view .LVU294
 1212 0032 B065     		str	r0, [r6, #88]
 332:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_Adapter_Error;
 1213              		.loc 1 332 13 is_stmt 1 view .LVU295
 332:Service/Srv_Upgrade.c ****                 Monitor.PollingState = Stage_Adapter_Error;
 1214              		.loc 1 332 16 is_stmt 0 view .LVU296
 1215 0034 28B9     		cbnz	r0, .L82
 333:Service/Srv_Upgrade.c ****         }
 1216              		.loc 1 333 17 is_stmt 1 view .LVU297
 333:Service/Srv_Upgrade.c ****         }
 1217              		.loc 1 333 38 is_stmt 0 view .LVU298
 1218 0036 0322     		movs	r2, #3
 1219 0038 7270     		strb	r2, [r6, #1]
 1220 003a 02E0     		b	.L82
 1221              	.LVL78:
 1222              	.L80:
 324:Service/Srv_Upgrade.c ****     }
 1223              		.loc 1 324 9 is_stmt 1 view .LVU299
 324:Service/Srv_Upgrade.c ****     }
 1224              		.loc 1 324 30 is_stmt 0 view .LVU300
 1225 003c 3A4B     		ldr	r3, .L99
 1226 003e 0422     		movs	r2, #4
 1227 0040 5A70     		strb	r2, [r3, #1]
 1228              	.LVL79:
 1229              	.L82:
 337:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1230              		.loc 1 337 5 is_stmt 1 view .LVU301
 337:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1231              		.loc 1 337 16 is_stmt 0 view .LVU302
 1232 0042 394B     		ldr	r3, .L99
 1233 0044 986D     		ldr	r0, [r3, #88]
 337:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1234              		.loc 1 337 8 view .LVU303
 1235 0046 20B1     		cbz	r0, .L83
 337:Service/Srv_Upgrade.c ****         SrvFileAdapter.set_send(Monitor.adapter_obj, send);
 1236              		.loc 1 337 29 discriminator 1 view .LVU304
 1237 0048 1CB1     		cbz	r4, .L83
 338:Service/Srv_Upgrade.c **** 
 1238              		.loc 1 338 9 is_stmt 1 view .LVU305
 338:Service/Srv_Upgrade.c **** 
 1239              		.loc 1 338 23 is_stmt 0 view .LVU306
 1240 004a 384B     		ldr	r3, .L99+4
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 36


 1241 004c DB68     		ldr	r3, [r3, #12]
 338:Service/Srv_Upgrade.c **** 
 1242              		.loc 1 338 9 view .LVU307
 1243 004e 2146     		mov	r1, r4
 1244 0050 9847     		blx	r3
 1245              	.LVL80:
 1246              	.L83:
 340:Service/Srv_Upgrade.c ****     {
 1247              		.loc 1 340 5 is_stmt 1 view .LVU308
 340:Service/Srv_Upgrade.c ****     {
 1248              		.loc 1 340 30 is_stmt 0 view .LVU309
 1249 0052 354B     		ldr	r3, .L99
 1250 0054 5C78     		ldrb	r4, [r3, #1]	@ zero_extendqisi2
 1251              	.LVL81:
 340:Service/Srv_Upgrade.c ****     {
 1252              		.loc 1 340 5 view .LVU310
 1253 0056 092C     		cmp	r4, #9
 1254 0058 61D8     		bhi	.L84
 1255 005a DFE804F0 		tbb	[pc, r4]
 1256              	.L86:
 1257 005e 05       		.byte	(.L90-.L86)/2
 1258 005f 0C       		.byte	(.L85-.L86)/2
 1259 0060 0C       		.byte	(.L85-.L86)/2
 1260 0061 48       		.byte	(.L88-.L86)/2
 1261 0062 0C       		.byte	(.L85-.L86)/2
 1262 0063 3F       		.byte	(.L96-.L86)/2
 1263 0064 48       		.byte	(.L88-.L86)/2
 1264 0065 48       		.byte	(.L88-.L86)/2
 1265 0066 5C       		.byte	(.L87-.L86)/2
 1266 0067 0C       		.byte	(.L85-.L86)/2
 1267              		.p2align 1
 1268              	.L90:
 343:Service/Srv_Upgrade.c ****             Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1269              		.loc 1 343 13 is_stmt 1 view .LVU311
 343:Service/Srv_Upgrade.c ****             Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1270              		.loc 1 343 34 is_stmt 0 view .LVU312
 1271 0068 2F4B     		ldr	r3, .L99
 1272 006a 0524     		movs	r4, #5
 1273 006c 5C70     		strb	r4, [r3, #1]
 344:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1274              		.loc 1 344 13 is_stmt 1 view .LVU313
 344:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1275              		.loc 1 344 45 is_stmt 0 view .LVU314
 1276 006e 05F56A45 		add	r5, r5, #59904
 1277              	.LVL82:
 344:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1278              		.loc 1 344 45 view .LVU315
 1279 0072 6035     		adds	r5, r5, #96
 1280              	.LVL83:
 344:Service/Srv_Upgrade.c ****             return Monitor.PollingState;
 1281              		.loc 1 344 34 view .LVU316
 1282 0074 5D60     		str	r5, [r3, #4]
 345:Service/Srv_Upgrade.c **** 
 1283              		.loc 1 345 13 is_stmt 1 view .LVU317
 1284              	.LVL84:
 1285              	.L85:
 422:Service/Srv_Upgrade.c **** 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 37


 1286              		.loc 1 422 1 is_stmt 0 view .LVU318
 1287 0076 2046     		mov	r0, r4
 1288 0078 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1289              	.LVL85:
 1290              	.L91:
 349:Service/Srv_Upgrade.c ****             {
 1291              		.loc 1 349 32 is_stmt 1 discriminator 2 view .LVU319
 349:Service/Srv_Upgrade.c ****             {
 1292              		.loc 1 349 33 is_stmt 0 discriminator 2 view .LVU320
 1293 007a 0133     		adds	r3, r3, #1
 1294              	.LVL86:
 349:Service/Srv_Upgrade.c ****             {
 1295              		.loc 1 349 33 discriminator 2 view .LVU321
 1296 007c DBB2     		uxtb	r3, r3
 1297              	.LVL87:
 1298              	.L89:
 349:Service/Srv_Upgrade.c ****             {
 1299              		.loc 1 349 25 is_stmt 1 discriminator 1 view .LVU322
 349:Service/Srv_Upgrade.c ****             {
 1300              		.loc 1 349 13 is_stmt 0 discriminator 1 view .LVU323
 1301 007e 012B     		cmp	r3, #1
 1302 0080 0CD8     		bhi	.L92
 351:Service/Srv_Upgrade.c ****                 {
 1303              		.loc 1 351 17 is_stmt 1 view .LVU324
 351:Service/Srv_Upgrade.c ****                 {
 1304              		.loc 1 351 43 is_stmt 0 view .LVU325
 1305 0082 03EB4302 		add	r2, r3, r3, lsl #1
 1306 0086 2849     		ldr	r1, .L99
 1307 0088 01EB8202 		add	r2, r1, r2, lsl #2
 1308 008c B2F86E20 		ldrh	r2, [r2, #110]
 351:Service/Srv_Upgrade.c ****                 {
 1309              		.loc 1 351 20 view .LVU326
 1310 0090 002A     		cmp	r2, #0
 1311 0092 F2D0     		beq	.L91
 354:Service/Srv_Upgrade.c ****                     break;
 1312              		.loc 1 354 21 is_stmt 1 view .LVU327
 354:Service/Srv_Upgrade.c ****                     break;
 1313              		.loc 1 354 53 is_stmt 0 view .LVU328
 1314 0094 05F56A43 		add	r3, r5, #59904
 1315              	.LVL88:
 354:Service/Srv_Upgrade.c ****                     break;
 1316              		.loc 1 354 53 view .LVU329
 1317 0098 6033     		adds	r3, r3, #96
 354:Service/Srv_Upgrade.c ****                     break;
 1318              		.loc 1 354 42 view .LVU330
 1319 009a 4B60     		str	r3, [r1, #4]
 355:Service/Srv_Upgrade.c ****                 }
 1320              		.loc 1 355 21 is_stmt 1 view .LVU331
 1321              	.L92:
 359:Service/Srv_Upgrade.c ****             {
 1322              		.loc 1 359 13 view .LVU332
 359:Service/Srv_Upgrade.c ****             {
 1323              		.loc 1 359 21 is_stmt 0 view .LVU333
 1324 009c 2846     		mov	r0, r5
 1325 009e FFF7FEFF 		bl	SrvUpgrade_PortProcPolling
 1326              	.LVL89:
 1327 00a2 0228     		cmp	r0, #2
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 38


 1328 00a4 1CD0     		beq	.L94
 1329 00a6 0328     		cmp	r0, #3
 1330 00a8 07D1     		bne	.L95
 362:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1331              		.loc 1 362 21 is_stmt 1 view .LVU334
 362:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1332              		.loc 1 362 44 is_stmt 0 view .LVU335
 1333 00aa FFF7FEFF 		bl	SrvUpgrade_On_PortProc_Finish
 1334              	.LVL90:
 362:Service/Srv_Upgrade.c ****                     Monitor.discard_time = sys_time + FIRMWARE_WAITTING_TIMEOUT;
 1335              		.loc 1 362 42 view .LVU336
 1336 00ae 1E4A     		ldr	r2, .L99
 1337 00b0 5070     		strb	r0, [r2, #1]
 363:Service/Srv_Upgrade.c ****                     break;
 1338              		.loc 1 363 21 is_stmt 1 view .LVU337
 363:Service/Srv_Upgrade.c ****                     break;
 1339              		.loc 1 363 53 is_stmt 0 view .LVU338
 1340 00b2 05F56A43 		add	r3, r5, #59904
 1341 00b6 6033     		adds	r3, r3, #96
 363:Service/Srv_Upgrade.c ****                     break;
 1342              		.loc 1 363 42 view .LVU339
 1343 00b8 5360     		str	r3, [r2, #4]
 364:Service/Srv_Upgrade.c **** 
 1344              		.loc 1 364 21 is_stmt 1 view .LVU340
 1345              	.L95:
 377:Service/Srv_Upgrade.c ****             {
 1346              		.loc 1 377 13 view .LVU341
 377:Service/Srv_Upgrade.c ****             {
 1347              		.loc 1 377 24 is_stmt 0 view .LVU342
 1348 00ba 1B4B     		ldr	r3, .L99
 1349 00bc 5B68     		ldr	r3, [r3, #4]
 377:Service/Srv_Upgrade.c ****             {
 1350              		.loc 1 377 16 view .LVU343
 1351 00be AB42     		cmp	r3, r5
 1352 00c0 D9D8     		bhi	.L85
 379:Service/Srv_Upgrade.c ****                 if (Monitor.adapter_obj)
 1353              		.loc 1 379 17 is_stmt 1 view .LVU344
 379:Service/Srv_Upgrade.c ****                 if (Monitor.adapter_obj)
 1354              		.loc 1 379 38 is_stmt 0 view .LVU345
 1355 00c2 194B     		ldr	r3, .L99
 1356 00c4 0822     		movs	r2, #8
 1357 00c6 5A70     		strb	r2, [r3, #1]
 380:Service/Srv_Upgrade.c ****                 {
 1358              		.loc 1 380 17 is_stmt 1 view .LVU346
 380:Service/Srv_Upgrade.c ****                 {
 1359              		.loc 1 380 28 is_stmt 0 view .LVU347
 1360 00c8 986D     		ldr	r0, [r3, #88]
 380:Service/Srv_Upgrade.c ****                 {
 1361              		.loc 1 380 20 view .LVU348
 1362 00ca 0028     		cmp	r0, #0
 1363 00cc D3D0     		beq	.L85
 382:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 1364              		.loc 1 382 21 is_stmt 1 view .LVU349
 382:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 1365              		.loc 1 382 35 is_stmt 0 view .LVU350
 1366 00ce 174B     		ldr	r3, .L99+4
 1367 00d0 9B68     		ldr	r3, [r3, #8]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 39


 382:Service/Srv_Upgrade.c ****                     Monitor.adapter_obj = NULL;
 1368              		.loc 1 382 21 view .LVU351
 1369 00d2 9847     		blx	r3
 1370              	.LVL91:
 383:Service/Srv_Upgrade.c ****                 }
 1371              		.loc 1 383 21 is_stmt 1 view .LVU352
 383:Service/Srv_Upgrade.c ****                 }
 1372              		.loc 1 383 41 is_stmt 0 view .LVU353
 1373 00d4 144B     		ldr	r3, .L99
 1374 00d6 0022     		movs	r2, #0
 1375 00d8 9A65     		str	r2, [r3, #88]
 1376 00da CCE7     		b	.L85
 1377              	.LVL92:
 1378              	.L96:
 340:Service/Srv_Upgrade.c ****     {
 1379              		.loc 1 340 5 view .LVU354
 1380 00dc 0023     		movs	r3, #0
 1381 00de CEE7     		b	.L89
 1382              	.LVL93:
 1383              	.L94:
 369:Service/Srv_Upgrade.c ****                     SrvUpgrade_Collect_Info("\tUpgrade data process error\r\n");
 1384              		.loc 1 369 21 is_stmt 1 view .LVU355
 369:Service/Srv_Upgrade.c ****                     SrvUpgrade_Collect_Info("\tUpgrade data process error\r\n");
 1385              		.loc 1 369 42 is_stmt 0 view .LVU356
 1386 00e0 114B     		ldr	r3, .L99
 1387 00e2 0722     		movs	r2, #7
 1388 00e4 5A70     		strb	r2, [r3, #1]
 370:Service/Srv_Upgrade.c ****                     break;
 1389              		.loc 1 370 21 is_stmt 1 view .LVU357
 1390 00e6 1248     		ldr	r0, .L99+8
 1391 00e8 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1392              	.LVL94:
 371:Service/Srv_Upgrade.c **** 
 1393              		.loc 1 371 21 view .LVU358
 1394 00ec E5E7     		b	.L95
 1395              	.LVL95:
 1396              	.L88:
 403:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj)
 1397              		.loc 1 403 13 view .LVU359
 403:Service/Srv_Upgrade.c ****             if (Monitor.adapter_obj)
 1398              		.loc 1 403 34 is_stmt 0 view .LVU360
 1399 00ee 0E4B     		ldr	r3, .L99
 1400 00f0 0022     		movs	r2, #0
 1401 00f2 5A70     		strb	r2, [r3, #1]
 404:Service/Srv_Upgrade.c ****             {
 1402              		.loc 1 404 13 is_stmt 1 view .LVU361
 404:Service/Srv_Upgrade.c ****             {
 1403              		.loc 1 404 24 is_stmt 0 view .LVU362
 1404 00f4 9B6D     		ldr	r3, [r3, #88]
 404:Service/Srv_Upgrade.c ****             {
 1405              		.loc 1 404 16 view .LVU363
 1406 00f6 A3B1     		cbz	r3, .L97
 406:Service/Srv_Upgrade.c ****                 SrvUpgrade_Collect_Info("\tUpgrade abort\r\n");
 1407              		.loc 1 406 17 is_stmt 1 view .LVU364
 1408 00f8 0E48     		ldr	r0, .L99+12
 1409 00fa FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1410              	.LVL96:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 40


 407:Service/Srv_Upgrade.c ****                 SrvFileAdapter.destory(Monitor.adapter_obj);
 1411              		.loc 1 407 17 view .LVU365
 1412 00fe 0E48     		ldr	r0, .L99+16
 1413 0100 FFF7FEFF 		bl	SrvUpgrade_Collect_Info
 1414              	.LVL97:
 408:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 1415              		.loc 1 408 17 view .LVU366
 408:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 1416              		.loc 1 408 31 is_stmt 0 view .LVU367
 1417 0104 094B     		ldr	r3, .L99+4
 1418 0106 9B68     		ldr	r3, [r3, #8]
 408:Service/Srv_Upgrade.c ****                 Monitor.adapter_obj = NULL;
 1419              		.loc 1 408 17 view .LVU368
 1420 0108 074C     		ldr	r4, .L99
 1421 010a A06D     		ldr	r0, [r4, #88]
 1422 010c 9847     		blx	r3
 1423              	.LVL98:
 409:Service/Srv_Upgrade.c ****             }
 1424              		.loc 1 409 17 is_stmt 1 view .LVU369
 409:Service/Srv_Upgrade.c ****             }
 1425              		.loc 1 409 37 is_stmt 0 view .LVU370
 1426 010e 0023     		movs	r3, #0
 1427 0110 A365     		str	r3, [r4, #88]
 411:Service/Srv_Upgrade.c **** 
 1428              		.loc 1 411 20 view .LVU371
 1429 0112 0324     		movs	r4, #3
 1430 0114 AFE7     		b	.L85
 1431              	.L87:
 414:Service/Srv_Upgrade.c ****             return Stage_TimeOut;
 1432              		.loc 1 414 13 is_stmt 1 view .LVU372
 414:Service/Srv_Upgrade.c ****             return Stage_TimeOut;
 1433              		.loc 1 414 34 is_stmt 0 view .LVU373
 1434 0116 044B     		ldr	r3, .L99
 1435 0118 0022     		movs	r2, #0
 1436 011a 5A70     		strb	r2, [r3, #1]
 415:Service/Srv_Upgrade.c **** 
 1437              		.loc 1 415 13 is_stmt 1 view .LVU374
 415:Service/Srv_Upgrade.c **** 
 1438              		.loc 1 415 20 is_stmt 0 view .LVU375
 1439 011c ABE7     		b	.L85
 1440              	.L84:
 420:Service/Srv_Upgrade.c ****     }
 1441              		.loc 1 420 18 is_stmt 1 view .LVU376
 420:Service/Srv_Upgrade.c ****     }
 1442              		.loc 1 420 25 is_stmt 0 view .LVU377
 1443 011e 0B24     		movs	r4, #11
 1444 0120 A9E7     		b	.L85
 1445              	.L97:
 411:Service/Srv_Upgrade.c **** 
 1446              		.loc 1 411 20 view .LVU378
 1447 0122 0324     		movs	r4, #3
 1448 0124 A7E7     		b	.L85
 1449              	.L100:
 1450 0126 00BF     		.align	2
 1451              	.L99:
 1452 0128 00000000 		.word	.LANCHOR0
 1453 012c 00000000 		.word	SrvFileAdapter
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 41


 1454 0130 00000000 		.word	.LC7
 1455 0134 20000000 		.word	.LC8
 1456 0138 3C000000 		.word	.LC9
 1457              		.cfi_endproc
 1458              	.LFE155:
 1460              		.section	.rodata.SrvUpgrade_Show_CurAppVer.str1.4,"aMS",%progbits,1
 1461              		.align	2
 1462              	.LC10:
 1463 0000 5B204375 		.ascii	"[ Current App ] SW Version: %d.%d.%d\015\012\000"
 1463      7272656E 
 1463      74204170 
 1463      70205D20 
 1463      53572056 
 1464              		.section	.text.SrvUpgrade_Show_CurAppVer,"ax",%progbits
 1465              		.align	1
 1466              		.syntax unified
 1467              		.thumb
 1468              		.thumb_func
 1470              	SrvUpgrade_Show_CurAppVer:
 1471              	.LFB162:
 500:Service/Srv_Upgrade.c **** 
 501:Service/Srv_Upgrade.c **** static void SrvUpgrade_Show_CurAppVer(void)
 502:Service/Srv_Upgrade.c **** {
 1472              		.loc 1 502 1 is_stmt 1 view -0
 1473              		.cfi_startproc
 1474              		@ args = 0, pretend = 0, frame = 0
 1475              		@ frame_needed = 0, uses_anonymous_args = 0
 1476 0000 00B5     		push	{lr}
 1477              	.LCFI24:
 1478              		.cfi_def_cfa_offset 4
 1479              		.cfi_offset 14, -4
 1480 0002 83B0     		sub	sp, sp, #12
 1481              	.LCFI25:
 1482              		.cfi_def_cfa_offset 16
 503:Service/Srv_Upgrade.c ****     Shell *shell_obj = Shell_GetInstence();
 1483              		.loc 1 503 5 view .LVU380
 1484              		.loc 1 503 24 is_stmt 0 view .LVU381
 1485 0004 FFF7FEFF 		bl	Shell_GetInstence
 1486              	.LVL99:
 504:Service/Srv_Upgrade.c **** 
 505:Service/Srv_Upgrade.c ****     if (shell_obj)
 1487              		.loc 1 505 5 is_stmt 1 view .LVU382
 1488              		.loc 1 505 8 is_stmt 0 view .LVU383
 1489 0008 30B1     		cbz	r0, .L101
 506:Service/Srv_Upgrade.c ****     {
 507:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ Current App ] SW Version: %d.%d.%d\r\n", AppVer[0], AppVer[1], App
 1490              		.loc 1 507 9 is_stmt 1 view .LVU384
 1491 000a 1123     		movs	r3, #17
 1492 000c 0093     		str	r3, [sp]
 1493 000e 0023     		movs	r3, #0
 1494 0010 1A46     		mov	r2, r3
 1495 0012 0349     		ldr	r1, .L104
 1496 0014 FFF7FEFF 		bl	shellPrint
 1497              	.LVL100:
 1498              	.L101:
 508:Service/Srv_Upgrade.c ****     }
 509:Service/Srv_Upgrade.c **** }
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 42


 1499              		.loc 1 509 1 is_stmt 0 view .LVU385
 1500 0018 03B0     		add	sp, sp, #12
 1501              	.LCFI26:
 1502              		.cfi_def_cfa_offset 4
 1503              		@ sp needed
 1504 001a 5DF804FB 		ldr	pc, [sp], #4
 1505              	.L105:
 1506 001e 00BF     		.align	2
 1507              	.L104:
 1508 0020 00000000 		.word	.LC10
 1509              		.cfi_endproc
 1510              	.LFE162:
 1512              		.section	.rodata.SrvUpgrade_Check_AppFirmware.str1.4,"aMS",%progbits,1
 1513              		.align	2
 1514              	.LC11:
 1515 0000 5B204669 		.ascii	"[ Firmware Info Param ] Read Failed\015\012\000"
 1515      726D7761 
 1515      72652049 
 1515      6E666F20 
 1515      50617261 
 1516 0026 0000     		.align	2
 1517              	.LC12:
 1518 0028 5B204170 		.ascii	"[ App Info ] size: %d\015\012\000"
 1518      7020496E 
 1518      666F205D 
 1518      2073697A 
 1518      653A2025 
 1519              		.align	2
 1520              	.LC13:
 1521 0040 5B204170 		.ascii	"[ App Info ] HW:   %d.%d.%d\015\012\000"
 1521      7020496E 
 1521      666F205D 
 1521      2048573A 
 1521      20202025 
 1522 005e 0000     		.align	2
 1523              	.LC14:
 1524 0060 5B204170 		.ascii	"[ App Info ] SW:   %d.%d.%d\015\012\000"
 1524      7020496E 
 1524      666F205D 
 1524      2053573A 
 1524      20202025 
 1525 007e 0000     		.align	2
 1526              	.LC15:
 1527 0080 20253032 		.ascii	" %02x%02x%02x%02x \000"
 1527      78253032 
 1527      78253032 
 1527      78253032 
 1527      782000
 1528 0093 00       		.align	2
 1529              	.LC16:
 1530 0094 0D0A00   		.ascii	"\015\012\000"
 1531              		.section	.text.SrvUpgrade_Check_AppFirmware,"ax",%progbits
 1532              		.align	1
 1533              		.syntax unified
 1534              		.thumb
 1535              		.thumb_func
 1537              	SrvUpgrade_Check_AppFirmware:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 43


 1538              	.LFB163:
 510:Service/Srv_Upgrade.c **** SHELL_EXPORT_CMD(SHELL_CMD_PERMISSION(0) | SHELL_CMD_TYPE(SHELL_TYPE_CMD_FUNC) | SHELL_CMD_DISABLE_
 511:Service/Srv_Upgrade.c **** 
 512:Service/Srv_Upgrade.c **** static void SrvUpgrade_Check_AppFirmware(void)
 513:Service/Srv_Upgrade.c **** {
 1539              		.loc 1 513 1 is_stmt 1 view -0
 1540              		.cfi_startproc
 1541              		@ args = 0, pretend = 0, frame = 16
 1542              		@ frame_needed = 0, uses_anonymous_args = 0
 1543 0000 2DE9F047 		push	{r4, r5, r6, r7, r8, r9, r10, lr}
 1544              	.LCFI27:
 1545              		.cfi_def_cfa_offset 32
 1546              		.cfi_offset 4, -32
 1547              		.cfi_offset 5, -28
 1548              		.cfi_offset 6, -24
 1549              		.cfi_offset 7, -20
 1550              		.cfi_offset 8, -16
 1551              		.cfi_offset 9, -12
 1552              		.cfi_offset 10, -8
 1553              		.cfi_offset 14, -4
 1554 0004 94B0     		sub	sp, sp, #80
 1555              	.LCFI28:
 1556              		.cfi_def_cfa_offset 112
 514:Service/Srv_Upgrade.c ****     SrvUpgradeInfo_TypeDef Info;
 1557              		.loc 1 514 5 view .LVU387
 515:Service/Srv_Upgrade.c ****     memset(&Info, 0, sizeof(Info));
 1558              		.loc 1 515 5 view .LVU388
 1559 0006 0023     		movs	r3, #0
 1560 0008 1093     		str	r3, [sp, #64]
 1561 000a 1193     		str	r3, [sp, #68]
 1562 000c 1293     		str	r3, [sp, #72]
 1563 000e 8DF84C30 		strb	r3, [sp, #76]
 516:Service/Srv_Upgrade.c ****     Shell *shell_obj = Shell_GetInstence();
 1564              		.loc 1 516 5 view .LVU389
 1565              		.loc 1 516 24 is_stmt 0 view .LVU390
 1566 0012 FFF7FEFF 		bl	Shell_GetInstence
 1567              	.LVL101:
 517:Service/Srv_Upgrade.c ****     uint16_t read_size = 0;
 1568              		.loc 1 517 5 is_stmt 1 view .LVU391
 518:Service/Srv_Upgrade.c ****     uint32_t total_size = 0;
 1569              		.loc 1 518 5 view .LVU392
 519:Service/Srv_Upgrade.c ****     uint32_t read_addr_offset = 0;
 1570              		.loc 1 519 5 view .LVU393
 520:Service/Srv_Upgrade.c ****     uint8_t r = 0;
 1571              		.loc 1 520 5 view .LVU394
 521:Service/Srv_Upgrade.c **** 
 522:Service/Srv_Upgrade.c ****     if (shell_obj == NULL)
 1572              		.loc 1 522 5 view .LVU395
 1573              		.loc 1 522 8 is_stmt 0 view .LVU396
 1574 0016 0028     		cmp	r0, #0
 1575 0018 50D0     		beq	.L106
 1576 001a 0746     		mov	r7, r0
 523:Service/Srv_Upgrade.c ****         return;
 524:Service/Srv_Upgrade.c **** 
 525:Service/Srv_Upgrade.c ****     if (Monitor.UpgradeInfo_SO.item_addr)
 1577              		.loc 1 525 5 is_stmt 1 view .LVU397
 1578              		.loc 1 525 31 is_stmt 0 view .LVU398
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 44


 1579 001c 464B     		ldr	r3, .L123
 1580 001e 1B69     		ldr	r3, [r3, #16]
 1581              		.loc 1 525 8 view .LVU399
 1582 0020 002B     		cmp	r3, #0
 1583 0022 4BD0     		beq	.L106
 526:Service/Srv_Upgrade.c ****     {
 527:Service/Srv_Upgrade.c ****         if (Storage.get(Para_Boot, Monitor.UpgradeInfo_SO.item, (uint8_t *)(&Info), sizeof(SrvUpgra
 1584              		.loc 1 527 9 is_stmt 1 view .LVU400
 1585              		.loc 1 527 20 is_stmt 0 view .LVU401
 1586 0024 454B     		ldr	r3, .L123+4
 1587 0026 D3F81080 		ldr	r8, [r3, #16]
 1588              		.loc 1 527 13 view .LVU402
 1589 002a 434B     		ldr	r3, .L123
 1590 002c 0D22     		movs	r2, #13
 1591 002e 0E92     		str	r2, [sp, #56]
 1592 0030 10AA     		add	r2, sp, #64
 1593 0032 0D92     		str	r2, [sp, #52]
 1594 0034 D3F815A0 		ldr	r10, [r3, #21]	@ unaligned
 1595 0038 D3F81990 		ldr	r9, [r3, #25]	@ unaligned
 1596 003c D3F81DE0 		ldr	lr, [r3, #29]	@ unaligned
 1597 0040 03F12104 		add	r4, r3, #33
 1598 0044 6E46     		mov	r6, sp
 1599 0046 03F1510C 		add	ip, r3, #81
 1600              	.LVL102:
 1601              	.L109:
 1602              		.loc 1 527 13 view .LVU403
 1603 004a 3546     		mov	r5, r6
 1604 004c 2068     		ldr	r0, [r4]	@ unaligned
 1605 004e 6168     		ldr	r1, [r4, #4]	@ unaligned
 1606 0050 A268     		ldr	r2, [r4, #8]	@ unaligned
 1607 0052 E368     		ldr	r3, [r4, #12]	@ unaligned
 1608 0054 0FC5     		stmia	r5!, {r0, r1, r2, r3}
 1609 0056 1034     		adds	r4, r4, #16
 1610 0058 2E46     		mov	r6, r5
 1611 005a 6445     		cmp	r4, ip
 1612 005c F5D1     		bne	.L109
 1613 005e 2068     		ldr	r0, [r4]	@ unaligned
 1614 0060 2860     		str	r0, [r5]
 1615 0062 5146     		mov	r1, r10
 1616 0064 4A46     		mov	r2, r9
 1617 0066 7346     		mov	r3, lr
 1618 0068 0020     		movs	r0, #0
 1619 006a C047     		blx	r8
 1620              	.LVL103:
 1621              		.loc 1 527 12 view .LVU404
 1622 006c 8246     		mov	r10, r0
 1623 006e 08BB     		cbnz	r0, .L120
 528:Service/Srv_Upgrade.c ****         {
 529:Service/Srv_Upgrade.c ****             shellPrint(shell_obj, "[ Firmware Info Param ] Read Failed\r\n");
 530:Service/Srv_Upgrade.c ****             return;
 531:Service/Srv_Upgrade.c ****         }
 532:Service/Srv_Upgrade.c **** 
 533:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ App Info ] size: %d\r\n", Info.AF_Info.File_Size);
 1624              		.loc 1 533 9 is_stmt 1 view .LVU405
 1625 0070 DDF84920 		ldr	r2, [sp, #73]	@ unaligned
 1626 0074 3249     		ldr	r1, .L123+8
 1627 0076 3846     		mov	r0, r7
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 45


 1628 0078 FFF7FEFF 		bl	shellPrint
 1629              	.LVL104:
 534:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ App Info ] HW:   %d.%d.%d\r\n", Info.AF_Info.HW_Ver[0], Info.AF_In
 1630              		.loc 1 534 9 view .LVU406
 1631              		.loc 1 534 133 is_stmt 0 view .LVU407
 1632 007c 9DF84830 		ldrb	r3, [sp, #72]	@ zero_extendqisi2
 1633              		.loc 1 534 9 view .LVU408
 1634 0080 0093     		str	r3, [sp]
 1635 0082 9DF84730 		ldrb	r3, [sp, #71]	@ zero_extendqisi2
 1636 0086 9DF84620 		ldrb	r2, [sp, #70]	@ zero_extendqisi2
 1637 008a 2E49     		ldr	r1, .L123+12
 1638 008c 3846     		mov	r0, r7
 1639 008e FFF7FEFF 		bl	shellPrint
 1640              	.LVL105:
 535:Service/Srv_Upgrade.c ****         shellPrint(shell_obj, "[ App Info ] SW:   %d.%d.%d\r\n", Info.AF_Info.SW_Ver[0], Info.AF_In
 1641              		.loc 1 535 9 is_stmt 1 view .LVU409
 1642              		.loc 1 535 133 is_stmt 0 view .LVU410
 1643 0092 9DF84530 		ldrb	r3, [sp, #69]	@ zero_extendqisi2
 1644              		.loc 1 535 9 view .LVU411
 1645 0096 0093     		str	r3, [sp]
 1646 0098 9DF84430 		ldrb	r3, [sp, #68]	@ zero_extendqisi2
 1647 009c 9DF84320 		ldrb	r2, [sp, #67]	@ zero_extendqisi2
 1648 00a0 2949     		ldr	r1, .L123+16
 1649 00a2 3846     		mov	r0, r7
 1650 00a4 FFF7FEFF 		bl	shellPrint
 1651              	.LVL106:
 536:Service/Srv_Upgrade.c **** 
 537:Service/Srv_Upgrade.c ****         total_size = Info.AF_Info.File_Size;
 1652              		.loc 1 537 9 is_stmt 1 view .LVU412
 1653              		.loc 1 537 20 is_stmt 0 view .LVU413
 1654 00a8 DDF84980 		ldr	r8, [sp, #73]	@ unaligned
 1655              	.LVL107:
 538:Service/Srv_Upgrade.c ****         for (uint32_t i = 0; i < total_size; )
 1656              		.loc 1 538 9 is_stmt 1 view .LVU414
 1657              	.LBB4:
 1658              		.loc 1 538 14 view .LVU415
 1659              		.loc 1 538 14 is_stmt 0 view .LVU416
 1660              	.LBE4:
 520:Service/Srv_Upgrade.c **** 
 1661              		.loc 1 520 13 view .LVU417
 1662 00ac 5546     		mov	r5, r10
 519:Service/Srv_Upgrade.c ****     uint8_t r = 0;
 1663              		.loc 1 519 14 view .LVU418
 1664 00ae 4FF00009 		mov	r9, #0
 1665              	.LBB7:
 1666              		.loc 1 538 9 view .LVU419
 1667 00b2 31E0     		b	.L111
 1668              	.LVL108:
 1669              	.L120:
 1670              		.loc 1 538 9 view .LVU420
 1671              	.LBE7:
 529:Service/Srv_Upgrade.c ****             return;
 1672              		.loc 1 529 13 is_stmt 1 view .LVU421
 1673 00b4 2549     		ldr	r1, .L123+20
 1674 00b6 3846     		mov	r0, r7
 1675 00b8 FFF7FEFF 		bl	shellPrint
 1676              	.LVL109:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 46


 530:Service/Srv_Upgrade.c ****         }
 1677              		.loc 1 530 13 view .LVU422
 1678              	.L106:
 539:Service/Srv_Upgrade.c ****         {
 540:Service/Srv_Upgrade.c ****             read_size = (1 Kb);
 541:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 542:Service/Srv_Upgrade.c ****                 read_size = total_size;
 543:Service/Srv_Upgrade.c **** 
 544:Service/Srv_Upgrade.c ****             /* read boot firmware */
 545:Service/Srv_Upgrade.c ****             Storage.read_firmware(read_addr_offset, upgrade_buf, read_size);
 546:Service/Srv_Upgrade.c **** 
 547:Service/Srv_Upgrade.c ****             for (uint16_t j = 0; j < (read_size / 4); j++)
 548:Service/Srv_Upgrade.c ****             {
 549:Service/Srv_Upgrade.c ****                 shellPrint(shell_obj, " %02x%02x%02x%02x ", upgrade_buf[j * 4], upgrade_buf[j * 4 +
 550:Service/Srv_Upgrade.c ****                 r ++;
 551:Service/Srv_Upgrade.c ****                 if (r == 3)
 552:Service/Srv_Upgrade.c ****                 {
 553:Service/Srv_Upgrade.c ****                     r = 0;
 554:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 555:Service/Srv_Upgrade.c ****                 }
 556:Service/Srv_Upgrade.c ****             }
 557:Service/Srv_Upgrade.c ****             memset(upgrade_buf, 0, read_size);
 558:Service/Srv_Upgrade.c ****             total_size -= read_size;
 559:Service/Srv_Upgrade.c ****             if (total_size == 0)
 560:Service/Srv_Upgrade.c ****                 break;
 561:Service/Srv_Upgrade.c ****             
 562:Service/Srv_Upgrade.c ****             read_addr_offset += read_size;
 563:Service/Srv_Upgrade.c ****         }
 564:Service/Srv_Upgrade.c ****     }
 565:Service/Srv_Upgrade.c **** }
 1679              		.loc 1 565 1 is_stmt 0 view .LVU423
 1680 00bc 14B0     		add	sp, sp, #80
 1681              	.LCFI29:
 1682              		.cfi_remember_state
 1683              		.cfi_def_cfa_offset 32
 1684              		@ sp needed
 1685 00be BDE8F087 		pop	{r4, r5, r6, r7, r8, r9, r10, pc}
 1686              	.LVL110:
 1687              	.L118:
 1688              	.LCFI30:
 1689              		.cfi_restore_state
 1690              	.LBB8:
 540:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 1691              		.loc 1 540 23 view .LVU424
 1692 00c2 4FF48066 		mov	r6, #1024
 1693 00c6 2FE0     		b	.L112
 1694              	.LVL111:
 1695              	.L122:
 1696              	.LBB5:
 553:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 1697              		.loc 1 553 21 is_stmt 1 view .LVU425
 554:Service/Srv_Upgrade.c ****                 }
 1698              		.loc 1 554 21 view .LVU426
 1699 00c8 2149     		ldr	r1, .L123+24
 1700 00ca 3846     		mov	r0, r7
 1701 00cc FFF7FEFF 		bl	shellPrint
 1702              	.LVL112:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 47


 553:Service/Srv_Upgrade.c ****                     shellPrint(shell_obj, "\r\n");
 1703              		.loc 1 553 23 is_stmt 0 view .LVU427
 1704 00d0 5546     		mov	r5, r10
 1705              	.LVL113:
 1706              	.L114:
 547:Service/Srv_Upgrade.c ****             {
 1707              		.loc 1 547 55 is_stmt 1 discriminator 2 view .LVU428
 547:Service/Srv_Upgrade.c ****             {
 1708              		.loc 1 547 56 is_stmt 0 discriminator 2 view .LVU429
 1709 00d2 0134     		adds	r4, r4, #1
 1710              	.LVL114:
 547:Service/Srv_Upgrade.c ****             {
 1711              		.loc 1 547 56 discriminator 2 view .LVU430
 1712 00d4 A4B2     		uxth	r4, r4
 1713              	.LVL115:
 1714              	.L113:
 547:Service/Srv_Upgrade.c ****             {
 1715              		.loc 1 547 34 is_stmt 1 discriminator 1 view .LVU431
 547:Service/Srv_Upgrade.c ****             {
 1716              		.loc 1 547 13 is_stmt 0 discriminator 1 view .LVU432
 1717 00d6 B4EB960F 		cmp	r4, r6, lsr #2
 1718 00da 14D2     		bcs	.L121
 549:Service/Srv_Upgrade.c ****                 r ++;
 1719              		.loc 1 549 17 is_stmt 1 view .LVU433
 549:Service/Srv_Upgrade.c ****                 r ++;
 1720              		.loc 1 549 75 is_stmt 0 view .LVU434
 1721 00dc A300     		lsls	r3, r4, #2
 549:Service/Srv_Upgrade.c ****                 r ++;
 1722              		.loc 1 549 72 view .LVU435
 1723 00de 1D4A     		ldr	r2, .L123+28
 549:Service/Srv_Upgrade.c ****                 r ++;
 1724              		.loc 1 549 99 view .LVU436
 1725 00e0 591C     		adds	r1, r3, #1
 549:Service/Srv_Upgrade.c ****                 r ++;
 1726              		.loc 1 549 123 view .LVU437
 1727 00e2 981C     		adds	r0, r3, #2
 549:Service/Srv_Upgrade.c ****                 r ++;
 1728              		.loc 1 549 116 view .LVU438
 1729 00e4 105C     		ldrb	r0, [r2, r0]	@ zero_extendqisi2
 549:Service/Srv_Upgrade.c ****                 r ++;
 1730              		.loc 1 549 147 view .LVU439
 1731 00e6 0333     		adds	r3, r3, #3
 549:Service/Srv_Upgrade.c ****                 r ++;
 1732              		.loc 1 549 140 view .LVU440
 1733 00e8 D35C     		ldrb	r3, [r2, r3]	@ zero_extendqisi2
 549:Service/Srv_Upgrade.c ****                 r ++;
 1734              		.loc 1 549 17 view .LVU441
 1735 00ea 0193     		str	r3, [sp, #4]
 1736 00ec 0090     		str	r0, [sp]
 1737 00ee 535C     		ldrb	r3, [r2, r1]	@ zero_extendqisi2
 1738 00f0 12F82420 		ldrb	r2, [r2, r4, lsl #2]	@ zero_extendqisi2
 1739 00f4 1849     		ldr	r1, .L123+32
 1740 00f6 3846     		mov	r0, r7
 1741 00f8 FFF7FEFF 		bl	shellPrint
 1742              	.LVL116:
 550:Service/Srv_Upgrade.c ****                 if (r == 3)
 1743              		.loc 1 550 17 is_stmt 1 view .LVU442
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 48


 550:Service/Srv_Upgrade.c ****                 if (r == 3)
 1744              		.loc 1 550 19 is_stmt 0 view .LVU443
 1745 00fc 0135     		adds	r5, r5, #1
 1746              	.LVL117:
 550:Service/Srv_Upgrade.c ****                 if (r == 3)
 1747              		.loc 1 550 19 view .LVU444
 1748 00fe EDB2     		uxtb	r5, r5
 1749              	.LVL118:
 551:Service/Srv_Upgrade.c ****                 {
 1750              		.loc 1 551 17 is_stmt 1 view .LVU445
 551:Service/Srv_Upgrade.c ****                 {
 1751              		.loc 1 551 20 is_stmt 0 view .LVU446
 1752 0100 032D     		cmp	r5, #3
 1753 0102 E6D1     		bne	.L114
 1754 0104 E0E7     		b	.L122
 1755              	.L121:
 551:Service/Srv_Upgrade.c ****                 {
 1756              		.loc 1 551 20 view .LVU447
 1757              	.LBE5:
 557:Service/Srv_Upgrade.c ****             total_size -= read_size;
 1758              		.loc 1 557 13 is_stmt 1 view .LVU448
 1759 0106 3246     		mov	r2, r6
 1760 0108 0021     		movs	r1, #0
 1761 010a 1248     		ldr	r0, .L123+28
 1762 010c FFF7FEFF 		bl	memset
 1763              	.LVL119:
 558:Service/Srv_Upgrade.c ****             if (total_size == 0)
 1764              		.loc 1 558 13 view .LVU449
 559:Service/Srv_Upgrade.c ****                 break;
 1765              		.loc 1 559 13 view .LVU450
 559:Service/Srv_Upgrade.c ****                 break;
 1766              		.loc 1 559 16 is_stmt 0 view .LVU451
 1767 0110 B8EB0608 		subs	r8, r8, r6
 1768              	.LVL120:
 559:Service/Srv_Upgrade.c ****                 break;
 1769              		.loc 1 559 16 view .LVU452
 1770 0114 D2D0     		beq	.L106
 562:Service/Srv_Upgrade.c ****         }
 1771              		.loc 1 562 13 is_stmt 1 view .LVU453
 562:Service/Srv_Upgrade.c ****         }
 1772              		.loc 1 562 30 is_stmt 0 view .LVU454
 1773 0116 B144     		add	r9, r9, r6
 1774              	.LVL121:
 1775              	.L111:
 538:Service/Srv_Upgrade.c ****         {
 1776              		.loc 1 538 30 is_stmt 1 discriminator 1 view .LVU455
 538:Service/Srv_Upgrade.c ****         {
 1777              		.loc 1 538 9 is_stmt 0 discriminator 1 view .LVU456
 1778 0118 B8F1000F 		cmp	r8, #0
 1779 011c CED0     		beq	.L106
 540:Service/Srv_Upgrade.c ****             if (total_size < (1 Kb))
 1780              		.loc 1 540 13 is_stmt 1 view .LVU457
 1781              	.LVL122:
 541:Service/Srv_Upgrade.c ****                 read_size = total_size;
 1782              		.loc 1 541 13 view .LVU458
 541:Service/Srv_Upgrade.c ****                 read_size = total_size;
 1783              		.loc 1 541 16 is_stmt 0 view .LVU459
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 49


 1784 011e B8F5806F 		cmp	r8, #1024
 1785 0122 CED2     		bcs	.L118
 542:Service/Srv_Upgrade.c **** 
 1786              		.loc 1 542 17 is_stmt 1 view .LVU460
 542:Service/Srv_Upgrade.c **** 
 1787              		.loc 1 542 27 is_stmt 0 view .LVU461
 1788 0124 1FFA88F6 		uxth	r6, r8
 1789              	.LVL123:
 1790              	.L112:
 545:Service/Srv_Upgrade.c **** 
 1791              		.loc 1 545 13 is_stmt 1 view .LVU462
 545:Service/Srv_Upgrade.c **** 
 1792              		.loc 1 545 20 is_stmt 0 view .LVU463
 1793 0128 044B     		ldr	r3, .L123+4
 1794 012a 9B6A     		ldr	r3, [r3, #40]
 545:Service/Srv_Upgrade.c **** 
 1795              		.loc 1 545 13 view .LVU464
 1796 012c 3246     		mov	r2, r6
 1797 012e 0949     		ldr	r1, .L123+28
 1798 0130 4846     		mov	r0, r9
 1799 0132 9847     		blx	r3
 1800              	.LVL124:
 547:Service/Srv_Upgrade.c ****             {
 1801              		.loc 1 547 13 is_stmt 1 view .LVU465
 1802              	.LBB6:
 547:Service/Srv_Upgrade.c ****             {
 1803              		.loc 1 547 18 view .LVU466
 547:Service/Srv_Upgrade.c ****             {
 1804              		.loc 1 547 27 is_stmt 0 view .LVU467
 1805 0134 0024     		movs	r4, #0
 547:Service/Srv_Upgrade.c ****             {
 1806              		.loc 1 547 13 view .LVU468
 1807 0136 CEE7     		b	.L113
 1808              	.L124:
 1809              		.align	2
 1810              	.L123:
 1811 0138 00000000 		.word	.LANCHOR0
 1812 013c 00000000 		.word	Storage
 1813 0140 28000000 		.word	.LC12
 1814 0144 40000000 		.word	.LC13
 1815 0148 60000000 		.word	.LC14
 1816 014c 00000000 		.word	.LC11
 1817 0150 94000000 		.word	.LC16
 1818 0154 00000000 		.word	upgrade_buf
 1819 0158 80000000 		.word	.LC15
 1820              	.LBE6:
 1821              	.LBE8:
 1822              		.cfi_endproc
 1823              	.LFE163:
 1825              		.section	.text.Write_OnChipFlash,"ax",%progbits
 1826              		.align	1
 1827              		.weak	Write_OnChipFlash
 1828              		.syntax unified
 1829              		.thumb
 1830              		.thumb_func
 1832              	Write_OnChipFlash:
 1833              	.LVL125:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 50


 1834              	.LFB148:
  46:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 1835              		.loc 1 46 92 is_stmt 1 view -0
 1836              		.cfi_startproc
 1837              		@ args = 0, pretend = 0, frame = 0
 1838              		@ frame_needed = 0, uses_anonymous_args = 0
 1839              		@ link register save eliminated.
  46:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 1840              		.loc 1 46 93 view .LVU470
  46:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 1841              		.loc 1 46 106 is_stmt 0 view .LVU471
 1842 0000 0020     		movs	r0, #0
 1843              	.LVL126:
  46:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Read_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return f
 1844              		.loc 1 46 106 view .LVU472
 1845 0002 7047     		bx	lr
 1846              		.cfi_endproc
 1847              	.LFE148:
 1849              		.section	.text.Read_OnChipFlash,"ax",%progbits
 1850              		.align	1
 1851              		.weak	Read_OnChipFlash
 1852              		.syntax unified
 1853              		.thumb
 1854              		.thumb_func
 1856              	Read_OnChipFlash:
 1857              	.LVL127:
 1858              	.LFB149:
  47:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 1859              		.loc 1 47 91 is_stmt 1 view -0
 1860              		.cfi_startproc
 1861              		@ args = 0, pretend = 0, frame = 0
 1862              		@ frame_needed = 0, uses_anonymous_args = 0
 1863              		@ link register save eliminated.
  47:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 1864              		.loc 1 47 92 view .LVU474
  47:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 1865              		.loc 1 47 105 is_stmt 0 view .LVU475
 1866 0000 0020     		movs	r0, #0
 1867              	.LVL128:
  47:Service/Srv_Upgrade.c **** __attribute__((weak)) bool Erase_OnChipFlash(uint32_t addr, uint8_t *p_data, uint16_t size){return 
 1868              		.loc 1 47 105 view .LVU476
 1869 0002 7047     		bx	lr
 1870              		.cfi_endproc
 1871              	.LFE149:
 1873              		.section	.text.Erase_OnChipFlash,"ax",%progbits
 1874              		.align	1
 1875              		.weak	Erase_OnChipFlash
 1876              		.syntax unified
 1877              		.thumb
 1878              		.thumb_func
 1880              	Erase_OnChipFlash:
 1881              	.LVL129:
 1882              	.LFB150:
  48:Service/Srv_Upgrade.c **** 
 1883              		.loc 1 48 92 is_stmt 1 view -0
 1884              		.cfi_startproc
 1885              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 51


 1886              		@ frame_needed = 0, uses_anonymous_args = 0
 1887              		@ link register save eliminated.
  48:Service/Srv_Upgrade.c **** 
 1888              		.loc 1 48 93 view .LVU478
  48:Service/Srv_Upgrade.c **** 
 1889              		.loc 1 48 106 is_stmt 0 view .LVU479
 1890 0000 0020     		movs	r0, #0
 1891              	.LVL130:
  48:Service/Srv_Upgrade.c **** 
 1892              		.loc 1 48 106 view .LVU480
 1893 0002 7047     		bx	lr
 1894              		.cfi_endproc
 1895              	.LFE150:
 1897              		.global	shellCommandcheck_app
 1898              		.global	shellDesccheck_app
 1899              		.global	shellCmdcheck_app
 1900              		.global	shellCommandapp_ver
 1901              		.global	shellDescapp_ver
 1902              		.global	shellCmdapp_ver
 1903              		.global	SrvUpgrade
 1904              		.global	HWVer
 1905              		.global	AppVer
 1906              		.section	.rodata
 1907              		.align	2
 1908              		.set	.LANCHOR1,. + 0
 1909              	.LC1:
 1910 0000 000003   		.ascii	"\000\000\003"
 1911              		.section	.bss.Monitor,"aw",%nobits
 1912              		.align	2
 1913              		.set	.LANCHOR0,. + 0
 1916              	Monitor:
 1917 0000 00000000 		.space	1160
 1917      00000000 
 1917      00000000 
 1917      00000000 
 1917      00000000 
 1918              		.section	.bss.upgrade_buf,"aw",%nobits
 1919              		.align	2
 1922              	upgrade_buf:
 1923 0000 00000000 		.space	4096
 1923      00000000 
 1923      00000000 
 1923      00000000 
 1923      00000000 
 1924              		.section	.data.SrvUpgrade,"aw"
 1925              		.align	2
 1928              	SrvUpgrade:
 1929 0000 00000000 		.word	SrvUpgrade_Init
 1930 0004 00000000 		.word	SrvUpgrade_StatePolling
 1931 0008 00000000 		.word	SrvUpgrade_SetFileInfo
 1932 000c 00000000 		.word	SrvUpgrade_Get_Info
 1933 0010 00000000 		.word	SrvUpgrade_ClearLog
 1934 0014 00000000 		.word	SrvUpgrade_PushData
 1935              		.section	.rodata.AppVer,"a"
 1936              		.align	2
 1939              	AppVer:
 1940 0000 000011   		.ascii	"\000\000\021"
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 52


 1941              		.section	.rodata.HWVer,"a"
 1942              		.align	2
 1943              		.set	.LANCHOR2,. + 0
 1946              	HWVer:
 1947 0000 000003   		.ascii	"\000\000\003"
 1948              		.section	.rodata.shellCmdapp_ver,"a"
 1949              		.align	2
 1952              	shellCmdapp_ver:
 1953 0000 6170705F 		.ascii	"app_ver\000"
 1953      76657200 
 1954              		.section	.rodata.shellCmdcheck_app,"a"
 1955              		.align	2
 1958              	shellCmdcheck_app:
 1959 0000 63686563 		.ascii	"check_app\000"
 1959      6B5F6170 
 1959      7000
 1960              		.section	.rodata.shellDescapp_ver,"a"
 1961              		.align	2
 1964              	shellDescapp_ver:
 1965 0000 63686563 		.ascii	"check app version\000"
 1965      6B206170 
 1965      70207665 
 1965      7273696F 
 1965      6E00
 1966              		.section	.rodata.shellDesccheck_app,"a"
 1967              		.align	2
 1970              	shellDesccheck_app:
 1971 0000 63686563 		.ascii	"check stored app\000"
 1971      6B207374 
 1971      6F726564 
 1971      20617070 
 1971      00
 1972              		.section	shellCommand,"a"
 1973              		.align	2
 1976              	shellCommandcheck_app:
 1977 0000 00210000 		.word	8448
 1978 0004 00000000 		.word	shellCmdcheck_app
 1979 0008 00000000 		.word	SrvUpgrade_Check_AppFirmware
 1980 000c 00000000 		.word	shellDesccheck_app
 1983              	shellCommandapp_ver:
 1984 0010 00210000 		.word	8448
 1985 0014 00000000 		.word	shellCmdapp_ver
 1986 0018 00000000 		.word	SrvUpgrade_Show_CurAppVer
 1987 001c 00000000 		.word	shellDescapp_ver
 1988              		.text
 1989              	.Letext0:
 1990              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1991              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1992              		.file 4 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\lib\\gcc\\arm-none-eabi\
 1993              		.file 5 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\lib\\gcc\\arm-none-eabi\
 1994              		.file 6 "Service/Srv_FileAdapter.h"
 1995              		.file 7 "Service/Srv_Upgrade.h"
 1996              		.file 8 "common/Error_Log/../../common/gen_physic_def/imu_data.h"
 1997              		.file 9 "System/FreeRTOS/include/portable.h"
 1998              		.file 10 "Service/Srv_OsCommon.h"
 1999              		.file 11 "Service/control_data.h"
 2000              		.file 12 "Service/../System/storage/Storage_Bus_Port.h"
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 53


 2001              		.file 13 "Service/../System/storage/Storage.h"
 2002              		.file 14 "System/shell/shell.h"
 2003              		.file 15 "System/FreeRTOS/FreeRTOSConfig.h"
 2004              		.file 16 "System/shell/shell_port.h"
 2005              		.file 17 "<built-in>"
 2006              		.file 18 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\
 2007              		.file 19 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 54


DEFINED SYMBOLS
                            *ABS*:00000000 Srv_Upgrade.c
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:20     .text.SrvUpgrade_SetFileInfo:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:25     .text.SrvUpgrade_SetFileInfo:00000000 SrvUpgrade_SetFileInfo
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:56     .text.SrvUpgrade_SetFileInfo:00000020 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:61     .text.SrvUpgrade_PushData:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:66     .text.SrvUpgrade_PushData:00000000 SrvUpgrade_PushData
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:188    .text.SrvUpgrade_PushData:00000080 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:193    .text.SrvUpgrade_Get_Info:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:198    .text.SrvUpgrade_Get_Info:00000000 SrvUpgrade_Get_Info
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:280    .text.SrvUpgrade_Get_Info:00000038 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:285    .text.SrvUpgrade_ClearLog:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:290    .text.SrvUpgrade_ClearLog:00000000 SrvUpgrade_ClearLog
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:317    .text.SrvUpgrade_ClearLog:0000001c $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:322    .text.SrvUpgrade_PortProcPolling:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:327    .text.SrvUpgrade_PortProcPolling:00000000 SrvUpgrade_PortProcPolling
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:538    .text.SrvUpgrade_PortProcPolling:000000e4 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:544    .rodata.SrvUpgrade_CheckUpgrade_OnBootUp.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:548    .text.SrvUpgrade_CheckUpgrade_OnBootUp:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:553    .text.SrvUpgrade_CheckUpgrade_OnBootUp:00000000 SrvUpgrade_CheckUpgrade_OnBootUp
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:710    .text.SrvUpgrade_CheckUpgrade_OnBootUp:000000d8 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:719    .text.SrvUpgrade_Init:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:724    .text.SrvUpgrade_Init:00000000 SrvUpgrade_Init
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:804    .text.SrvUpgrade_Init:00000058 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1922   .bss.upgrade_buf:00000000 upgrade_buf
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:810    .text.SrvUpgrade_Collect_Info:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:815    .text.SrvUpgrade_Collect_Info:00000000 SrvUpgrade_Collect_Info
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:919    .text.SrvUpgrade_Collect_Info:00000050 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:924    .rodata.SrvUpgrade_On_PortProc_Finish.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:940    .text.SrvUpgrade_On_PortProc_Finish:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:945    .text.SrvUpgrade_On_PortProc_Finish:00000000 SrvUpgrade_On_PortProc_Finish
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1127   .text.SrvUpgrade_On_PortProc_Finish:00000118 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1140   .rodata.SrvUpgrade_StatePolling.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1150   .text.SrvUpgrade_StatePolling:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1155   .text.SrvUpgrade_StatePolling:00000000 SrvUpgrade_StatePolling
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1257   .text.SrvUpgrade_StatePolling:0000005e $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1267   .text.SrvUpgrade_StatePolling:00000068 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1452   .text.SrvUpgrade_StatePolling:00000128 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1461   .rodata.SrvUpgrade_Show_CurAppVer.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1465   .text.SrvUpgrade_Show_CurAppVer:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1470   .text.SrvUpgrade_Show_CurAppVer:00000000 SrvUpgrade_Show_CurAppVer
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1508   .text.SrvUpgrade_Show_CurAppVer:00000020 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1513   .rodata.SrvUpgrade_Check_AppFirmware.str1.4:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1532   .text.SrvUpgrade_Check_AppFirmware:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1537   .text.SrvUpgrade_Check_AppFirmware:00000000 SrvUpgrade_Check_AppFirmware
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1811   .text.SrvUpgrade_Check_AppFirmware:00000138 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1826   .text.Write_OnChipFlash:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1832   .text.Write_OnChipFlash:00000000 Write_OnChipFlash
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1850   .text.Read_OnChipFlash:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1856   .text.Read_OnChipFlash:00000000 Read_OnChipFlash
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1874   .text.Erase_OnChipFlash:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1880   .text.Erase_OnChipFlash:00000000 Erase_OnChipFlash
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1976   shellCommand:00000000 shellCommandcheck_app
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1970   .rodata.shellDesccheck_app:00000000 shellDesccheck_app
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1958   .rodata.shellCmdcheck_app:00000000 shellCmdcheck_app
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1983   shellCommand:00000010 shellCommandapp_ver
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1964   .rodata.shellDescapp_ver:00000000 shellDescapp_ver
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s 			page 55


C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1952   .rodata.shellCmdapp_ver:00000000 shellCmdapp_ver
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1928   .data.SrvUpgrade:00000000 SrvUpgrade
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1946   .rodata.HWVer:00000000 HWVer
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1939   .rodata.AppVer:00000000 AppVer
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1907   .rodata:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1912   .bss.Monitor:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1916   .bss.Monitor:00000000 Monitor
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1919   .bss.upgrade_buf:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1925   .data.SrvUpgrade:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1936   .rodata.AppVer:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1942   .rodata.HWVer:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1949   .rodata.shellCmdapp_ver:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1955   .rodata.shellCmdcheck_app:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1961   .rodata.shellDescapp_ver:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1967   .rodata.shellDesccheck_app:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccHYdMzi.s:1973   shellCommand:00000000 $d

UNDEFINED SYMBOLS
memcpy
memset
SrvFileAdapter
Storage
vsnprintf
memcmp
Shell_GetInstence
shellPrint
