ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"Storage_Bus_Port.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.Storage_External_Chip_SelectPin_Ctl,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	Storage_External_Chip_SelectPin_Ctl:
  26              	.LVL0:
  27              	.LFB135:
  28              		.file 1 "System/storage/Storage_Bus_Port.c"
   1:System/storage/Storage_Bus_Port.c **** #include "Storage_Bus_Port.h"
   2:System/storage/Storage_Bus_Port.c **** #include "HW_Def.h"
   3:System/storage/Storage_Bus_Port.c **** 
   4:System/storage/Storage_Bus_Port.c **** #if defined STM32H743xx
   5:System/storage/Storage_Bus_Port.c **** static SPI_HandleTypeDef ExtFlash_Bus_InstObj;
   6:System/storage/Storage_Bus_Port.c **** #elif defined AT32F435_437
   7:System/storage/Storage_Bus_Port.c **** void *ExtFlash_Bus_InstObj = NULL;
   8:System/storage/Storage_Bus_Port.c **** #endif
   9:System/storage/Storage_Bus_Port.c **** 
  10:System/storage/Storage_Bus_Port.c **** /* external function */
  11:System/storage/Storage_Bus_Port.c **** static void *Storage_External_Chip_Bus_Init(StorageBus_Malloc_Callback p_malloc, StorageBus_Free_Ca
  12:System/storage/Storage_Bus_Port.c **** static bool Storage_External_Chip_SelectPin_Ctl(bool state);
  13:System/storage/Storage_Bus_Port.c **** static uint16_t Storage_External_Chip_BusTx(uint8_t *p_data, uint16_t len, uint32_t time_out);
  14:System/storage/Storage_Bus_Port.c **** static uint16_t Storage_External_Chip_BusRx(uint8_t *p_data, uint16_t len, uint32_t time_out);
  15:System/storage/Storage_Bus_Port.c **** static uint16_t Storage_External_Chip_BusTrans(uint8_t *tx, uint8_t *rx, uint16_t len, uint32_t tim
  16:System/storage/Storage_Bus_Port.c **** 
  17:System/storage/Storage_Bus_Port.c **** StorageBusApi_TypeDef StoragePort_Api = {
  18:System/storage/Storage_Bus_Port.c ****     .init = Storage_External_Chip_Bus_Init,
  19:System/storage/Storage_Bus_Port.c ****     .cs_ctl = Storage_External_Chip_SelectPin_Ctl,
  20:System/storage/Storage_Bus_Port.c ****     .bus_tx = Storage_External_Chip_BusTx,
  21:System/storage/Storage_Bus_Port.c ****     .bus_rx = Storage_External_Chip_BusRx,
  22:System/storage/Storage_Bus_Port.c ****     .bus_trans = Storage_External_Chip_BusTrans,
  23:System/storage/Storage_Bus_Port.c **** };
  24:System/storage/Storage_Bus_Port.c **** 
  25:System/storage/Storage_Bus_Port.c **** /************************************************** External Flash IO API Section *****************
  26:System/storage/Storage_Bus_Port.c **** static void* Storage_External_Chip_Bus_Init(StorageBus_Malloc_Callback p_malloc, StorageBus_Free_Ca
  27:System/storage/Storage_Bus_Port.c **** {
  28:System/storage/Storage_Bus_Port.c ****     void *obj = NULL;
  29:System/storage/Storage_Bus_Port.c **** 
  30:System/storage/Storage_Bus_Port.c ****     if ((p_malloc == NULL) || \
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 2


  31:System/storage/Storage_Bus_Port.c ****         (p_free == NULL))
  32:System/storage/Storage_Bus_Port.c ****         return NULL;
  33:System/storage/Storage_Bus_Port.c **** 
  34:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
  35:System/storage/Storage_Bus_Port.c ****         /* malloc bus object */
  36:System/storage/Storage_Bus_Port.c ****         obj = p_malloc(sizeof(BspSPI_NorModeConfig_TypeDef));
  37:System/storage/Storage_Bus_Port.c ****         if (obj == NULL)
  38:System/storage/Storage_Bus_Port.c ****             return NULL;
  39:System/storage/Storage_Bus_Port.c **** 
  40:System/storage/Storage_Bus_Port.c ****         memset(obj, 0, sizeof(BspSPI_NorModeConfig_TypeDef));
  41:System/storage/Storage_Bus_Port.c **** 
  42:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->BaudRatePrescaler = ExtFlash_Bus_Clock_Div;
  43:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->CLKPhase = ExtFlash_Bus_CLKPhase;
  44:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->CLKPolarity = ExtFlash_Bus_CLKPolarity;
  45:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->Instance = ExtFLash_Bus_Instance;
  46:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->Pin = ExtFlash_Bus_Pin;
  47:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->work_mode = BspSPI_Mode_Master;
  48:System/storage/Storage_Bus_Port.c **** 
  49:System/storage/Storage_Bus_Port.c ****         if (!ExtFlash_Bus_Api.init(To_NormalSPI_Obj(obj), &ExtFlash_Bus_InstObj) || \
  50:System/storage/Storage_Bus_Port.c ****             !BspGPIO.out_init(ExtFlash_CS_Pin))
  51:System/storage/Storage_Bus_Port.c ****             return NULL;
  52:System/storage/Storage_Bus_Port.c **** 
  53:System/storage/Storage_Bus_Port.c ****         return obj;
  54:System/storage/Storage_Bus_Port.c **** #elif (ExtFlash_Bus_Type == Storage_ChipBus_QSpi)
  55:System/storage/Storage_Bus_Port.c ****     /* still in developping */
  56:System/storage/Storage_Bus_Port.c ****     return NULL;
  57:System/storage/Storage_Bus_Port.c **** #else
  58:System/storage/Storage_Bus_Port.c ****     return NULL;
  59:System/storage/Storage_Bus_Port.c **** #endif
  60:System/storage/Storage_Bus_Port.c ****     return NULL;
  61:System/storage/Storage_Bus_Port.c **** }
  62:System/storage/Storage_Bus_Port.c **** 
  63:System/storage/Storage_Bus_Port.c **** static bool Storage_External_Chip_SelectPin_Ctl(bool state)
  64:System/storage/Storage_Bus_Port.c **** {
  29              		.loc 1 64 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		.loc 1 64 1 is_stmt 0 view .LVU1
  34 0000 10B5     		push	{r4, lr}
  35              	.LCFI0:
  36              		.cfi_def_cfa_offset 8
  37              		.cfi_offset 4, -8
  38              		.cfi_offset 14, -4
  39 0002 0346     		mov	r3, r0
  65:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
  66:System/storage/Storage_Bus_Port.c ****     BspGPIO.write(ExtFlash_CS_Pin, state);
  40              		.loc 1 66 5 is_stmt 1 view .LVU2
  41              		.loc 1 66 12 is_stmt 0 view .LVU3
  42 0004 034A     		ldr	r2, .L3
  43 0006 D469     		ldr	r4, [r2, #28]
  44              		.loc 1 66 5 view .LVU4
  45 0008 034A     		ldr	r2, .L3+4
  46 000a 07CA     		ldm	r2, {r0, r1, r2}
  47              	.LVL1:
  48              		.loc 1 66 5 view .LVU5
  49 000c A047     		blx	r4
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 3


  50              	.LVL2:
  67:System/storage/Storage_Bus_Port.c **** #endif
  68:System/storage/Storage_Bus_Port.c ****     return true;
  51              		.loc 1 68 5 is_stmt 1 view .LVU6
  69:System/storage/Storage_Bus_Port.c **** }
  52              		.loc 1 69 1 is_stmt 0 view .LVU7
  53 000e 0120     		movs	r0, #1
  54 0010 10BD     		pop	{r4, pc}
  55              	.L4:
  56 0012 00BF     		.align	2
  57              	.L3:
  58 0014 00000000 		.word	BspGPIO
  59 0018 00000000 		.word	ExtFlash_CSPin
  60              		.cfi_endproc
  61              	.LFE135:
  63              		.section	.text.Storage_External_Chip_BusTx,"ax",%progbits
  64              		.align	1
  65              		.syntax unified
  66              		.thumb
  67              		.thumb_func
  69              	Storage_External_Chip_BusTx:
  70              	.LVL3:
  71              	.LFB136:
  70:System/storage/Storage_Bus_Port.c **** 
  71:System/storage/Storage_Bus_Port.c **** static uint16_t Storage_External_Chip_BusTx(uint8_t *p_data, uint16_t len, uint32_t time_out)
  72:System/storage/Storage_Bus_Port.c **** {
  72              		.loc 1 72 1 is_stmt 1 view -0
  73              		.cfi_startproc
  74              		@ args = 0, pretend = 0, frame = 0
  75              		@ frame_needed = 0, uses_anonymous_args = 0
  73:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
  74:System/storage/Storage_Bus_Port.c ****     if (p_data && len)
  76              		.loc 1 74 5 view .LVU9
  77              		.loc 1 74 8 is_stmt 0 view .LVU10
  78 0000 60B1     		cbz	r0, .L7
  72:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
  79              		.loc 1 72 1 discriminator 1 view .LVU11
  80 0002 38B5     		push	{r3, r4, r5, lr}
  81              	.LCFI1:
  82              		.cfi_def_cfa_offset 16
  83              		.cfi_offset 3, -16
  84              		.cfi_offset 4, -12
  85              		.cfi_offset 5, -8
  86              		.cfi_offset 14, -4
  87 0004 0C46     		mov	r4, r1
  88 0006 0146     		mov	r1, r0
  89              	.LVL4:
  90              		.loc 1 74 16 discriminator 1 view .LVU12
  91 0008 54B1     		cbz	r4, .L8
  75:System/storage/Storage_Bus_Port.c ****     {
  76:System/storage/Storage_Bus_Port.c ****         if (ExtFlash_Bus_Api.trans(&ExtFlash_Bus_InstObj, p_data, len, time_out))
  92              		.loc 1 76 9 is_stmt 1 view .LVU13
  93              		.loc 1 76 29 is_stmt 0 view .LVU14
  94 000a 064B     		ldr	r3, .L14
  95 000c 9D68     		ldr	r5, [r3, #8]
  96              		.loc 1 76 13 view .LVU15
  97 000e 93B2     		uxth	r3, r2
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 4


  98 0010 2246     		mov	r2, r4
  99              	.LVL5:
 100              		.loc 1 76 13 view .LVU16
 101 0012 0548     		ldr	r0, .L14+4
 102              	.LVL6:
 103              		.loc 1 76 13 view .LVU17
 104 0014 A847     		blx	r5
 105              	.LVL7:
 106              		.loc 1 76 12 view .LVU18
 107 0016 20B1     		cbz	r0, .L6
  77:System/storage/Storage_Bus_Port.c ****             return len;
 108              		.loc 1 77 20 view .LVU19
 109 0018 2046     		mov	r0, r4
 110 001a 02E0     		b	.L6
 111              	.LVL8:
 112              	.L7:
 113              	.LCFI2:
 114              		.cfi_def_cfa_offset 0
 115              		.cfi_restore 3
 116              		.cfi_restore 4
 117              		.cfi_restore 5
 118              		.cfi_restore 14
  78:System/storage/Storage_Bus_Port.c ****     }
  79:System/storage/Storage_Bus_Port.c **** #endif
  80:System/storage/Storage_Bus_Port.c **** 
  81:System/storage/Storage_Bus_Port.c ****     return 0;
 119              		.loc 1 81 12 view .LVU20
 120 001c 0020     		movs	r0, #0
 121              	.LVL9:
  82:System/storage/Storage_Bus_Port.c **** }
 122              		.loc 1 82 1 view .LVU21
 123 001e 7047     		bx	lr
 124              	.LVL10:
 125              	.L8:
 126              	.LCFI3:
 127              		.cfi_def_cfa_offset 16
 128              		.cfi_offset 3, -16
 129              		.cfi_offset 4, -12
 130              		.cfi_offset 5, -8
 131              		.cfi_offset 14, -4
  81:System/storage/Storage_Bus_Port.c **** }
 132              		.loc 1 81 12 view .LVU22
 133 0020 2046     		mov	r0, r4
 134              	.LVL11:
 135              	.L6:
 136              		.loc 1 82 1 view .LVU23
 137 0022 38BD     		pop	{r3, r4, r5, pc}
 138              	.L15:
 139              		.align	2
 140              	.L14:
 141 0024 00000000 		.word	BspSPI
 142 0028 00000000 		.word	.LANCHOR0
 143              		.cfi_endproc
 144              	.LFE136:
 146              		.section	.text.Storage_External_Chip_BusRx,"ax",%progbits
 147              		.align	1
 148              		.syntax unified
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 5


 149              		.thumb
 150              		.thumb_func
 152              	Storage_External_Chip_BusRx:
 153              	.LVL12:
 154              	.LFB137:
  83:System/storage/Storage_Bus_Port.c **** 
  84:System/storage/Storage_Bus_Port.c **** static uint16_t Storage_External_Chip_BusRx(uint8_t *p_data, uint16_t len, uint32_t time_out)
  85:System/storage/Storage_Bus_Port.c **** {
 155              		.loc 1 85 1 is_stmt 1 view -0
 156              		.cfi_startproc
 157              		@ args = 0, pretend = 0, frame = 0
 158              		@ frame_needed = 0, uses_anonymous_args = 0
  86:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
  87:System/storage/Storage_Bus_Port.c ****     if (p_data && len)
 159              		.loc 1 87 5 view .LVU25
 160              		.loc 1 87 8 is_stmt 0 view .LVU26
 161 0000 60B1     		cbz	r0, .L18
  85:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
 162              		.loc 1 85 1 discriminator 1 view .LVU27
 163 0002 38B5     		push	{r3, r4, r5, lr}
 164              	.LCFI4:
 165              		.cfi_def_cfa_offset 16
 166              		.cfi_offset 3, -16
 167              		.cfi_offset 4, -12
 168              		.cfi_offset 5, -8
 169              		.cfi_offset 14, -4
 170 0004 0C46     		mov	r4, r1
 171 0006 0146     		mov	r1, r0
 172              	.LVL13:
 173              		.loc 1 87 16 discriminator 1 view .LVU28
 174 0008 54B1     		cbz	r4, .L19
  88:System/storage/Storage_Bus_Port.c ****     {
  89:System/storage/Storage_Bus_Port.c ****         if (ExtFlash_Bus_Api.receive(&ExtFlash_Bus_InstObj, p_data, len, time_out))
 175              		.loc 1 89 9 is_stmt 1 view .LVU29
 176              		.loc 1 89 29 is_stmt 0 view .LVU30
 177 000a 064B     		ldr	r3, .L25
 178 000c DD68     		ldr	r5, [r3, #12]
 179              		.loc 1 89 13 view .LVU31
 180 000e 93B2     		uxth	r3, r2
 181 0010 2246     		mov	r2, r4
 182              	.LVL14:
 183              		.loc 1 89 13 view .LVU32
 184 0012 0548     		ldr	r0, .L25+4
 185              	.LVL15:
 186              		.loc 1 89 13 view .LVU33
 187 0014 A847     		blx	r5
 188              	.LVL16:
 189              		.loc 1 89 12 view .LVU34
 190 0016 20B1     		cbz	r0, .L17
  90:System/storage/Storage_Bus_Port.c ****             return len;
 191              		.loc 1 90 20 view .LVU35
 192 0018 2046     		mov	r0, r4
 193 001a 02E0     		b	.L17
 194              	.LVL17:
 195              	.L18:
 196              	.LCFI5:
 197              		.cfi_def_cfa_offset 0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 6


 198              		.cfi_restore 3
 199              		.cfi_restore 4
 200              		.cfi_restore 5
 201              		.cfi_restore 14
  91:System/storage/Storage_Bus_Port.c ****     }
  92:System/storage/Storage_Bus_Port.c **** #endif
  93:System/storage/Storage_Bus_Port.c **** 
  94:System/storage/Storage_Bus_Port.c ****     return 0;
 202              		.loc 1 94 12 view .LVU36
 203 001c 0020     		movs	r0, #0
 204              	.LVL18:
  95:System/storage/Storage_Bus_Port.c **** }
 205              		.loc 1 95 1 view .LVU37
 206 001e 7047     		bx	lr
 207              	.LVL19:
 208              	.L19:
 209              	.LCFI6:
 210              		.cfi_def_cfa_offset 16
 211              		.cfi_offset 3, -16
 212              		.cfi_offset 4, -12
 213              		.cfi_offset 5, -8
 214              		.cfi_offset 14, -4
  94:System/storage/Storage_Bus_Port.c **** }
 215              		.loc 1 94 12 view .LVU38
 216 0020 2046     		mov	r0, r4
 217              	.LVL20:
 218              	.L17:
 219              		.loc 1 95 1 view .LVU39
 220 0022 38BD     		pop	{r3, r4, r5, pc}
 221              	.L26:
 222              		.align	2
 223              	.L25:
 224 0024 00000000 		.word	BspSPI
 225 0028 00000000 		.word	.LANCHOR0
 226              		.cfi_endproc
 227              	.LFE137:
 229              		.section	.text.Storage_External_Chip_BusTrans,"ax",%progbits
 230              		.align	1
 231              		.syntax unified
 232              		.thumb
 233              		.thumb_func
 235              	Storage_External_Chip_BusTrans:
 236              	.LVL21:
 237              	.LFB138:
  96:System/storage/Storage_Bus_Port.c **** 
  97:System/storage/Storage_Bus_Port.c **** static uint16_t Storage_External_Chip_BusTrans(uint8_t *tx, uint8_t *rx, uint16_t len, uint32_t tim
  98:System/storage/Storage_Bus_Port.c **** {
 238              		.loc 1 98 1 is_stmt 1 view -0
 239              		.cfi_startproc
 240              		@ args = 0, pretend = 0, frame = 0
 241              		@ frame_needed = 0, uses_anonymous_args = 0
  99:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
 100:System/storage/Storage_Bus_Port.c ****     if (tx && rx && len)
 242              		.loc 1 100 5 view .LVU41
 243              		.loc 1 100 8 is_stmt 0 view .LVU42
 244 0000 80B1     		cbz	r0, .L29
  98:System/storage/Storage_Bus_Port.c **** #if (ExtFlash_Bus_Type == Storage_ChipBus_Spi)
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 7


 245              		.loc 1 98 1 discriminator 1 view .LVU43
 246 0002 30B5     		push	{r4, r5, lr}
 247              	.LCFI7:
 248              		.cfi_def_cfa_offset 12
 249              		.cfi_offset 4, -12
 250              		.cfi_offset 5, -8
 251              		.cfi_offset 14, -4
 252 0004 83B0     		sub	sp, sp, #12
 253              	.LCFI8:
 254              		.cfi_def_cfa_offset 24
 255 0006 1446     		mov	r4, r2
 256              		.loc 1 100 12 discriminator 1 view .LVU44
 257 0008 71B1     		cbz	r1, .L30
 258              		.loc 1 100 18 discriminator 2 view .LVU45
 259 000a 7AB1     		cbz	r2, .L31
 101:System/storage/Storage_Bus_Port.c ****     {
 102:System/storage/Storage_Bus_Port.c ****         if (ExtFlash_Bus_Api.trans_receive(&ExtFlash_Bus_InstObj, tx, rx, len, time_out))
 260              		.loc 1 102 9 is_stmt 1 view .LVU46
 261              		.loc 1 102 29 is_stmt 0 view .LVU47
 262 000c 094A     		ldr	r2, .L37
 263              	.LVL22:
 264              		.loc 1 102 29 view .LVU48
 265 000e 1569     		ldr	r5, [r2, #16]
 266              		.loc 1 102 13 view .LVU49
 267 0010 9BB2     		uxth	r3, r3
 268              	.LVL23:
 269              		.loc 1 102 13 view .LVU50
 270 0012 0093     		str	r3, [sp]
 271 0014 2346     		mov	r3, r4
 272 0016 0A46     		mov	r2, r1
 273 0018 0146     		mov	r1, r0
 274              	.LVL24:
 275              		.loc 1 102 13 view .LVU51
 276 001a 0748     		ldr	r0, .L37+4
 277              	.LVL25:
 278              		.loc 1 102 13 view .LVU52
 279 001c A847     		blx	r5
 280              	.LVL26:
 281              		.loc 1 102 12 view .LVU53
 282 001e 30B1     		cbz	r0, .L28
 103:System/storage/Storage_Bus_Port.c ****             return len;
 283              		.loc 1 103 20 view .LVU54
 284 0020 2046     		mov	r0, r4
 285 0022 04E0     		b	.L28
 286              	.LVL27:
 287              	.L29:
 288              	.LCFI9:
 289              		.cfi_def_cfa_offset 0
 290              		.cfi_restore 4
 291              		.cfi_restore 5
 292              		.cfi_restore 14
 104:System/storage/Storage_Bus_Port.c ****     }
 105:System/storage/Storage_Bus_Port.c **** #endif
 106:System/storage/Storage_Bus_Port.c **** 
 107:System/storage/Storage_Bus_Port.c ****     return 0;
 293              		.loc 1 107 12 view .LVU55
 294 0024 0020     		movs	r0, #0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 8


 295              	.LVL28:
 108:System/storage/Storage_Bus_Port.c **** }
 296              		.loc 1 108 1 view .LVU56
 297 0026 7047     		bx	lr
 298              	.LVL29:
 299              	.L30:
 300              	.LCFI10:
 301              		.cfi_def_cfa_offset 24
 302              		.cfi_offset 4, -12
 303              		.cfi_offset 5, -8
 304              		.cfi_offset 14, -4
 107:System/storage/Storage_Bus_Port.c **** }
 305              		.loc 1 107 12 view .LVU57
 306 0028 0020     		movs	r0, #0
 307              	.LVL30:
 107:System/storage/Storage_Bus_Port.c **** }
 308              		.loc 1 107 12 view .LVU58
 309 002a 00E0     		b	.L28
 310              	.LVL31:
 311              	.L31:
 107:System/storage/Storage_Bus_Port.c **** }
 312              		.loc 1 107 12 view .LVU59
 313 002c 1046     		mov	r0, r2
 314              	.LVL32:
 315              	.L28:
 316              		.loc 1 108 1 view .LVU60
 317 002e 03B0     		add	sp, sp, #12
 318              	.LCFI11:
 319              		.cfi_def_cfa_offset 12
 320              		@ sp needed
 321 0030 30BD     		pop	{r4, r5, pc}
 322              	.L38:
 323 0032 00BF     		.align	2
 324              	.L37:
 325 0034 00000000 		.word	BspSPI
 326 0038 00000000 		.word	.LANCHOR0
 327              		.cfi_endproc
 328              	.LFE138:
 330              		.section	.text.Storage_External_Chip_Bus_Init,"ax",%progbits
 331              		.align	1
 332              		.syntax unified
 333              		.thumb
 334              		.thumb_func
 336              	Storage_External_Chip_Bus_Init:
 337              	.LVL33:
 338              	.LFB134:
  27:System/storage/Storage_Bus_Port.c ****     void *obj = NULL;
 339              		.loc 1 27 1 is_stmt 1 view -0
 340              		.cfi_startproc
 341              		@ args = 0, pretend = 0, frame = 0
 342              		@ frame_needed = 0, uses_anonymous_args = 0
  27:System/storage/Storage_Bus_Port.c ****     void *obj = NULL;
 343              		.loc 1 27 1 is_stmt 0 view .LVU62
 344 0000 30B5     		push	{r4, r5, lr}
 345              	.LCFI12:
 346              		.cfi_def_cfa_offset 12
 347              		.cfi_offset 4, -12
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 9


 348              		.cfi_offset 5, -8
 349              		.cfi_offset 14, -4
 350 0002 8BB0     		sub	sp, sp, #44
 351              	.LCFI13:
 352              		.cfi_def_cfa_offset 56
  28:System/storage/Storage_Bus_Port.c **** 
 353              		.loc 1 28 5 is_stmt 1 view .LVU63
 354              	.LVL34:
  30:System/storage/Storage_Bus_Port.c ****         (p_free == NULL))
 355              		.loc 1 30 5 view .LVU64
  30:System/storage/Storage_Bus_Port.c ****         (p_free == NULL))
 356              		.loc 1 30 8 is_stmt 0 view .LVU65
 357 0004 0028     		cmp	r0, #0
 358 0006 38D0     		beq	.L42
 359 0008 0346     		mov	r3, r0
  30:System/storage/Storage_Bus_Port.c ****         (p_free == NULL))
 360              		.loc 1 30 28 discriminator 1 view .LVU66
 361 000a 0029     		cmp	r1, #0
 362 000c 37D0     		beq	.L43
  36:System/storage/Storage_Bus_Port.c ****         if (obj == NULL)
 363              		.loc 1 36 9 is_stmt 1 view .LVU67
  36:System/storage/Storage_Bus_Port.c ****         if (obj == NULL)
 364              		.loc 1 36 15 is_stmt 0 view .LVU68
 365 000e 3020     		movs	r0, #48
 366              	.LVL35:
  36:System/storage/Storage_Bus_Port.c ****         if (obj == NULL)
 367              		.loc 1 36 15 view .LVU69
 368 0010 9847     		blx	r3
 369              	.LVL36:
  37:System/storage/Storage_Bus_Port.c ****             return NULL;
 370              		.loc 1 37 9 is_stmt 1 view .LVU70
  37:System/storage/Storage_Bus_Port.c ****             return NULL;
 371              		.loc 1 37 12 is_stmt 0 view .LVU71
 372 0012 0446     		mov	r4, r0
 373 0014 60B3     		cbz	r0, .L39
  40:System/storage/Storage_Bus_Port.c **** 
 374              		.loc 1 40 9 is_stmt 1 view .LVU72
 375 0016 3022     		movs	r2, #48
 376 0018 0021     		movs	r1, #0
 377 001a FFF7FEFF 		bl	memset
 378              	.LVL37:
  42:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->CLKPhase = ExtFlash_Bus_CLKPhase;
 379              		.loc 1 42 9 view .LVU73
  42:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->CLKPhase = ExtFlash_Bus_CLKPhase;
 380              		.loc 1 42 53 is_stmt 0 view .LVU74
 381 001e 0123     		movs	r3, #1
 382 0020 E362     		str	r3, [r4, #44]
  43:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->CLKPolarity = ExtFlash_Bus_CLKPolarity;
 383              		.loc 1 43 9 is_stmt 1 view .LVU75
  43:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->CLKPolarity = ExtFlash_Bus_CLKPolarity;
 384              		.loc 1 43 44 is_stmt 0 view .LVU76
 385 0022 A362     		str	r3, [r4, #40]
  44:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->Instance = ExtFLash_Bus_Instance;
 386              		.loc 1 44 9 is_stmt 1 view .LVU77
  44:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->Instance = ExtFLash_Bus_Instance;
 387              		.loc 1 44 47 is_stmt 0 view .LVU78
 388 0024 6362     		str	r3, [r4, #36]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 10


  45:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->Pin = ExtFlash_Bus_Pin;
 389              		.loc 1 45 9 is_stmt 1 view .LVU79
  45:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->Pin = ExtFlash_Bus_Pin;
 390              		.loc 1 45 44 is_stmt 0 view .LVU80
 391 0026 174B     		ldr	r3, .L45
 392 0028 2362     		str	r3, [r4, #32]
  46:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->work_mode = BspSPI_Mode_Master;
 393              		.loc 1 46 9 is_stmt 1 view .LVU81
  46:System/storage/Storage_Bus_Port.c ****         To_NormalSPI_ObjPtr(obj)->work_mode = BspSPI_Mode_Master;
 394              		.loc 1 46 39 is_stmt 0 view .LVU82
 395 002a A446     		mov	ip, r4
 396 002c 164D     		ldr	r5, .L45+4
 397 002e 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 398 0030 ACE80F00 		stmia	ip!, {r0, r1, r2, r3}
 399 0034 95E80700 		ldm	r5, {r0, r1, r2}
 400 0038 8CE80700 		stm	ip, {r0, r1, r2}
  47:System/storage/Storage_Bus_Port.c **** 
 401              		.loc 1 47 9 is_stmt 1 view .LVU83
  49:System/storage/Storage_Bus_Port.c ****             !BspGPIO.out_init(ExtFlash_CS_Pin))
 402              		.loc 1 49 9 view .LVU84
  49:System/storage/Storage_Bus_Port.c ****             !BspGPIO.out_init(ExtFlash_CS_Pin))
 403              		.loc 1 49 30 is_stmt 0 view .LVU85
 404 003c 134B     		ldr	r3, .L45+8
 405 003e 1D68     		ldr	r5, [r3]
  49:System/storage/Storage_Bus_Port.c ****             !BspGPIO.out_init(ExtFlash_CS_Pin))
 406              		.loc 1 49 14 view .LVU86
 407 0040 134B     		ldr	r3, .L45+12
 408 0042 0893     		str	r3, [sp, #32]
 409 0044 EC46     		mov	ip, sp
 410 0046 04F1100E 		add	lr, r4, #16
 411 004a BEE80F00 		ldmia	lr!, {r0, r1, r2, r3}
 412 004e ACE80F00 		stmia	ip!, {r0, r1, r2, r3}
 413 0052 9EE80F00 		ldm	lr, {r0, r1, r2, r3}
 414 0056 8CE80F00 		stm	ip, {r0, r1, r2, r3}
 415 005a 94E80F00 		ldm	r4, {r0, r1, r2, r3}
 416 005e A847     		blx	r5
 417              	.LVL38:
  49:System/storage/Storage_Bus_Port.c ****             !BspGPIO.out_init(ExtFlash_CS_Pin))
 418              		.loc 1 49 12 view .LVU87
 419 0060 48B1     		cbz	r0, .L41
  50:System/storage/Storage_Bus_Port.c ****             return NULL;
 420              		.loc 1 50 21 discriminator 1 view .LVU88
 421 0062 0C4B     		ldr	r3, .L45+16
 422 0064 5D68     		ldr	r5, [r3, #4]
  50:System/storage/Storage_Bus_Port.c ****             return NULL;
 423              		.loc 1 50 14 discriminator 1 view .LVU89
 424 0066 0C4B     		ldr	r3, .L45+20
 425 0068 93E80700 		ldm	r3, {r0, r1, r2}
 426 006c A847     		blx	r5
 427              	.LVL39:
  49:System/storage/Storage_Bus_Port.c ****             !BspGPIO.out_init(ExtFlash_CS_Pin))
 428              		.loc 1 49 82 discriminator 1 view .LVU90
 429 006e 10B1     		cbz	r0, .L41
 430              	.LVL40:
 431              	.L39:
  61:System/storage/Storage_Bus_Port.c **** 
 432              		.loc 1 61 1 view .LVU91
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 11


 433 0070 2046     		mov	r0, r4
 434 0072 0BB0     		add	sp, sp, #44
 435              	.LCFI14:
 436              		.cfi_remember_state
 437              		.cfi_def_cfa_offset 12
 438              		@ sp needed
 439 0074 30BD     		pop	{r4, r5, pc}
 440              	.LVL41:
 441              	.L41:
 442              	.LCFI15:
 443              		.cfi_restore_state
  51:System/storage/Storage_Bus_Port.c **** 
 444              		.loc 1 51 13 is_stmt 1 view .LVU92
  51:System/storage/Storage_Bus_Port.c **** 
 445              		.loc 1 51 20 is_stmt 0 view .LVU93
 446 0076 0024     		movs	r4, #0
 447              	.LVL42:
  51:System/storage/Storage_Bus_Port.c **** 
 448              		.loc 1 51 20 view .LVU94
 449 0078 FAE7     		b	.L39
 450              	.LVL43:
 451              	.L42:
  32:System/storage/Storage_Bus_Port.c **** 
 452              		.loc 1 32 16 view .LVU95
 453 007a 0024     		movs	r4, #0
 454 007c F8E7     		b	.L39
 455              	.L43:
  32:System/storage/Storage_Bus_Port.c **** 
 456              		.loc 1 32 16 view .LVU96
 457 007e 0024     		movs	r4, #0
 458 0080 F6E7     		b	.L39
 459              	.L46:
 460 0082 00BF     		.align	2
 461              	.L45:
 462 0084 00380040 		.word	1073756160
 463 0088 00000000 		.word	ExtFlash_SPIPin
 464 008c 00000000 		.word	BspSPI
 465 0090 00000000 		.word	.LANCHOR0
 466 0094 00000000 		.word	BspGPIO
 467 0098 00000000 		.word	ExtFlash_CSPin
 468              		.cfi_endproc
 469              	.LFE134:
 471              		.global	StoragePort_Api
 472              		.global	ExtFlash_Bus_InstObj
 473              		.section	.bss.ExtFlash_Bus_InstObj,"aw",%nobits
 474              		.align	2
 475              		.set	.LANCHOR0,. + 0
 478              	ExtFlash_Bus_InstObj:
 479 0000 00000000 		.space	4
 480              		.section	.data.StoragePort_Api,"aw"
 481              		.align	2
 484              	StoragePort_Api:
 485 0000 00000000 		.word	Storage_External_Chip_Bus_Init
 486 0004 00000000 		.word	Storage_External_Chip_SelectPin_Ctl
 487 0008 00000000 		.word	Storage_External_Chip_BusTx
 488 000c 00000000 		.word	Storage_External_Chip_BusRx
 489 0010 00000000 		.word	Storage_External_Chip_BusTrans
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 12


 490              		.text
 491              	.Letext0:
 492              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 493              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 494              		.file 4 "System/storage/Storage_Bus_Port.h"
 495              		.file 5 "HW_Lib/AT32F435/drivers/inc/at32f435_437_tmr.h"
 496              		.file 6 "HW_Lib/AT32F435/drivers/inc/at32f435_437_spi.h"
 497              		.file 7 "HW_Lib/PortApi_Def/Bsp_GPIO_Port_Def.h"
 498              		.file 8 "HW_Lib/AT32F435/bsp/Bsp_GPIO.h"
 499              		.file 9 "HW_Lib/PortApi_Def/Bsp_SPI_Port_Def.h"
 500              		.file 10 "HW_Lib/AT32F435/bsp/Bsp_SPI.h"
 501              		.file 11 "common/Error_Log/../../common/gen_physic_def/imu_data.h"
 502              		.file 12 "HW_Lib/AT32F435/PinPort_Def/CCRC_AT32_20/HW_Def.h"
 503              		.file 13 "<built-in>"
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s 			page 13


DEFINED SYMBOLS
                            *ABS*:00000000 Storage_Bus_Port.c
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:20     .text.Storage_External_Chip_SelectPin_Ctl:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:25     .text.Storage_External_Chip_SelectPin_Ctl:00000000 Storage_External_Chip_SelectPin_Ctl
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:58     .text.Storage_External_Chip_SelectPin_Ctl:00000014 $d
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:64     .text.Storage_External_Chip_BusTx:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:69     .text.Storage_External_Chip_BusTx:00000000 Storage_External_Chip_BusTx
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:141    .text.Storage_External_Chip_BusTx:00000024 $d
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:147    .text.Storage_External_Chip_BusRx:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:152    .text.Storage_External_Chip_BusRx:00000000 Storage_External_Chip_BusRx
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:224    .text.Storage_External_Chip_BusRx:00000024 $d
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:230    .text.Storage_External_Chip_BusTrans:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:235    .text.Storage_External_Chip_BusTrans:00000000 Storage_External_Chip_BusTrans
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:325    .text.Storage_External_Chip_BusTrans:00000034 $d
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:331    .text.Storage_External_Chip_Bus_Init:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:336    .text.Storage_External_Chip_Bus_Init:00000000 Storage_External_Chip_Bus_Init
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:462    .text.Storage_External_Chip_Bus_Init:00000084 $d
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:484    .data.StoragePort_Api:00000000 StoragePort_Api
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:478    .bss.ExtFlash_Bus_InstObj:00000000 ExtFlash_Bus_InstObj
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:474    .bss.ExtFlash_Bus_InstObj:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccYrF2Am.s:481    .data.StoragePort_Api:00000000 $d

UNDEFINED SYMBOLS
BspGPIO
ExtFlash_CSPin
BspSPI
memset
ExtFlash_SPIPin
