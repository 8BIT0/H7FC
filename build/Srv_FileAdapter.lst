ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"Srv_FileAdapter.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.SrvFileAdapter_Create_AdapterObj,"ax",%progbits
  20              		.align	1
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	SrvFileAdapter_Create_AdapterObj:
  26              	.LVL0:
  27              	.LFB145:
  28              		.file 1 "Service/Srv_FileAdapter.c"
   1:Service/Srv_FileAdapter.c **** /* 
   2:Service/Srv_FileAdapter.c ****  * Auther: 8_B!T0
   3:Service/Srv_FileAdapter.c ****  * bref: Use YMODEM receive firmware
   4:Service/Srv_FileAdapter.c ****  * 
   5:Service/Srv_FileAdapter.c ****  */
   6:Service/Srv_FileAdapter.c **** #include "Srv_FileAdapter.h"
   7:Service/Srv_FileAdapter.c **** #include "Srv_OsCommon.h"
   8:Service/Srv_FileAdapter.c **** #include "../System/storage/Storage.h"
   9:Service/Srv_FileAdapter.c **** #include "YModem.h"
  10:Service/Srv_FileAdapter.c **** #include "HW_Def.h"
  11:Service/Srv_FileAdapter.c **** #include "debug_util.h"
  12:Service/Srv_FileAdapter.c **** 
  13:Service/Srv_FileAdapter.c **** #define ADAPTER_INPUT_BUFF_SIZE 2048
  14:Service/Srv_FileAdapter.c **** 
  15:Service/Srv_FileAdapter.c **** #define ADAPTER_INFO(fmt,...) Debug_Print(&DebugPort, "[ ADAPTER INFO ] ", fmt, ##__VA_ARGS__)
  16:Service/Srv_FileAdapter.c **** 
  17:Service/Srv_FileAdapter.c **** typedef struct
  18:Service/Srv_FileAdapter.c **** {
  19:Service/Srv_FileAdapter.c ****     uint8_t buf[ADAPTER_INPUT_BUFF_SIZE];
  20:Service/Srv_FileAdapter.c ****     uint16_t size;
  21:Service/Srv_FileAdapter.c ****     uint16_t total_size;
  22:Service/Srv_FileAdapter.c **** } Adapter_InputStream_TypeDef;
  23:Service/Srv_FileAdapter.c **** 
  24:Service/Srv_FileAdapter.c **** /* internal vriable */
  25:Service/Srv_FileAdapter.c **** static Adapter_InputStream_TypeDef AdapterInStream = {
  26:Service/Srv_FileAdapter.c ****     .size = 0,
  27:Service/Srv_FileAdapter.c ****     .total_size = ADAPTER_INPUT_BUFF_SIZE,
  28:Service/Srv_FileAdapter.c **** };
  29:Service/Srv_FileAdapter.c **** 
  30:Service/Srv_FileAdapter.c **** /* internal function */
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 2


  31:Service/Srv_FileAdapter.c **** static Adapter_Polling_State SrvAdapter_YModem_Polling(SrvFileAdapterObj_TypeDef *p_Adapter, bool *
  32:Service/Srv_FileAdapter.c **** 
  33:Service/Srv_FileAdapter.c **** /* external function */
  34:Service/Srv_FileAdapter.c **** static SrvFileAdapterObj_TypeDef* SrvFileAdapter_Create_AdapterObj(Adapter_ProtoType_List proto_typ
  35:Service/Srv_FileAdapter.c **** static bool SrvFileAdapter_Destory_AdapterObj(SrvFileAdapterObj_TypeDef *p_Adapter);
  36:Service/Srv_FileAdapter.c **** static void SrvFileAdapter_Set_SendCallback(SrvFileAdapterObj_TypeDef *p_Adapter, SrvFileAdapter_Se
  37:Service/Srv_FileAdapter.c **** static Adapter_Polling_State SrvFileAdapter_Polling(uint32_t sys_time, SrvFileAdapterObj_TypeDef *p
  38:Service/Srv_FileAdapter.c **** static bool SrvFileAdapter_PushToStream(uint8_t *p_buf, uint16_t size);
  39:Service/Srv_FileAdapter.c **** static FileInfo_TypeDef SrvFileAdapter_GetFileInfo(SrvFileAdapterObj_TypeDef *p_Adapter);
  40:Service/Srv_FileAdapter.c **** 
  41:Service/Srv_FileAdapter.c **** /* external virable */
  42:Service/Srv_FileAdapter.c **** SrvFileAdapter_TypeDef SrvFileAdapter = {
  43:Service/Srv_FileAdapter.c ****     .create = SrvFileAdapter_Create_AdapterObj,
  44:Service/Srv_FileAdapter.c ****     .destory = SrvFileAdapter_Destory_AdapterObj,
  45:Service/Srv_FileAdapter.c ****     .push_to_stream = SrvFileAdapter_PushToStream,
  46:Service/Srv_FileAdapter.c ****     .polling = SrvFileAdapter_Polling,
  47:Service/Srv_FileAdapter.c ****     .set_send = SrvFileAdapter_Set_SendCallback,
  48:Service/Srv_FileAdapter.c ****     .get_file_info = SrvFileAdapter_GetFileInfo,
  49:Service/Srv_FileAdapter.c **** };
  50:Service/Srv_FileAdapter.c **** 
  51:Service/Srv_FileAdapter.c **** static SrvFileAdapterObj_TypeDef* SrvFileAdapter_Create_AdapterObj(Adapter_ProtoType_List proto_typ
  52:Service/Srv_FileAdapter.c **** {
  29              		.loc 1 52 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 16
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		.loc 1 52 1 is_stmt 0 view .LVU1
  34 0000 30B5     		push	{r4, r5, lr}
  35              	.LCFI0:
  36              		.cfi_def_cfa_offset 12
  37              		.cfi_offset 4, -12
  38              		.cfi_offset 5, -8
  39              		.cfi_offset 14, -4
  40 0002 85B0     		sub	sp, sp, #20
  41              	.LCFI1:
  42              		.cfi_def_cfa_offset 32
  43 0004 0546     		mov	r5, r0
  44 0006 04A8     		add	r0, sp, #16
  45              	.LVL1:
  46              		.loc 1 52 1 view .LVU2
  47 0008 00E90E00 		stmdb	r0, {r1, r2, r3}
  53:Service/Srv_FileAdapter.c ****     SrvFileAdapterObj_TypeDef *p_AdapterObj = NULL;
  48              		.loc 1 53 5 is_stmt 1 view .LVU3
  49              	.LVL2:
  54:Service/Srv_FileAdapter.c ****     
  55:Service/Srv_FileAdapter.c ****     p_AdapterObj = SrvOsCommon.malloc(sizeof(SrvFileAdapterObj_TypeDef));
  50              		.loc 1 55 5 view .LVU4
  51              		.loc 1 55 31 is_stmt 0 view .LVU5
  52 000c 154B     		ldr	r3, .L9
  53 000e 9B6A     		ldr	r3, [r3, #40]
  54              		.loc 1 55 20 view .LVU6
  55 0010 2820     		movs	r0, #40
  56 0012 9847     		blx	r3
  57              	.LVL3:
  56:Service/Srv_FileAdapter.c ****     if (p_AdapterObj == NULL)
  58              		.loc 1 56 5 is_stmt 1 view .LVU7
  59              		.loc 1 56 8 is_stmt 0 view .LVU8
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 3


  60 0014 0446     		mov	r4, r0
  61 0016 A8B1     		cbz	r0, .L7
  62              	.LVL4:
  63              	.L2:
  57:Service/Srv_FileAdapter.c ****         SrvOsCommon.free(p_AdapterObj);
  58:Service/Srv_FileAdapter.c ****     
  59:Service/Srv_FileAdapter.c ****     p_AdapterObj->frame_type = proto_type;
  64              		.loc 1 59 5 is_stmt 1 view .LVU9
  65              		.loc 1 59 30 is_stmt 0 view .LVU10
  66 0018 2571     		strb	r5, [r4, #4]
  60:Service/Srv_FileAdapter.c ****     p_AdapterObj->file_info = file_info;
  67              		.loc 1 60 5 is_stmt 1 view .LVU11
  68              		.loc 1 60 29 is_stmt 0 view .LVU12
  69 001a 04F11803 		add	r3, r4, #24
  70 001e 04AA     		add	r2, sp, #16
  71 0020 12E90700 		ldmdb	r2, {r0, r1, r2}
  72 0024 83E80700 		stm	r3, {r0, r1, r2}
  61:Service/Srv_FileAdapter.c **** 
  62:Service/Srv_FileAdapter.c ****     switch (proto_type)
  73              		.loc 1 62 5 is_stmt 1 view .LVU13
  74 0028 012D     		cmp	r5, #1
  75 002a 15D1     		bne	.L3
  63:Service/Srv_FileAdapter.c ****     {
  64:Service/Srv_FileAdapter.c ****         case SrvFileAdapter_Frame_YModem:
  65:Service/Srv_FileAdapter.c ****             /* create YModem Object */
  66:Service/Srv_FileAdapter.c ****             p_AdapterObj->FrameObj = SrvOsCommon.malloc(YModemObj_size);
  76              		.loc 1 66 13 view .LVU14
  77              		.loc 1 66 49 is_stmt 0 view .LVU15
  78 002c 0D4B     		ldr	r3, .L9
  79 002e 9B6A     		ldr	r3, [r3, #40]
  80              		.loc 1 66 38 view .LVU16
  81 0030 2420     		movs	r0, #36
  82 0032 9847     		blx	r3
  83              	.LVL5:
  84 0034 0546     		mov	r5, r0
  85              		.loc 1 66 36 view .LVU17
  86 0036 A060     		str	r0, [r4, #8]
  67:Service/Srv_FileAdapter.c ****             if (p_AdapterObj->FrameObj == NULL)
  87              		.loc 1 67 13 is_stmt 1 view .LVU18
  88              		.loc 1 67 16 is_stmt 0 view .LVU19
  89 0038 40B1     		cbz	r0, .L8
  90              	.LVL6:
  91              	.L4:
  68:Service/Srv_FileAdapter.c ****             {
  69:Service/Srv_FileAdapter.c ****                 SrvOsCommon.free(p_AdapterObj);
  70:Service/Srv_FileAdapter.c ****                 p_AdapterObj = NULL;
  71:Service/Srv_FileAdapter.c ****             }
  72:Service/Srv_FileAdapter.c ****             
  73:Service/Srv_FileAdapter.c ****             p_AdapterObj->FrameApi = (void *)&YModem;
  92              		.loc 1 73 13 is_stmt 1 view .LVU20
  93              		.loc 1 73 36 is_stmt 0 view .LVU21
  94 003a 0B4B     		ldr	r3, .L9+4
  95 003c E360     		str	r3, [r4, #12]
  74:Service/Srv_FileAdapter.c ****             break;
  96              		.loc 1 74 13 is_stmt 1 view .LVU22
  97              	.LVL7:
  98              	.L1:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 4


  75:Service/Srv_FileAdapter.c **** 
  76:Service/Srv_FileAdapter.c ****         default:
  77:Service/Srv_FileAdapter.c ****             SrvOsCommon.free(p_AdapterObj);
  78:Service/Srv_FileAdapter.c ****             p_AdapterObj = NULL;
  79:Service/Srv_FileAdapter.c ****             break;
  80:Service/Srv_FileAdapter.c ****     }
  81:Service/Srv_FileAdapter.c **** 
  82:Service/Srv_FileAdapter.c ****     return p_AdapterObj;
  83:Service/Srv_FileAdapter.c **** }
  99              		.loc 1 83 1 is_stmt 0 view .LVU23
 100 003e 2046     		mov	r0, r4
 101 0040 05B0     		add	sp, sp, #20
 102              	.LCFI2:
 103              		.cfi_remember_state
 104              		.cfi_def_cfa_offset 12
 105              		@ sp needed
 106 0042 30BD     		pop	{r4, r5, pc}
 107              	.LVL8:
 108              	.L7:
 109              	.LCFI3:
 110              		.cfi_restore_state
  57:Service/Srv_FileAdapter.c ****     
 111              		.loc 1 57 9 is_stmt 1 view .LVU24
  57:Service/Srv_FileAdapter.c ****     
 112              		.loc 1 57 20 is_stmt 0 view .LVU25
 113 0044 074B     		ldr	r3, .L9
 114 0046 DB6A     		ldr	r3, [r3, #44]
  57:Service/Srv_FileAdapter.c ****     
 115              		.loc 1 57 9 view .LVU26
 116 0048 9847     		blx	r3
 117              	.LVL9:
  57:Service/Srv_FileAdapter.c ****     
 118              		.loc 1 57 9 view .LVU27
 119 004a E5E7     		b	.L2
 120              	.L8:
  69:Service/Srv_FileAdapter.c ****                 p_AdapterObj = NULL;
 121              		.loc 1 69 17 is_stmt 1 view .LVU28
  69:Service/Srv_FileAdapter.c ****                 p_AdapterObj = NULL;
 122              		.loc 1 69 28 is_stmt 0 view .LVU29
 123 004c 054B     		ldr	r3, .L9
 124 004e DB6A     		ldr	r3, [r3, #44]
  69:Service/Srv_FileAdapter.c ****                 p_AdapterObj = NULL;
 125              		.loc 1 69 17 view .LVU30
 126 0050 2046     		mov	r0, r4
 127 0052 9847     		blx	r3
 128              	.LVL10:
  70:Service/Srv_FileAdapter.c ****             }
 129              		.loc 1 70 17 is_stmt 1 view .LVU31
  70:Service/Srv_FileAdapter.c ****             }
 130              		.loc 1 70 30 is_stmt 0 view .LVU32
 131 0054 2C46     		mov	r4, r5
 132 0056 F0E7     		b	.L4
 133              	.LVL11:
 134              	.L3:
  77:Service/Srv_FileAdapter.c ****             p_AdapterObj = NULL;
 135              		.loc 1 77 13 is_stmt 1 view .LVU33
  77:Service/Srv_FileAdapter.c ****             p_AdapterObj = NULL;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 5


 136              		.loc 1 77 24 is_stmt 0 view .LVU34
 137 0058 024B     		ldr	r3, .L9
 138 005a DB6A     		ldr	r3, [r3, #44]
  77:Service/Srv_FileAdapter.c ****             p_AdapterObj = NULL;
 139              		.loc 1 77 13 view .LVU35
 140 005c 2046     		mov	r0, r4
 141 005e 9847     		blx	r3
 142              	.LVL12:
  78:Service/Srv_FileAdapter.c ****             break;
 143              		.loc 1 78 13 is_stmt 1 view .LVU36
  79:Service/Srv_FileAdapter.c ****     }
 144              		.loc 1 79 13 view .LVU37
  78:Service/Srv_FileAdapter.c ****             break;
 145              		.loc 1 78 26 is_stmt 0 view .LVU38
 146 0060 0024     		movs	r4, #0
  82:Service/Srv_FileAdapter.c **** }
 147              		.loc 1 82 5 is_stmt 1 view .LVU39
  82:Service/Srv_FileAdapter.c **** }
 148              		.loc 1 82 12 is_stmt 0 view .LVU40
 149 0062 ECE7     		b	.L1
 150              	.L10:
 151              		.align	2
 152              	.L9:
 153 0064 00000000 		.word	SrvOsCommon
 154 0068 00000000 		.word	YModem
 155              		.cfi_endproc
 156              	.LFE145:
 158              		.section	.text.SrvFileAdapter_Set_SendCallback,"ax",%progbits
 159              		.align	1
 160              		.syntax unified
 161              		.thumb
 162              		.thumb_func
 164              	SrvFileAdapter_Set_SendCallback:
 165              	.LVL13:
 166              	.LFB147:
  84:Service/Srv_FileAdapter.c **** 
  85:Service/Srv_FileAdapter.c **** static bool SrvFileAdapter_Destory_AdapterObj(SrvFileAdapterObj_TypeDef *p_Adapter)
  86:Service/Srv_FileAdapter.c **** {
  87:Service/Srv_FileAdapter.c ****     if (p_Adapter && p_Adapter->FrameObj)
  88:Service/Srv_FileAdapter.c ****     {
  89:Service/Srv_FileAdapter.c ****         if (p_Adapter->frame_type == SrvFileAdapter_Frame_YModem)
  90:Service/Srv_FileAdapter.c ****             memset(p_Adapter->FrameObj, 0, sizeof(YModemObj_TypeDef));
  91:Service/Srv_FileAdapter.c **** 
  92:Service/Srv_FileAdapter.c ****         SrvOsCommon.free(p_Adapter->FrameObj);
  93:Service/Srv_FileAdapter.c ****         memset(p_Adapter, 0, sizeof(SrvFileAdapterObj_TypeDef));
  94:Service/Srv_FileAdapter.c ****         p_Adapter->FrameApi = NULL;
  95:Service/Srv_FileAdapter.c ****         p_Adapter->FrameObj = NULL;
  96:Service/Srv_FileAdapter.c ****         SrvOsCommon.free(p_Adapter);
  97:Service/Srv_FileAdapter.c ****         return true;
  98:Service/Srv_FileAdapter.c ****     }
  99:Service/Srv_FileAdapter.c **** 
 100:Service/Srv_FileAdapter.c ****     return false;
 101:Service/Srv_FileAdapter.c **** }
 102:Service/Srv_FileAdapter.c **** 
 103:Service/Srv_FileAdapter.c **** static void SrvFileAdapter_Set_SendCallback(SrvFileAdapterObj_TypeDef *p_Adapter,  SrvFileAdapter_S
 104:Service/Srv_FileAdapter.c **** {
 167              		.loc 1 104 1 is_stmt 1 view -0
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 6


 168              		.cfi_startproc
 169              		@ args = 0, pretend = 0, frame = 0
 170              		@ frame_needed = 0, uses_anonymous_args = 0
 171              		@ link register save eliminated.
 105:Service/Srv_FileAdapter.c ****     if (p_Adapter && p_Adapter->FrameObj)
 172              		.loc 1 105 5 view .LVU42
 173              		.loc 1 105 8 is_stmt 0 view .LVU43
 174 0000 20B1     		cbz	r0, .L11
 175              		.loc 1 105 31 discriminator 1 view .LVU44
 176 0002 8268     		ldr	r2, [r0, #8]
 177              		.loc 1 105 19 discriminator 1 view .LVU45
 178 0004 12B1     		cbz	r2, .L11
 106:Service/Srv_FileAdapter.c ****     {
 107:Service/Srv_FileAdapter.c ****         switch ((uint8_t) p_Adapter->frame_type)
 179              		.loc 1 107 9 is_stmt 1 view .LVU46
 180              		.loc 1 107 36 is_stmt 0 view .LVU47
 181 0006 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 182              		.loc 1 107 9 view .LVU48
 183 0008 012B     		cmp	r3, #1
 184 000a 00D0     		beq	.L13
 185              	.L11:
 108:Service/Srv_FileAdapter.c ****         {
 109:Service/Srv_FileAdapter.c ****             case SrvFileAdapter_Frame_YModem: To_YModem_Obj(p_Adapter->FrameObj)->send_callback = s
 110:Service/Srv_FileAdapter.c ****             default: break;
 111:Service/Srv_FileAdapter.c ****         }
 112:Service/Srv_FileAdapter.c ****     }
 113:Service/Srv_FileAdapter.c **** }
 186              		.loc 1 113 1 view .LVU49
 187 000c 7047     		bx	lr
 188              	.L13:
 109:Service/Srv_FileAdapter.c ****             default: break;
 189              		.loc 1 109 47 is_stmt 1 view .LVU50
 109:Service/Srv_FileAdapter.c ****             default: break;
 190              		.loc 1 109 97 is_stmt 0 view .LVU51
 191 000e 1161     		str	r1, [r2, #16]
 109:Service/Srv_FileAdapter.c ****             default: break;
 192              		.loc 1 109 105 is_stmt 1 view .LVU52
 193              		.loc 1 113 1 is_stmt 0 view .LVU53
 194 0010 FCE7     		b	.L11
 195              		.cfi_endproc
 196              	.LFE147:
 198              		.section	.text.SrvFileAdapter_Store_Firmware,"ax",%progbits
 199              		.align	1
 200              		.syntax unified
 201              		.thumb
 202              		.thumb_func
 204              	SrvFileAdapter_Store_Firmware:
 205              	.LVL14:
 206              	.LFB149:
 114:Service/Srv_FileAdapter.c **** 
 115:Service/Srv_FileAdapter.c **** static bool SrvFileAdapter_PushToStream(uint8_t *p_buf, uint16_t size)
 116:Service/Srv_FileAdapter.c **** {
 117:Service/Srv_FileAdapter.c ****     if (p_buf && size && (AdapterInStream.size + size <= AdapterInStream.total_size))
 118:Service/Srv_FileAdapter.c ****     {
 119:Service/Srv_FileAdapter.c ****         /* push data into adapter input stream */
 120:Service/Srv_FileAdapter.c ****         memcpy(&AdapterInStream.buf[AdapterInStream.size], p_buf, size);
 121:Service/Srv_FileAdapter.c ****         AdapterInStream.size += size;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 7


 122:Service/Srv_FileAdapter.c **** 
 123:Service/Srv_FileAdapter.c ****         return true;
 124:Service/Srv_FileAdapter.c ****     }
 125:Service/Srv_FileAdapter.c **** 
 126:Service/Srv_FileAdapter.c ****     return false;
 127:Service/Srv_FileAdapter.c **** }
 128:Service/Srv_FileAdapter.c **** 
 129:Service/Srv_FileAdapter.c **** static Adapter_Polling_State SrvFileAdapter_Store_Firmware(SrvFileAdapterObj_TypeDef *p_Adapter, ui
 130:Service/Srv_FileAdapter.c **** {
 207              		.loc 1 130 1 is_stmt 1 view -0
 208              		.cfi_startproc
 209              		@ args = 0, pretend = 0, frame = 0
 210              		@ frame_needed = 0, uses_anonymous_args = 0
 131:Service/Srv_FileAdapter.c ****     uint32_t max_file_size = 0;
 211              		.loc 1 131 5 view .LVU55
 132:Service/Srv_FileAdapter.c ****     Storage_FirmwareType_List firmware_type = Firmware_None;
 212              		.loc 1 132 5 view .LVU56
 133:Service/Srv_FileAdapter.c **** 
 134:Service/Srv_FileAdapter.c ****     if ((p_Adapter == NULL) || \
 213              		.loc 1 134 5 view .LVU57
 214              		.loc 1 134 8 is_stmt 0 view .LVU58
 215 0000 68B3     		cbz	r0, .L18
 130:Service/Srv_FileAdapter.c ****     uint32_t max_file_size = 0;
 216              		.loc 1 130 1 discriminator 1 view .LVU59
 217 0002 70B5     		push	{r4, r5, r6, lr}
 218              	.LCFI4:
 219              		.cfi_def_cfa_offset 16
 220              		.cfi_offset 4, -16
 221              		.cfi_offset 5, -12
 222              		.cfi_offset 6, -8
 223              		.cfi_offset 14, -4
 224 0004 82B0     		sub	sp, sp, #8
 225              	.LCFI5:
 226              		.cfi_def_cfa_offset 24
 227 0006 0B46     		mov	r3, r1
 228 0008 1446     		mov	r4, r2
 229 000a 0546     		mov	r5, r0
 135:Service/Srv_FileAdapter.c ****         (p_Adapter->file_info.File_Type == FileType_None) || \
 230              		.loc 1 135 30 discriminator 1 view .LVU60
 231 000c 027E     		ldrb	r2, [r0, #24]	@ zero_extendqisi2
 232              	.LVL15:
 134:Service/Srv_FileAdapter.c ****         (p_Adapter->file_info.File_Type == FileType_None) || \
 233              		.loc 1 134 29 discriminator 1 view .LVU61
 234 000e 42B3     		cbz	r2, .L19
 235              		.loc 1 135 59 view .LVU62
 236 0010 022A     		cmp	r2, #2
 237 0012 28D8     		bhi	.L20
 136:Service/Srv_FileAdapter.c ****         (p_Adapter->file_info.File_Type > FileType_Boot) || \
 238              		.loc 1 136 58 view .LVU63
 239 0014 49B3     		cbz	r1, .L21
 137:Service/Srv_FileAdapter.c ****         (p_data == NULL) || \
 240              		.loc 1 137 26 view .LVU64
 241 0016 54B3     		cbz	r4, .L22
 138:Service/Srv_FileAdapter.c ****         (size == 0))
 139:Service/Srv_FileAdapter.c ****         return Adapter_Proc_Failed;
 140:Service/Srv_FileAdapter.c **** 
 141:Service/Srv_FileAdapter.c ****     if (p_Adapter->file_info.File_Type == FileType_Boot)
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 8


 242              		.loc 1 141 5 is_stmt 1 view .LVU65
 243              		.loc 1 141 8 is_stmt 0 view .LVU66
 244 0018 022A     		cmp	r2, #2
 245 001a 16D0     		beq	.L30
 142:Service/Srv_FileAdapter.c ****     {
 143:Service/Srv_FileAdapter.c ****         max_file_size = Boot_Section_Size;
 144:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_Boot;
 145:Service/Srv_FileAdapter.c ****     }
 146:Service/Srv_FileAdapter.c ****     else if (p_Adapter->file_info.File_Type == FileType_APP)
 246              		.loc 1 146 10 is_stmt 1 view .LVU67
 247              		.loc 1 146 13 is_stmt 0 view .LVU68
 248 001c 012A     		cmp	r2, #1
 249 001e 19D0     		beq	.L31
 132:Service/Srv_FileAdapter.c **** 
 250              		.loc 1 132 31 view .LVU69
 251 0020 0021     		movs	r1, #0
 252              	.LVL16:
 131:Service/Srv_FileAdapter.c ****     Storage_FirmwareType_List firmware_type = Firmware_None;
 253              		.loc 1 131 14 view .LVU70
 254 0022 0A46     		mov	r2, r1
 255              	.LVL17:
 256              	.L17:
 147:Service/Srv_FileAdapter.c ****     {
 148:Service/Srv_FileAdapter.c ****         max_file_size = App_Section_Size;
 149:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_App;
 150:Service/Srv_FileAdapter.c ****     }
 151:Service/Srv_FileAdapter.c **** 
 152:Service/Srv_FileAdapter.c ****     /* check received file size */
 153:Service/Srv_FileAdapter.c ****     if (p_Adapter->file_info.File_Size >= max_file_size)
 257              		.loc 1 153 5 is_stmt 1 view .LVU71
 258              		.loc 1 153 29 is_stmt 0 view .LVU72
 259 0024 286A     		ldr	r0, [r5, #32]
 260              	.LVL18:
 261              		.loc 1 153 8 view .LVU73
 262 0026 9042     		cmp	r0, r2
 263 0028 23D2     		bcs	.L24
 154:Service/Srv_FileAdapter.c ****         /* abort file receive */
 155:Service/Srv_FileAdapter.c ****         return Adapter_Proc_Failed;
 156:Service/Srv_FileAdapter.c ****     
 157:Service/Srv_FileAdapter.c ****     /* write stream data to storage section */
 158:Service/Srv_FileAdapter.c ****     if (!Storage.write_firmware(External_Flash, firmware_type, p_Adapter->store_addr_offset, p_data
 264              		.loc 1 158 5 is_stmt 1 view .LVU74
 265              		.loc 1 158 17 is_stmt 0 view .LVU75
 266 002a 144A     		ldr	r2, .L32
 267              	.LVL19:
 268              		.loc 1 158 17 view .LVU76
 269 002c D66A     		ldr	r6, [r2, #44]
 270              		.loc 1 158 10 view .LVU77
 271 002e 0094     		str	r4, [sp]
 272 0030 6A6A     		ldr	r2, [r5, #36]
 273 0032 0120     		movs	r0, #1
 274 0034 B047     		blx	r6
 275              	.LVL20:
 276              		.loc 1 158 8 view .LVU78
 277 0036 F0B1     		cbz	r0, .L25
 159:Service/Srv_FileAdapter.c ****         return Adapter_Proc_Failed;
 160:Service/Srv_FileAdapter.c **** 
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 9


 161:Service/Srv_FileAdapter.c ****     p_Adapter->file_info.File_Size += size;
 278              		.loc 1 161 5 is_stmt 1 view .LVU79
 279              		.loc 1 161 36 is_stmt 0 view .LVU80
 280 0038 2B6A     		ldr	r3, [r5, #32]
 281 003a 2344     		add	r3, r3, r4
 282 003c 2B62     		str	r3, [r5, #32]
 162:Service/Srv_FileAdapter.c ****     p_Adapter->store_addr_offset += size;
 283              		.loc 1 162 5 is_stmt 1 view .LVU81
 284              		.loc 1 162 34 is_stmt 0 view .LVU82
 285 003e 6B6A     		ldr	r3, [r5, #36]
 286 0040 2344     		add	r3, r3, r4
 287 0042 6B62     		str	r3, [r5, #36]
 163:Service/Srv_FileAdapter.c ****     return Adapter_Processing;
 288              		.loc 1 163 5 is_stmt 1 view .LVU83
 289              		.loc 1 163 12 is_stmt 0 view .LVU84
 290 0044 0120     		movs	r0, #1
 291              	.L15:
 164:Service/Srv_FileAdapter.c **** }
 292              		.loc 1 164 1 view .LVU85
 293 0046 02B0     		add	sp, sp, #8
 294              	.LCFI6:
 295              		.cfi_remember_state
 296              		.cfi_def_cfa_offset 16
 297              		@ sp needed
 298 0048 70BD     		pop	{r4, r5, r6, pc}
 299              	.LVL21:
 300              	.L30:
 301              	.LCFI7:
 302              		.cfi_restore_state
 143:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_Boot;
 303              		.loc 1 143 9 is_stmt 1 view .LVU86
 143:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_Boot;
 304              		.loc 1 143 23 is_stmt 0 view .LVU87
 305 004a 0D4A     		ldr	r2, .L32+4
 306 004c 0D49     		ldr	r1, .L32+8
 307              	.LVL22:
 143:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_Boot;
 308              		.loc 1 143 23 view .LVU88
 309 004e 521A     		subs	r2, r2, r1
 310              	.LVL23:
 144:Service/Srv_FileAdapter.c ****     }
 311              		.loc 1 144 9 is_stmt 1 view .LVU89
 144:Service/Srv_FileAdapter.c ****     }
 312              		.loc 1 144 23 is_stmt 0 view .LVU90
 313 0050 0121     		movs	r1, #1
 314 0052 E7E7     		b	.L17
 315              	.LVL24:
 316              	.L31:
 148:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_App;
 317              		.loc 1 148 9 is_stmt 1 view .LVU91
 148:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_App;
 318              		.loc 1 148 23 is_stmt 0 view .LVU92
 319 0054 0C4A     		ldr	r2, .L32+12
 320 0056 0A49     		ldr	r1, .L32+4
 321              	.LVL25:
 148:Service/Srv_FileAdapter.c ****         firmware_type = Firmware_App;
 322              		.loc 1 148 23 view .LVU93
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 10


 323 0058 521A     		subs	r2, r2, r1
 324              	.LVL26:
 149:Service/Srv_FileAdapter.c ****     }
 325              		.loc 1 149 9 is_stmt 1 view .LVU94
 149:Service/Srv_FileAdapter.c ****     }
 326              		.loc 1 149 23 is_stmt 0 view .LVU95
 327 005a 0221     		movs	r1, #2
 328 005c E2E7     		b	.L17
 329              	.LVL27:
 330              	.L18:
 331              	.LCFI8:
 332              		.cfi_def_cfa_offset 0
 333              		.cfi_restore 4
 334              		.cfi_restore 5
 335              		.cfi_restore 6
 336              		.cfi_restore 14
 139:Service/Srv_FileAdapter.c **** 
 337              		.loc 1 139 16 view .LVU96
 338 005e 0320     		movs	r0, #3
 339              	.LVL28:
 340              		.loc 1 164 1 view .LVU97
 341 0060 7047     		bx	lr
 342              	.LVL29:
 343              	.L19:
 344              	.LCFI9:
 345              		.cfi_def_cfa_offset 24
 346              		.cfi_offset 4, -16
 347              		.cfi_offset 5, -12
 348              		.cfi_offset 6, -8
 349              		.cfi_offset 14, -4
 139:Service/Srv_FileAdapter.c **** 
 350              		.loc 1 139 16 view .LVU98
 351 0062 0320     		movs	r0, #3
 352              	.LVL30:
 139:Service/Srv_FileAdapter.c **** 
 353              		.loc 1 139 16 view .LVU99
 354 0064 EFE7     		b	.L15
 355              	.LVL31:
 356              	.L20:
 139:Service/Srv_FileAdapter.c **** 
 357              		.loc 1 139 16 view .LVU100
 358 0066 0320     		movs	r0, #3
 359              	.LVL32:
 139:Service/Srv_FileAdapter.c **** 
 360              		.loc 1 139 16 view .LVU101
 361 0068 EDE7     		b	.L15
 362              	.LVL33:
 363              	.L21:
 139:Service/Srv_FileAdapter.c **** 
 364              		.loc 1 139 16 view .LVU102
 365 006a 0320     		movs	r0, #3
 366              	.LVL34:
 139:Service/Srv_FileAdapter.c **** 
 367              		.loc 1 139 16 view .LVU103
 368 006c EBE7     		b	.L15
 369              	.LVL35:
 370              	.L22:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 11


 139:Service/Srv_FileAdapter.c **** 
 371              		.loc 1 139 16 view .LVU104
 372 006e 0320     		movs	r0, #3
 373              	.LVL36:
 139:Service/Srv_FileAdapter.c **** 
 374              		.loc 1 139 16 view .LVU105
 375 0070 E9E7     		b	.L15
 376              	.LVL37:
 377              	.L24:
 155:Service/Srv_FileAdapter.c ****     
 378              		.loc 1 155 16 view .LVU106
 379 0072 0320     		movs	r0, #3
 380 0074 E7E7     		b	.L15
 381              	.LVL38:
 382              	.L25:
 159:Service/Srv_FileAdapter.c **** 
 383              		.loc 1 159 16 view .LVU107
 384 0076 0320     		movs	r0, #3
 385 0078 E5E7     		b	.L15
 386              	.L33:
 387 007a 00BF     		.align	2
 388              	.L32:
 389 007c 00000000 		.word	Storage
 390 0080 00000000 		.word	__boot_e
 391 0084 00000000 		.word	__boot_s
 392 0088 00000000 		.word	__rom_e
 393              		.cfi_endproc
 394              	.LFE149:
 396              		.section	.text.SrvAdapter_YModem_Polling,"ax",%progbits
 397              		.align	1
 398              		.syntax unified
 399              		.thumb
 400              		.thumb_func
 402              	SrvAdapter_YModem_Polling:
 403              	.LVL39:
 404              	.LFB152:
 165:Service/Srv_FileAdapter.c **** 
 166:Service/Srv_FileAdapter.c **** static Adapter_Polling_State SrvFileAdapter_Polling(uint32_t sys_time, SrvFileAdapterObj_TypeDef *p
 167:Service/Srv_FileAdapter.c **** {
 168:Service/Srv_FileAdapter.c ****     bool clear_stream = false;
 169:Service/Srv_FileAdapter.c ****     Adapter_Polling_State state = Adapter_Idle;
 170:Service/Srv_FileAdapter.c **** 
 171:Service/Srv_FileAdapter.c ****     if (p_Adapter && p_Adapter->FrameObj && p_Adapter->FrameApi)
 172:Service/Srv_FileAdapter.c ****     {
 173:Service/Srv_FileAdapter.c ****         p_Adapter->sys_time = sys_time;
 174:Service/Srv_FileAdapter.c ****         switch ((uint8_t)p_Adapter->frame_type)
 175:Service/Srv_FileAdapter.c ****         {
 176:Service/Srv_FileAdapter.c ****             case SrvFileAdapter_Frame_YModem:
 177:Service/Srv_FileAdapter.c ****                 state = SrvAdapter_YModem_Polling(p_Adapter, &clear_stream);
 178:Service/Srv_FileAdapter.c ****                 break;
 179:Service/Srv_FileAdapter.c **** 
 180:Service/Srv_FileAdapter.c ****             default: break;
 181:Service/Srv_FileAdapter.c ****         }
 182:Service/Srv_FileAdapter.c ****         
 183:Service/Srv_FileAdapter.c ****         if (clear_stream)
 184:Service/Srv_FileAdapter.c ****         {
 185:Service/Srv_FileAdapter.c ****             memset(AdapterInStream.buf, 0, AdapterInStream.size);
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 12


 186:Service/Srv_FileAdapter.c ****             AdapterInStream.size = 0;
 187:Service/Srv_FileAdapter.c ****         }
 188:Service/Srv_FileAdapter.c ****     }
 189:Service/Srv_FileAdapter.c **** 
 190:Service/Srv_FileAdapter.c ****     return state;
 191:Service/Srv_FileAdapter.c **** }
 192:Service/Srv_FileAdapter.c **** 
 193:Service/Srv_FileAdapter.c **** static FileInfo_TypeDef SrvFileAdapter_GetFileInfo(SrvFileAdapterObj_TypeDef *p_Adapter)
 194:Service/Srv_FileAdapter.c **** {
 195:Service/Srv_FileAdapter.c ****     FileInfo_TypeDef FileInfo;
 196:Service/Srv_FileAdapter.c **** 
 197:Service/Srv_FileAdapter.c ****     memset(&FileInfo, 0, sizeof(FileInfo_TypeDef));
 198:Service/Srv_FileAdapter.c **** 
 199:Service/Srv_FileAdapter.c ****     if (p_Adapter)
 200:Service/Srv_FileAdapter.c ****         FileInfo = p_Adapter->file_info;
 201:Service/Srv_FileAdapter.c **** 
 202:Service/Srv_FileAdapter.c ****     return FileInfo;
 203:Service/Srv_FileAdapter.c **** }
 204:Service/Srv_FileAdapter.c **** 
 205:Service/Srv_FileAdapter.c **** /******************************************************************* YModem API *******************
 206:Service/Srv_FileAdapter.c **** static Adapter_Polling_State SrvAdapter_YModem_Polling(SrvFileAdapterObj_TypeDef *p_Adapter, bool *
 207:Service/Srv_FileAdapter.c **** {
 405              		.loc 1 207 1 is_stmt 1 view -0
 406              		.cfi_startproc
 407              		@ args = 0, pretend = 0, frame = 0
 408              		@ frame_needed = 0, uses_anonymous_args = 0
 409              		.loc 1 207 1 is_stmt 0 view .LVU109
 410 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 411              	.LCFI10:
 412              		.cfi_def_cfa_offset 28
 413              		.cfi_offset 4, -28
 414              		.cfi_offset 5, -24
 415              		.cfi_offset 6, -20
 416              		.cfi_offset 7, -16
 417              		.cfi_offset 8, -12
 418              		.cfi_offset 9, -8
 419              		.cfi_offset 14, -4
 420 0004 83B0     		sub	sp, sp, #12
 421              	.LCFI11:
 422              		.cfi_def_cfa_offset 40
 208:Service/Srv_FileAdapter.c ****     YModem_TypeDef *p_api = NULL;
 423              		.loc 1 208 5 is_stmt 1 view .LVU110
 424              	.LVL40:
 209:Service/Srv_FileAdapter.c ****     YModemObj_TypeDef *p_obj = NULL;
 425              		.loc 1 209 5 view .LVU111
 210:Service/Srv_FileAdapter.c ****     YModem_Stream_TypeDef *p_stream = NULL;
 426              		.loc 1 210 5 view .LVU112
 211:Service/Srv_FileAdapter.c **** 
 212:Service/Srv_FileAdapter.c ****     p_api = To_YModem_Api(p_Adapter->FrameApi);
 427              		.loc 1 212 5 view .LVU113
 428              		.loc 1 212 11 is_stmt 0 view .LVU114
 429 0006 C768     		ldr	r7, [r0, #12]
 430              	.LVL41:
 213:Service/Srv_FileAdapter.c ****     p_obj =  To_YModem_Obj(p_Adapter->FrameObj);
 431              		.loc 1 213 5 is_stmt 1 view .LVU115
 432              		.loc 1 213 11 is_stmt 0 view .LVU116
 433 0008 D0F80880 		ldr	r8, [r0, #8]
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 13


 434              	.LVL42:
 214:Service/Srv_FileAdapter.c ****     p_stream = To_YModem_Stream(p_Adapter->stream_out);
 435              		.loc 1 214 5 is_stmt 1 view .LVU117
 436              		.loc 1 214 14 is_stmt 0 view .LVU118
 437 000c D0F81490 		ldr	r9, [r0, #20]
 438              	.LVL43:
 215:Service/Srv_FileAdapter.c **** 
 216:Service/Srv_FileAdapter.c ****     if (p_Adapter && p_api && p_obj && clear_stream && p_api->polling)
 439              		.loc 1 216 5 is_stmt 1 view .LVU119
 440              		.loc 1 216 8 is_stmt 0 view .LVU120
 441 0010 0028     		cmp	r0, #0
 442 0012 70D0     		beq	.L43
 443 0014 0446     		mov	r4, r0
 444 0016 0E46     		mov	r6, r1
 445              		.loc 1 216 19 discriminator 1 view .LVU121
 446 0018 002F     		cmp	r7, #0
 447 001a 6ED0     		beq	.L44
 448              		.loc 1 216 28 discriminator 2 view .LVU122
 449 001c B8F1000F 		cmp	r8, #0
 450 0020 6DD0     		beq	.L45
 451              		.loc 1 216 37 discriminator 3 view .LVU123
 452 0022 0029     		cmp	r1, #0
 453 0024 6DD0     		beq	.L46
 454              		.loc 1 216 61 discriminator 4 view .LVU124
 455 0026 3B68     		ldr	r3, [r7]
 456              		.loc 1 216 53 discriminator 4 view .LVU125
 457 0028 002B     		cmp	r3, #0
 458 002a 6CD0     		beq	.L47
 217:Service/Srv_FileAdapter.c ****     {
 218:Service/Srv_FileAdapter.c ****         *clear_stream = false;
 459              		.loc 1 218 9 is_stmt 1 view .LVU126
 460              		.loc 1 218 23 is_stmt 0 view .LVU127
 461 002c 0023     		movs	r3, #0
 462 002e 0B70     		strb	r3, [r1]
 219:Service/Srv_FileAdapter.c ****         if (p_Adapter->stream_out == NULL)
 463              		.loc 1 219 9 is_stmt 1 view .LVU128
 464              		.loc 1 219 22 is_stmt 0 view .LVU129
 465 0030 4369     		ldr	r3, [r0, #20]
 466              		.loc 1 219 12 view .LVU130
 467 0032 A3B1     		cbz	r3, .L50
 468              	.LVL44:
 469              	.L36:
 220:Service/Srv_FileAdapter.c ****         {
 221:Service/Srv_FileAdapter.c ****             p_Adapter->stream_out = SrvOsCommon.malloc(YModem_Stream_Size);
 222:Service/Srv_FileAdapter.c ****             if (p_Adapter->stream_out == NULL)
 223:Service/Srv_FileAdapter.c ****             {
 224:Service/Srv_FileAdapter.c ****                 SrvOsCommon.free(p_Adapter->stream_out);
 225:Service/Srv_FileAdapter.c ****                 return Adapter_Proc_Failed;
 226:Service/Srv_FileAdapter.c ****             }
 227:Service/Srv_FileAdapter.c ****         }
 228:Service/Srv_FileAdapter.c **** 
 229:Service/Srv_FileAdapter.c ****         switch (p_api->polling(p_Adapter->sys_time, p_obj, AdapterInStream.buf, AdapterInStream.siz
 470              		.loc 1 229 9 is_stmt 1 view .LVU131
 471              		.loc 1 229 22 is_stmt 0 view .LVU132
 472 0034 3D68     		ldr	r5, [r7]
 473              		.loc 1 229 17 view .LVU133
 474 0036 354A     		ldr	r2, .L55
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 14


 475 0038 CDF80090 		str	r9, [sp]
 476 003c B2F80038 		ldrh	r3, [r2, #2048]
 477 0040 4146     		mov	r1, r8
 478 0042 2068     		ldr	r0, [r4]
 479 0044 A847     		blx	r5
 480              	.LVL45:
 481 0046 0546     		mov	r5, r0
 482              		.loc 1 229 9 view .LVU134
 483 0048 0228     		cmp	r0, #2
 484 004a 14D0     		beq	.L37
 485 004c 0328     		cmp	r0, #3
 486 004e 48D0     		beq	.L38
 487 0050 0128     		cmp	r0, #1
 488 0052 00D0     		beq	.L35
 489 0054 0325     		movs	r5, #3
 490              	.LVL46:
 491              	.L35:
 230:Service/Srv_FileAdapter.c ****         {
 231:Service/Srv_FileAdapter.c ****             case YModem_State_Tx: return Adapter_Processing;
 232:Service/Srv_FileAdapter.c **** 
 233:Service/Srv_FileAdapter.c ****             case YModem_State_Rx:
 234:Service/Srv_FileAdapter.c ****                 if (p_stream->valid == YModem_Pack_InCompelete)
 235:Service/Srv_FileAdapter.c ****                     return Adapter_Processing;
 236:Service/Srv_FileAdapter.c **** 
 237:Service/Srv_FileAdapter.c ****                 if ((p_stream->valid == YModem_Pack_Compelete) && \
 238:Service/Srv_FileAdapter.c ****                     p_stream->p_buf && \
 239:Service/Srv_FileAdapter.c ****                     (p_stream->size > 1) && \
 240:Service/Srv_FileAdapter.c ****                     p_stream->file_data)
 241:Service/Srv_FileAdapter.c ****                 {
 242:Service/Srv_FileAdapter.c ****                     if (SrvFileAdapter_Store_Firmware(p_Adapter, p_stream->p_buf, p_stream->size) =
 243:Service/Srv_FileAdapter.c ****                     {
 244:Service/Srv_FileAdapter.c ****                         /* abort YModem */
 245:Service/Srv_FileAdapter.c ****                         /* clear app storage section */
 246:Service/Srv_FileAdapter.c ****                         p_api->abort(p_obj);
 247:Service/Srv_FileAdapter.c ****                         if (p_Adapter->file_info.File_Type == FileType_APP)
 248:Service/Srv_FileAdapter.c ****                         {
 249:Service/Srv_FileAdapter.c ****                             Storage.format_firmware(Firmware_App);
 250:Service/Srv_FileAdapter.c ****                         }
 251:Service/Srv_FileAdapter.c ****                         else if (p_Adapter->file_info.File_Type == FileType_Boot)
 252:Service/Srv_FileAdapter.c ****                             Storage.format_firmware(Firmware_Boot);
 253:Service/Srv_FileAdapter.c **** 
 254:Service/Srv_FileAdapter.c ****                         *clear_stream = true;
 255:Service/Srv_FileAdapter.c ****                         return Adapter_Proc_Failed;
 256:Service/Srv_FileAdapter.c ****                     }
 257:Service/Srv_FileAdapter.c ****                             
 258:Service/Srv_FileAdapter.c ****                     p_stream->size = 0;
 259:Service/Srv_FileAdapter.c ****                     p_stream->valid = YModem_Pack_Default;
 260:Service/Srv_FileAdapter.c ****                 }
 261:Service/Srv_FileAdapter.c **** 
 262:Service/Srv_FileAdapter.c ****                 *clear_stream = true;
 263:Service/Srv_FileAdapter.c ****                 return Adapter_Processing;
 264:Service/Srv_FileAdapter.c **** 
 265:Service/Srv_FileAdapter.c ****             case YModem_State_Finish:
 266:Service/Srv_FileAdapter.c ****                 SrvOsCommon.free(p_Adapter->stream_out);
 267:Service/Srv_FileAdapter.c ****                 p_Adapter->stream_out = NULL;
 268:Service/Srv_FileAdapter.c ****                 *clear_stream = true;
 269:Service/Srv_FileAdapter.c ****                 return Adapter_Proc_Done;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 15


 270:Service/Srv_FileAdapter.c **** 
 271:Service/Srv_FileAdapter.c ****             case YModem_State_Error:
 272:Service/Srv_FileAdapter.c ****             default: break;
 273:Service/Srv_FileAdapter.c ****         }
 274:Service/Srv_FileAdapter.c ****     }
 275:Service/Srv_FileAdapter.c **** 
 276:Service/Srv_FileAdapter.c ****     return Adapter_Proc_Failed;
 277:Service/Srv_FileAdapter.c **** }
 492              		.loc 1 277 1 view .LVU135
 493 0056 2846     		mov	r0, r5
 494 0058 03B0     		add	sp, sp, #12
 495              	.LCFI12:
 496              		.cfi_remember_state
 497              		.cfi_def_cfa_offset 28
 498              		@ sp needed
 499 005a BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 500              	.LVL47:
 501              	.L50:
 502              	.LCFI13:
 503              		.cfi_restore_state
 221:Service/Srv_FileAdapter.c ****             if (p_Adapter->stream_out == NULL)
 504              		.loc 1 221 13 is_stmt 1 view .LVU136
 221:Service/Srv_FileAdapter.c ****             if (p_Adapter->stream_out == NULL)
 505              		.loc 1 221 48 is_stmt 0 view .LVU137
 506 005e 2C4B     		ldr	r3, .L55+4
 507 0060 9B6A     		ldr	r3, [r3, #40]
 221:Service/Srv_FileAdapter.c ****             if (p_Adapter->stream_out == NULL)
 508              		.loc 1 221 37 view .LVU138
 509 0062 0C20     		movs	r0, #12
 510              	.LVL48:
 221:Service/Srv_FileAdapter.c ****             if (p_Adapter->stream_out == NULL)
 511              		.loc 1 221 37 view .LVU139
 512 0064 9847     		blx	r3
 513              	.LVL49:
 221:Service/Srv_FileAdapter.c ****             if (p_Adapter->stream_out == NULL)
 514              		.loc 1 221 35 view .LVU140
 515 0066 6061     		str	r0, [r4, #20]
 222:Service/Srv_FileAdapter.c ****             {
 516              		.loc 1 222 13 is_stmt 1 view .LVU141
 222:Service/Srv_FileAdapter.c ****             {
 517              		.loc 1 222 16 is_stmt 0 view .LVU142
 518 0068 0028     		cmp	r0, #0
 519 006a E3D1     		bne	.L36
 224:Service/Srv_FileAdapter.c ****                 return Adapter_Proc_Failed;
 520              		.loc 1 224 17 is_stmt 1 view .LVU143
 224:Service/Srv_FileAdapter.c ****                 return Adapter_Proc_Failed;
 521              		.loc 1 224 28 is_stmt 0 view .LVU144
 522 006c 284B     		ldr	r3, .L55+4
 523 006e DB6A     		ldr	r3, [r3, #44]
 224:Service/Srv_FileAdapter.c ****                 return Adapter_Proc_Failed;
 524              		.loc 1 224 17 view .LVU145
 525 0070 9847     		blx	r3
 526              	.LVL50:
 225:Service/Srv_FileAdapter.c ****             }
 527              		.loc 1 225 17 is_stmt 1 view .LVU146
 225:Service/Srv_FileAdapter.c ****             }
 528              		.loc 1 225 24 is_stmt 0 view .LVU147
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 16


 529 0072 0325     		movs	r5, #3
 530 0074 EFE7     		b	.L35
 531              	.L37:
 234:Service/Srv_FileAdapter.c ****                     return Adapter_Processing;
 532              		.loc 1 234 17 is_stmt 1 view .LVU148
 234:Service/Srv_FileAdapter.c ****                     return Adapter_Processing;
 533              		.loc 1 234 29 is_stmt 0 view .LVU149
 534 0076 99F80850 		ldrb	r5, [r9, #8]	@ zero_extendqisi2
 234:Service/Srv_FileAdapter.c ****                     return Adapter_Processing;
 535              		.loc 1 234 20 view .LVU150
 536 007a 012D     		cmp	r5, #1
 537 007c EBD0     		beq	.L35
 237:Service/Srv_FileAdapter.c ****                     p_stream->p_buf && \
 538              		.loc 1 237 17 is_stmt 1 view .LVU151
 237:Service/Srv_FileAdapter.c ****                     p_stream->p_buf && \
 539              		.loc 1 237 20 is_stmt 0 view .LVU152
 540 007e 022D     		cmp	r5, #2
 541 0080 09D1     		bne	.L39
 238:Service/Srv_FileAdapter.c ****                     (p_stream->size > 1) && \
 542              		.loc 1 238 29 discriminator 1 view .LVU153
 543 0082 D9F80410 		ldr	r1, [r9, #4]
 237:Service/Srv_FileAdapter.c ****                     p_stream->p_buf && \
 544              		.loc 1 237 64 discriminator 1 view .LVU154
 545 0086 31B1     		cbz	r1, .L39
 239:Service/Srv_FileAdapter.c ****                     p_stream->file_data)
 546              		.loc 1 239 30 view .LVU155
 547 0088 D9F80020 		ldr	r2, [r9]
 238:Service/Srv_FileAdapter.c ****                     (p_stream->size > 1) && \
 548              		.loc 1 238 37 view .LVU156
 549 008c 012A     		cmp	r2, #1
 550 008e 02D9     		bls	.L39
 240:Service/Srv_FileAdapter.c ****                 {
 551              		.loc 1 240 29 view .LVU157
 552 0090 99F80930 		ldrb	r3, [r9, #9]	@ zero_extendqisi2
 239:Service/Srv_FileAdapter.c ****                     p_stream->file_data)
 553              		.loc 1 239 42 view .LVU158
 554 0094 13B9     		cbnz	r3, .L51
 555              	.L39:
 262:Service/Srv_FileAdapter.c ****                 return Adapter_Processing;
 556              		.loc 1 262 17 is_stmt 1 view .LVU159
 262:Service/Srv_FileAdapter.c ****                 return Adapter_Processing;
 557              		.loc 1 262 31 is_stmt 0 view .LVU160
 558 0096 0125     		movs	r5, #1
 559 0098 3570     		strb	r5, [r6]
 263:Service/Srv_FileAdapter.c **** 
 560              		.loc 1 263 17 is_stmt 1 view .LVU161
 263:Service/Srv_FileAdapter.c **** 
 561              		.loc 1 263 24 is_stmt 0 view .LVU162
 562 009a DCE7     		b	.L35
 563              	.L51:
 242:Service/Srv_FileAdapter.c ****                     {
 564              		.loc 1 242 21 is_stmt 1 view .LVU163
 242:Service/Srv_FileAdapter.c ****                     {
 565              		.loc 1 242 25 is_stmt 0 view .LVU164
 566 009c 92B2     		uxth	r2, r2
 567 009e 2046     		mov	r0, r4
 568 00a0 FFF7FEFF 		bl	SrvFileAdapter_Store_Firmware
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 17


 569              	.LVL51:
 570 00a4 0546     		mov	r5, r0
 242:Service/Srv_FileAdapter.c ****                     {
 571              		.loc 1 242 24 view .LVU165
 572 00a6 0328     		cmp	r0, #3
 573 00a8 06D0     		beq	.L52
 258:Service/Srv_FileAdapter.c ****                     p_stream->valid = YModem_Pack_Default;
 574              		.loc 1 258 21 is_stmt 1 view .LVU166
 258:Service/Srv_FileAdapter.c ****                     p_stream->valid = YModem_Pack_Default;
 575              		.loc 1 258 36 is_stmt 0 view .LVU167
 576 00aa 0023     		movs	r3, #0
 577 00ac C9F80030 		str	r3, [r9]
 259:Service/Srv_FileAdapter.c ****                 }
 578              		.loc 1 259 21 is_stmt 1 view .LVU168
 259:Service/Srv_FileAdapter.c ****                 }
 579              		.loc 1 259 37 is_stmt 0 view .LVU169
 580 00b0 0323     		movs	r3, #3
 581 00b2 89F80830 		strb	r3, [r9, #8]
 582 00b6 EEE7     		b	.L39
 583              	.L52:
 246:Service/Srv_FileAdapter.c ****                         if (p_Adapter->file_info.File_Type == FileType_APP)
 584              		.loc 1 246 25 is_stmt 1 view .LVU170
 246:Service/Srv_FileAdapter.c ****                         if (p_Adapter->file_info.File_Type == FileType_APP)
 585              		.loc 1 246 30 is_stmt 0 view .LVU171
 586 00b8 7B68     		ldr	r3, [r7, #4]
 246:Service/Srv_FileAdapter.c ****                         if (p_Adapter->file_info.File_Type == FileType_APP)
 587              		.loc 1 246 25 view .LVU172
 588 00ba 4046     		mov	r0, r8
 589 00bc 9847     		blx	r3
 590              	.LVL52:
 247:Service/Srv_FileAdapter.c ****                         {
 591              		.loc 1 247 25 is_stmt 1 view .LVU173
 247:Service/Srv_FileAdapter.c ****                         {
 592              		.loc 1 247 49 is_stmt 0 view .LVU174
 593 00be 237E     		ldrb	r3, [r4, #24]	@ zero_extendqisi2
 247:Service/Srv_FileAdapter.c ****                         {
 594              		.loc 1 247 28 view .LVU175
 595 00c0 012B     		cmp	r3, #1
 596 00c2 04D0     		beq	.L53
 251:Service/Srv_FileAdapter.c ****                             Storage.format_firmware(Firmware_Boot);
 597              		.loc 1 251 30 is_stmt 1 view .LVU176
 251:Service/Srv_FileAdapter.c ****                             Storage.format_firmware(Firmware_Boot);
 598              		.loc 1 251 33 is_stmt 0 view .LVU177
 599 00c4 022B     		cmp	r3, #2
 600 00c6 07D0     		beq	.L54
 601              	.L42:
 254:Service/Srv_FileAdapter.c ****                         return Adapter_Proc_Failed;
 602              		.loc 1 254 25 is_stmt 1 view .LVU178
 254:Service/Srv_FileAdapter.c ****                         return Adapter_Proc_Failed;
 603              		.loc 1 254 39 is_stmt 0 view .LVU179
 604 00c8 0123     		movs	r3, #1
 605 00ca 3370     		strb	r3, [r6]
 255:Service/Srv_FileAdapter.c ****                     }
 606              		.loc 1 255 25 is_stmt 1 view .LVU180
 255:Service/Srv_FileAdapter.c ****                     }
 607              		.loc 1 255 32 is_stmt 0 view .LVU181
 608 00cc C3E7     		b	.L35
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 18


 609              	.L53:
 249:Service/Srv_FileAdapter.c ****                         }
 610              		.loc 1 249 29 is_stmt 1 view .LVU182
 249:Service/Srv_FileAdapter.c ****                         }
 611              		.loc 1 249 36 is_stmt 0 view .LVU183
 612 00ce 114B     		ldr	r3, .L55+8
 613 00d0 5B6A     		ldr	r3, [r3, #36]
 249:Service/Srv_FileAdapter.c ****                         }
 614              		.loc 1 249 29 view .LVU184
 615 00d2 0220     		movs	r0, #2
 616 00d4 9847     		blx	r3
 617              	.LVL53:
 618 00d6 F7E7     		b	.L42
 619              	.L54:
 252:Service/Srv_FileAdapter.c **** 
 620              		.loc 1 252 29 is_stmt 1 view .LVU185
 252:Service/Srv_FileAdapter.c **** 
 621              		.loc 1 252 36 is_stmt 0 view .LVU186
 622 00d8 0E4B     		ldr	r3, .L55+8
 623 00da 5B6A     		ldr	r3, [r3, #36]
 252:Service/Srv_FileAdapter.c **** 
 624              		.loc 1 252 29 view .LVU187
 625 00dc 0120     		movs	r0, #1
 626 00de 9847     		blx	r3
 627              	.LVL54:
 628 00e0 F2E7     		b	.L42
 629              	.L38:
 266:Service/Srv_FileAdapter.c ****                 p_Adapter->stream_out = NULL;
 630              		.loc 1 266 17 is_stmt 1 view .LVU188
 266:Service/Srv_FileAdapter.c ****                 p_Adapter->stream_out = NULL;
 631              		.loc 1 266 28 is_stmt 0 view .LVU189
 632 00e2 0B4B     		ldr	r3, .L55+4
 633 00e4 DB6A     		ldr	r3, [r3, #44]
 266:Service/Srv_FileAdapter.c ****                 p_Adapter->stream_out = NULL;
 634              		.loc 1 266 17 view .LVU190
 635 00e6 6069     		ldr	r0, [r4, #20]
 636 00e8 9847     		blx	r3
 637              	.LVL55:
 267:Service/Srv_FileAdapter.c ****                 *clear_stream = true;
 638              		.loc 1 267 17 is_stmt 1 view .LVU191
 267:Service/Srv_FileAdapter.c ****                 *clear_stream = true;
 639              		.loc 1 267 39 is_stmt 0 view .LVU192
 640 00ea 0023     		movs	r3, #0
 641 00ec 6361     		str	r3, [r4, #20]
 268:Service/Srv_FileAdapter.c ****                 return Adapter_Proc_Done;
 642              		.loc 1 268 17 is_stmt 1 view .LVU193
 268:Service/Srv_FileAdapter.c ****                 return Adapter_Proc_Done;
 643              		.loc 1 268 31 is_stmt 0 view .LVU194
 644 00ee 0123     		movs	r3, #1
 645 00f0 3370     		strb	r3, [r6]
 269:Service/Srv_FileAdapter.c **** 
 646              		.loc 1 269 17 is_stmt 1 view .LVU195
 269:Service/Srv_FileAdapter.c **** 
 647              		.loc 1 269 24 is_stmt 0 view .LVU196
 648 00f2 0225     		movs	r5, #2
 649 00f4 AFE7     		b	.L35
 650              	.LVL56:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 19


 651              	.L43:
 276:Service/Srv_FileAdapter.c **** }
 652              		.loc 1 276 12 view .LVU197
 653 00f6 0325     		movs	r5, #3
 654 00f8 ADE7     		b	.L35
 655              	.L44:
 276:Service/Srv_FileAdapter.c **** }
 656              		.loc 1 276 12 view .LVU198
 657 00fa 0325     		movs	r5, #3
 658 00fc ABE7     		b	.L35
 659              	.L45:
 660 00fe 0325     		movs	r5, #3
 661 0100 A9E7     		b	.L35
 662              	.L46:
 663 0102 0325     		movs	r5, #3
 664 0104 A7E7     		b	.L35
 665              	.L47:
 666 0106 0325     		movs	r5, #3
 667 0108 A5E7     		b	.L35
 668              	.L56:
 669 010a 00BF     		.align	2
 670              	.L55:
 671 010c 00000000 		.word	.LANCHOR0
 672 0110 00000000 		.word	SrvOsCommon
 673 0114 00000000 		.word	Storage
 674              		.cfi_endproc
 675              	.LFE152:
 677              		.section	.text.SrvFileAdapter_GetFileInfo,"ax",%progbits
 678              		.align	1
 679              		.syntax unified
 680              		.thumb
 681              		.thumb_func
 683              	SrvFileAdapter_GetFileInfo:
 684              	.LVL57:
 685              	.LFB151:
 194:Service/Srv_FileAdapter.c ****     FileInfo_TypeDef FileInfo;
 686              		.loc 1 194 1 is_stmt 1 view -0
 687              		.cfi_startproc
 688              		@ args = 0, pretend = 0, frame = 16
 689              		@ frame_needed = 0, uses_anonymous_args = 0
 690              		@ link register save eliminated.
 194:Service/Srv_FileAdapter.c ****     FileInfo_TypeDef FileInfo;
 691              		.loc 1 194 1 is_stmt 0 view .LVU200
 692 0000 84B0     		sub	sp, sp, #16
 693              	.LCFI14:
 694              		.cfi_def_cfa_offset 16
 695 0002 0346     		mov	r3, r0
 195:Service/Srv_FileAdapter.c **** 
 696              		.loc 1 195 5 is_stmt 1 view .LVU201
 197:Service/Srv_FileAdapter.c **** 
 697              		.loc 1 197 5 view .LVU202
 698 0004 0022     		movs	r2, #0
 699 0006 0192     		str	r2, [sp, #4]
 700 0008 0292     		str	r2, [sp, #8]
 701 000a 0392     		str	r2, [sp, #12]
 199:Service/Srv_FileAdapter.c ****         FileInfo = p_Adapter->file_info;
 702              		.loc 1 199 5 view .LVU203
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 20


 199:Service/Srv_FileAdapter.c ****         FileInfo = p_Adapter->file_info;
 703              		.loc 1 199 8 is_stmt 0 view .LVU204
 704 000c 31B1     		cbz	r1, .L58
 705 000e 0A46     		mov	r2, r1
 200:Service/Srv_FileAdapter.c **** 
 706              		.loc 1 200 9 is_stmt 1 view .LVU205
 200:Service/Srv_FileAdapter.c **** 
 707              		.loc 1 200 18 is_stmt 0 view .LVU206
 708 0010 1832     		adds	r2, r2, #24
 709 0012 07CA     		ldm	r2, {r0, r1, r2}
 710              	.LVL58:
 200:Service/Srv_FileAdapter.c **** 
 711              		.loc 1 200 18 view .LVU207
 712 0014 0DF1100C 		add	ip, sp, #16
 713 0018 0CE90700 		stmdb	ip, {r0, r1, r2}
 714              	.L58:
 202:Service/Srv_FileAdapter.c **** }
 715              		.loc 1 202 5 is_stmt 1 view .LVU208
 202:Service/Srv_FileAdapter.c **** }
 716              		.loc 1 202 12 is_stmt 0 view .LVU209
 717 001c 04AA     		add	r2, sp, #16
 718 001e 12E90700 		ldmdb	r2, {r0, r1, r2}
 719 0022 83E80700 		stm	r3, {r0, r1, r2}
 203:Service/Srv_FileAdapter.c **** 
 720              		.loc 1 203 1 view .LVU210
 721 0026 1846     		mov	r0, r3
 722 0028 04B0     		add	sp, sp, #16
 723              	.LCFI15:
 724              		.cfi_def_cfa_offset 0
 725              		@ sp needed
 726 002a 7047     		bx	lr
 727              		.cfi_endproc
 728              	.LFE151:
 730              		.section	.text.SrvFileAdapter_Polling,"ax",%progbits
 731              		.align	1
 732              		.syntax unified
 733              		.thumb
 734              		.thumb_func
 736              	SrvFileAdapter_Polling:
 737              	.LVL59:
 738              	.LFB150:
 167:Service/Srv_FileAdapter.c ****     bool clear_stream = false;
 739              		.loc 1 167 1 is_stmt 1 view -0
 740              		.cfi_startproc
 741              		@ args = 0, pretend = 0, frame = 8
 742              		@ frame_needed = 0, uses_anonymous_args = 0
 167:Service/Srv_FileAdapter.c ****     bool clear_stream = false;
 743              		.loc 1 167 1 is_stmt 0 view .LVU212
 744 0000 30B5     		push	{r4, r5, lr}
 745              	.LCFI16:
 746              		.cfi_def_cfa_offset 12
 747              		.cfi_offset 4, -12
 748              		.cfi_offset 5, -8
 749              		.cfi_offset 14, -4
 750 0002 83B0     		sub	sp, sp, #12
 751              	.LCFI17:
 752              		.cfi_def_cfa_offset 24
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 21


 168:Service/Srv_FileAdapter.c ****     Adapter_Polling_State state = Adapter_Idle;
 753              		.loc 1 168 5 is_stmt 1 view .LVU213
 168:Service/Srv_FileAdapter.c ****     Adapter_Polling_State state = Adapter_Idle;
 754              		.loc 1 168 10 is_stmt 0 view .LVU214
 755 0004 0023     		movs	r3, #0
 756 0006 8DF80730 		strb	r3, [sp, #7]
 169:Service/Srv_FileAdapter.c **** 
 757              		.loc 1 169 5 is_stmt 1 view .LVU215
 758              	.LVL60:
 171:Service/Srv_FileAdapter.c ****     {
 759              		.loc 1 171 5 view .LVU216
 171:Service/Srv_FileAdapter.c ****     {
 760              		.loc 1 171 8 is_stmt 0 view .LVU217
 761 000a F1B1     		cbz	r1, .L63
 762 000c 0B46     		mov	r3, r1
 171:Service/Srv_FileAdapter.c ****     {
 763              		.loc 1 171 31 discriminator 1 view .LVU218
 764 000e 8A68     		ldr	r2, [r1, #8]
 171:Service/Srv_FileAdapter.c ****     {
 765              		.loc 1 171 19 discriminator 1 view .LVU219
 766 0010 FAB1     		cbz	r2, .L64
 171:Service/Srv_FileAdapter.c ****     {
 767              		.loc 1 171 54 discriminator 2 view .LVU220
 768 0012 CA68     		ldr	r2, [r1, #12]
 171:Service/Srv_FileAdapter.c ****     {
 769              		.loc 1 171 42 discriminator 2 view .LVU221
 770 0014 FAB1     		cbz	r2, .L65
 173:Service/Srv_FileAdapter.c ****         switch ((uint8_t)p_Adapter->frame_type)
 771              		.loc 1 173 9 is_stmt 1 view .LVU222
 173:Service/Srv_FileAdapter.c ****         switch ((uint8_t)p_Adapter->frame_type)
 772              		.loc 1 173 29 is_stmt 0 view .LVU223
 773 0016 0860     		str	r0, [r1]
 174:Service/Srv_FileAdapter.c ****         {
 774              		.loc 1 174 9 is_stmt 1 view .LVU224
 174:Service/Srv_FileAdapter.c ****         {
 775              		.loc 1 174 35 is_stmt 0 view .LVU225
 776 0018 0A79     		ldrb	r2, [r1, #4]	@ zero_extendqisi2
 174:Service/Srv_FileAdapter.c ****         {
 777              		.loc 1 174 9 view .LVU226
 778 001a 012A     		cmp	r2, #1
 779 001c 0ED0     		beq	.L68
 169:Service/Srv_FileAdapter.c **** 
 780              		.loc 1 169 27 view .LVU227
 781 001e 0024     		movs	r4, #0
 782              	.LVL61:
 783              	.L62:
 183:Service/Srv_FileAdapter.c ****         {
 784              		.loc 1 183 9 is_stmt 1 view .LVU228
 183:Service/Srv_FileAdapter.c ****         {
 785              		.loc 1 183 13 is_stmt 0 view .LVU229
 786 0020 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 183:Service/Srv_FileAdapter.c ****         {
 787              		.loc 1 183 12 view .LVU230
 788 0024 93B1     		cbz	r3, .L61
 185:Service/Srv_FileAdapter.c ****             AdapterInStream.size = 0;
 789              		.loc 1 185 13 is_stmt 1 view .LVU231
 185:Service/Srv_FileAdapter.c ****             AdapterInStream.size = 0;
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 22


 790              		.loc 1 185 59 is_stmt 0 view .LVU232
 791 0026 0D4D     		ldr	r5, .L69
 185:Service/Srv_FileAdapter.c ****             AdapterInStream.size = 0;
 792              		.loc 1 185 13 view .LVU233
 793 0028 B5F80028 		ldrh	r2, [r5, #2048]
 794 002c 0021     		movs	r1, #0
 795 002e 2846     		mov	r0, r5
 796 0030 FFF7FEFF 		bl	memset
 797              	.LVL62:
 186:Service/Srv_FileAdapter.c ****         }
 798              		.loc 1 186 13 is_stmt 1 view .LVU234
 186:Service/Srv_FileAdapter.c ****         }
 799              		.loc 1 186 34 is_stmt 0 view .LVU235
 800 0034 0023     		movs	r3, #0
 801 0036 A5F80038 		strh	r3, [r5, #2048]	@ movhi
 802 003a 07E0     		b	.L61
 803              	.LVL63:
 804              	.L68:
 177:Service/Srv_FileAdapter.c ****                 break;
 805              		.loc 1 177 17 is_stmt 1 view .LVU236
 177:Service/Srv_FileAdapter.c ****                 break;
 806              		.loc 1 177 25 is_stmt 0 view .LVU237
 807 003c 0DF10701 		add	r1, sp, #7
 808              	.LVL64:
 177:Service/Srv_FileAdapter.c ****                 break;
 809              		.loc 1 177 25 view .LVU238
 810 0040 1846     		mov	r0, r3
 811              	.LVL65:
 177:Service/Srv_FileAdapter.c ****                 break;
 812              		.loc 1 177 25 view .LVU239
 813 0042 FFF7FEFF 		bl	SrvAdapter_YModem_Polling
 814              	.LVL66:
 177:Service/Srv_FileAdapter.c ****                 break;
 815              		.loc 1 177 25 view .LVU240
 816 0046 0446     		mov	r4, r0
 817              	.LVL67:
 178:Service/Srv_FileAdapter.c **** 
 818              		.loc 1 178 17 is_stmt 1 view .LVU241
 819 0048 EAE7     		b	.L62
 820              	.LVL68:
 821              	.L63:
 169:Service/Srv_FileAdapter.c **** 
 822              		.loc 1 169 27 is_stmt 0 view .LVU242
 823 004a 0024     		movs	r4, #0
 824              	.LVL69:
 825              	.L61:
 190:Service/Srv_FileAdapter.c **** }
 826              		.loc 1 190 5 is_stmt 1 view .LVU243
 191:Service/Srv_FileAdapter.c **** 
 827              		.loc 1 191 1 is_stmt 0 view .LVU244
 828 004c 2046     		mov	r0, r4
 829 004e 03B0     		add	sp, sp, #12
 830              	.LCFI18:
 831              		.cfi_remember_state
 832              		.cfi_def_cfa_offset 12
 833              		@ sp needed
 834 0050 30BD     		pop	{r4, r5, pc}
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 23


 835              	.LVL70:
 836              	.L64:
 837              	.LCFI19:
 838              		.cfi_restore_state
 169:Service/Srv_FileAdapter.c **** 
 839              		.loc 1 169 27 view .LVU245
 840 0052 0024     		movs	r4, #0
 841 0054 FAE7     		b	.L61
 842              	.L65:
 843 0056 0024     		movs	r4, #0
 844 0058 F8E7     		b	.L61
 845              	.L70:
 846 005a 00BF     		.align	2
 847              	.L69:
 848 005c 00000000 		.word	.LANCHOR0
 849              		.cfi_endproc
 850              	.LFE150:
 852              		.section	.text.SrvFileAdapter_Destory_AdapterObj,"ax",%progbits
 853              		.align	1
 854              		.syntax unified
 855              		.thumb
 856              		.thumb_func
 858              	SrvFileAdapter_Destory_AdapterObj:
 859              	.LVL71:
 860              	.LFB146:
  86:Service/Srv_FileAdapter.c ****     if (p_Adapter && p_Adapter->FrameObj)
 861              		.loc 1 86 1 is_stmt 1 view -0
 862              		.cfi_startproc
 863              		@ args = 0, pretend = 0, frame = 0
 864              		@ frame_needed = 0, uses_anonymous_args = 0
  87:Service/Srv_FileAdapter.c ****     {
 865              		.loc 1 87 5 view .LVU247
  87:Service/Srv_FileAdapter.c ****     {
 866              		.loc 1 87 8 is_stmt 0 view .LVU248
 867 0000 C8B1     		cbz	r0, .L74
  86:Service/Srv_FileAdapter.c ****     if (p_Adapter && p_Adapter->FrameObj)
 868              		.loc 1 86 1 discriminator 1 view .LVU249
 869 0002 38B5     		push	{r3, r4, r5, lr}
 870              	.LCFI20:
 871              		.cfi_def_cfa_offset 16
 872              		.cfi_offset 3, -16
 873              		.cfi_offset 4, -12
 874              		.cfi_offset 5, -8
 875              		.cfi_offset 14, -4
 876 0004 0446     		mov	r4, r0
  87:Service/Srv_FileAdapter.c ****     {
 877              		.loc 1 87 31 discriminator 1 view .LVU250
 878 0006 8068     		ldr	r0, [r0, #8]
 879              	.LVL72:
  87:Service/Srv_FileAdapter.c ****     {
 880              		.loc 1 87 19 discriminator 1 view .LVU251
 881 0008 B8B1     		cbz	r0, .L75
  89:Service/Srv_FileAdapter.c ****             memset(p_Adapter->FrameObj, 0, sizeof(YModemObj_TypeDef));
 882              		.loc 1 89 9 is_stmt 1 view .LVU252
  89:Service/Srv_FileAdapter.c ****             memset(p_Adapter->FrameObj, 0, sizeof(YModemObj_TypeDef));
 883              		.loc 1 89 22 is_stmt 0 view .LVU253
 884 000a 2379     		ldrb	r3, [r4, #4]	@ zero_extendqisi2
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 24


  89:Service/Srv_FileAdapter.c ****             memset(p_Adapter->FrameObj, 0, sizeof(YModemObj_TypeDef));
 885              		.loc 1 89 12 view .LVU254
 886 000c 012B     		cmp	r3, #1
 887 000e 0DD0     		beq	.L80
 888              	.L73:
  92:Service/Srv_FileAdapter.c ****         memset(p_Adapter, 0, sizeof(SrvFileAdapterObj_TypeDef));
 889              		.loc 1 92 9 is_stmt 1 view .LVU255
  92:Service/Srv_FileAdapter.c ****         memset(p_Adapter, 0, sizeof(SrvFileAdapterObj_TypeDef));
 890              		.loc 1 92 20 is_stmt 0 view .LVU256
 891 0010 0B4D     		ldr	r5, .L81
 892 0012 EB6A     		ldr	r3, [r5, #44]
  92:Service/Srv_FileAdapter.c ****         memset(p_Adapter, 0, sizeof(SrvFileAdapterObj_TypeDef));
 893              		.loc 1 92 9 view .LVU257
 894 0014 A068     		ldr	r0, [r4, #8]
 895 0016 9847     		blx	r3
 896              	.LVL73:
  93:Service/Srv_FileAdapter.c ****         p_Adapter->FrameApi = NULL;
 897              		.loc 1 93 9 is_stmt 1 view .LVU258
 898 0018 2822     		movs	r2, #40
 899 001a 0021     		movs	r1, #0
 900 001c 2046     		mov	r0, r4
 901 001e FFF7FEFF 		bl	memset
 902              	.LVL74:
  94:Service/Srv_FileAdapter.c ****         p_Adapter->FrameObj = NULL;
 903              		.loc 1 94 9 view .LVU259
  95:Service/Srv_FileAdapter.c ****         SrvOsCommon.free(p_Adapter);
 904              		.loc 1 95 9 view .LVU260
  96:Service/Srv_FileAdapter.c ****         return true;
 905              		.loc 1 96 9 view .LVU261
  96:Service/Srv_FileAdapter.c ****         return true;
 906              		.loc 1 96 20 is_stmt 0 view .LVU262
 907 0022 EB6A     		ldr	r3, [r5, #44]
  96:Service/Srv_FileAdapter.c ****         return true;
 908              		.loc 1 96 9 view .LVU263
 909 0024 2046     		mov	r0, r4
 910 0026 9847     		blx	r3
 911              	.LVL75:
  97:Service/Srv_FileAdapter.c ****     }
 912              		.loc 1 97 9 is_stmt 1 view .LVU264
  97:Service/Srv_FileAdapter.c ****     }
 913              		.loc 1 97 16 is_stmt 0 view .LVU265
 914 0028 0120     		movs	r0, #1
 915              	.L72:
 101:Service/Srv_FileAdapter.c **** 
 916              		.loc 1 101 1 view .LVU266
 917 002a 38BD     		pop	{r3, r4, r5, pc}
 918              	.LVL76:
 919              	.L80:
  90:Service/Srv_FileAdapter.c **** 
 920              		.loc 1 90 13 is_stmt 1 view .LVU267
 921 002c 2422     		movs	r2, #36
 922 002e 0021     		movs	r1, #0
 923 0030 FFF7FEFF 		bl	memset
 924              	.LVL77:
 925 0034 ECE7     		b	.L73
 926              	.LVL78:
 927              	.L74:
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 25


 928              	.LCFI21:
 929              		.cfi_def_cfa_offset 0
 930              		.cfi_restore 3
 931              		.cfi_restore 4
 932              		.cfi_restore 5
 933              		.cfi_restore 14
 100:Service/Srv_FileAdapter.c **** }
 934              		.loc 1 100 12 is_stmt 0 view .LVU268
 935 0036 0020     		movs	r0, #0
 936              	.LVL79:
 101:Service/Srv_FileAdapter.c **** 
 937              		.loc 1 101 1 view .LVU269
 938 0038 7047     		bx	lr
 939              	.LVL80:
 940              	.L75:
 941              	.LCFI22:
 942              		.cfi_def_cfa_offset 16
 943              		.cfi_offset 3, -16
 944              		.cfi_offset 4, -12
 945              		.cfi_offset 5, -8
 946              		.cfi_offset 14, -4
 100:Service/Srv_FileAdapter.c **** }
 947              		.loc 1 100 12 view .LVU270
 948 003a 0020     		movs	r0, #0
 949 003c F5E7     		b	.L72
 950              	.L82:
 951 003e 00BF     		.align	2
 952              	.L81:
 953 0040 00000000 		.word	SrvOsCommon
 954              		.cfi_endproc
 955              	.LFE146:
 957              		.section	.text.SrvFileAdapter_PushToStream,"ax",%progbits
 958              		.align	1
 959              		.syntax unified
 960              		.thumb
 961              		.thumb_func
 963              	SrvFileAdapter_PushToStream:
 964              	.LVL81:
 965              	.LFB148:
 116:Service/Srv_FileAdapter.c ****     if (p_buf && size && (AdapterInStream.size + size <= AdapterInStream.total_size))
 966              		.loc 1 116 1 is_stmt 1 view -0
 967              		.cfi_startproc
 968              		@ args = 0, pretend = 0, frame = 0
 969              		@ frame_needed = 0, uses_anonymous_args = 0
 117:Service/Srv_FileAdapter.c ****     {
 970              		.loc 1 117 5 view .LVU272
 117:Service/Srv_FileAdapter.c ****     {
 971              		.loc 1 117 8 is_stmt 0 view .LVU273
 972 0000 C8B1     		cbz	r0, .L85
 116:Service/Srv_FileAdapter.c ****     if (p_buf && size && (AdapterInStream.size + size <= AdapterInStream.total_size))
 973              		.loc 1 116 1 discriminator 1 view .LVU274
 974 0002 38B5     		push	{r3, r4, r5, lr}
 975              	.LCFI23:
 976              		.cfi_def_cfa_offset 16
 977              		.cfi_offset 3, -16
 978              		.cfi_offset 4, -12
 979              		.cfi_offset 5, -8
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 26


 980              		.cfi_offset 14, -4
 981 0004 0C46     		mov	r4, r1
 982 0006 0146     		mov	r1, r0
 983              	.LVL82:
 117:Service/Srv_FileAdapter.c ****     {
 984              		.loc 1 117 15 discriminator 1 view .LVU275
 985 0008 BCB1     		cbz	r4, .L86
 117:Service/Srv_FileAdapter.c ****     {
 986              		.loc 1 117 42 discriminator 2 view .LVU276
 987 000a 0D4B     		ldr	r3, .L93
 988 000c B3F80008 		ldrh	r0, [r3, #2048]
 989              	.LVL83:
 117:Service/Srv_FileAdapter.c ****     {
 990              		.loc 1 117 48 discriminator 2 view .LVU277
 991 0010 2218     		adds	r2, r4, r0
 117:Service/Srv_FileAdapter.c ****     {
 992              		.loc 1 117 73 discriminator 2 view .LVU278
 993 0012 B3F80238 		ldrh	r3, [r3, #2050]
 117:Service/Srv_FileAdapter.c ****     {
 994              		.loc 1 117 23 discriminator 2 view .LVU279
 995 0016 9A42     		cmp	r2, r3
 996 0018 01DD     		ble	.L92
 126:Service/Srv_FileAdapter.c **** }
 997              		.loc 1 126 12 view .LVU280
 998 001a 0020     		movs	r0, #0
 999 001c 0EE0     		b	.L84
 1000              	.L92:
 120:Service/Srv_FileAdapter.c ****         AdapterInStream.size += size;
 1001              		.loc 1 120 9 is_stmt 1 view .LVU281
 120:Service/Srv_FileAdapter.c ****         AdapterInStream.size += size;
 1002              		.loc 1 120 16 is_stmt 0 view .LVU282
 1003 001e 084D     		ldr	r5, .L93
 120:Service/Srv_FileAdapter.c ****         AdapterInStream.size += size;
 1004              		.loc 1 120 9 view .LVU283
 1005 0020 2246     		mov	r2, r4
 1006 0022 2844     		add	r0, r0, r5
 1007 0024 FFF7FEFF 		bl	memcpy
 1008              	.LVL84:
 121:Service/Srv_FileAdapter.c **** 
 1009              		.loc 1 121 9 is_stmt 1 view .LVU284
 121:Service/Srv_FileAdapter.c **** 
 1010              		.loc 1 121 30 is_stmt 0 view .LVU285
 1011 0028 B5F80018 		ldrh	r1, [r5, #2048]
 1012 002c 0C44     		add	r4, r4, r1
 1013 002e A5F80048 		strh	r4, [r5, #2048]	@ movhi
 123:Service/Srv_FileAdapter.c ****     }
 1014              		.loc 1 123 9 is_stmt 1 view .LVU286
 123:Service/Srv_FileAdapter.c ****     }
 1015              		.loc 1 123 16 is_stmt 0 view .LVU287
 1016 0032 0120     		movs	r0, #1
 1017 0034 02E0     		b	.L84
 1018              	.LVL85:
 1019              	.L85:
 1020              	.LCFI24:
 1021              		.cfi_def_cfa_offset 0
 1022              		.cfi_restore 3
 1023              		.cfi_restore 4
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 27


 1024              		.cfi_restore 5
 1025              		.cfi_restore 14
 126:Service/Srv_FileAdapter.c **** }
 1026              		.loc 1 126 12 view .LVU288
 1027 0036 0020     		movs	r0, #0
 1028              	.LVL86:
 127:Service/Srv_FileAdapter.c **** 
 1029              		.loc 1 127 1 view .LVU289
 1030 0038 7047     		bx	lr
 1031              	.LVL87:
 1032              	.L86:
 1033              	.LCFI25:
 1034              		.cfi_def_cfa_offset 16
 1035              		.cfi_offset 3, -16
 1036              		.cfi_offset 4, -12
 1037              		.cfi_offset 5, -8
 1038              		.cfi_offset 14, -4
 126:Service/Srv_FileAdapter.c **** }
 1039              		.loc 1 126 12 view .LVU290
 1040 003a 0020     		movs	r0, #0
 1041              	.LVL88:
 1042              	.L84:
 127:Service/Srv_FileAdapter.c **** 
 1043              		.loc 1 127 1 view .LVU291
 1044 003c 38BD     		pop	{r3, r4, r5, pc}
 1045              	.L94:
 1046 003e 00BF     		.align	2
 1047              	.L93:
 1048 0040 00000000 		.word	.LANCHOR0
 1049              		.cfi_endproc
 1050              	.LFE148:
 1052              		.global	SrvFileAdapter
 1053              		.section	.data.AdapterInStream,"aw"
 1054              		.align	2
 1055              		.set	.LANCHOR0,. + 0
 1058              	AdapterInStream:
 1059 0000 00000000 		.space	2048
 1059      00000000 
 1059      00000000 
 1059      00000000 
 1059      00000000 
 1060 0800 0000     		.short	0
 1061 0802 0008     		.short	2048
 1062              		.section	.data.SrvFileAdapter,"aw"
 1063              		.align	2
 1066              	SrvFileAdapter:
 1067 0000 00000000 		.word	SrvFileAdapter_Create_AdapterObj
 1068 0004 00000000 		.word	SrvFileAdapter_PushToStream
 1069 0008 00000000 		.word	SrvFileAdapter_Destory_AdapterObj
 1070 000c 00000000 		.word	SrvFileAdapter_Set_SendCallback
 1071 0010 00000000 		.word	SrvFileAdapter_Polling
 1072 0014 00000000 		.word	SrvFileAdapter_GetFileInfo
 1073              		.text
 1074              	.Letext0:
 1075              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1076              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1077              		.file 4 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\lib\\gcc\\arm-none-eabi\
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 28


 1078              		.file 5 "common/YModem/YModem.h"
 1079              		.file 6 "Service/Srv_FileAdapter.h"
 1080              		.file 7 "System/FreeRTOS/include/portable.h"
 1081              		.file 8 "Service/Srv_OsCommon.h"
 1082              		.file 9 "HW_Lib/AT32F435/drivers/inc/at32f435_437_tmr.h"
 1083              		.file 10 "Device/Dev_Dshot.h"
 1084              		.file 11 "common/Error_Log/../../common/gen_physic_def/imu_data.h"
 1085              		.file 12 "Service/../FCHW_Config.h"
 1086              		.file 13 "Service/control_data.h"
 1087              		.file 14 "Service/../System/storage/Storage.h"
 1088              		.file 15 "System/FreeRTOS/FreeRTOSConfig.h"
 1089              		.file 16 "<built-in>"
ARM GAS  C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s 			page 29


DEFINED SYMBOLS
                            *ABS*:00000000 Srv_FileAdapter.c
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:20     .text.SrvFileAdapter_Create_AdapterObj:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:25     .text.SrvFileAdapter_Create_AdapterObj:00000000 SrvFileAdapter_Create_AdapterObj
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:153    .text.SrvFileAdapter_Create_AdapterObj:00000064 $d
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:159    .text.SrvFileAdapter_Set_SendCallback:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:164    .text.SrvFileAdapter_Set_SendCallback:00000000 SrvFileAdapter_Set_SendCallback
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:199    .text.SrvFileAdapter_Store_Firmware:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:204    .text.SrvFileAdapter_Store_Firmware:00000000 SrvFileAdapter_Store_Firmware
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:389    .text.SrvFileAdapter_Store_Firmware:0000007c $d
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:397    .text.SrvAdapter_YModem_Polling:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:402    .text.SrvAdapter_YModem_Polling:00000000 SrvAdapter_YModem_Polling
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:671    .text.SrvAdapter_YModem_Polling:0000010c $d
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:678    .text.SrvFileAdapter_GetFileInfo:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:683    .text.SrvFileAdapter_GetFileInfo:00000000 SrvFileAdapter_GetFileInfo
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:731    .text.SrvFileAdapter_Polling:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:736    .text.SrvFileAdapter_Polling:00000000 SrvFileAdapter_Polling
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:848    .text.SrvFileAdapter_Polling:0000005c $d
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:853    .text.SrvFileAdapter_Destory_AdapterObj:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:858    .text.SrvFileAdapter_Destory_AdapterObj:00000000 SrvFileAdapter_Destory_AdapterObj
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:953    .text.SrvFileAdapter_Destory_AdapterObj:00000040 $d
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:958    .text.SrvFileAdapter_PushToStream:00000000 $t
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:963    .text.SrvFileAdapter_PushToStream:00000000 SrvFileAdapter_PushToStream
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:1048   .text.SrvFileAdapter_PushToStream:00000040 $d
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:1066   .data.SrvFileAdapter:00000000 SrvFileAdapter
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:1054   .data.AdapterInStream:00000000 $d
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:1058   .data.AdapterInStream:00000000 AdapterInStream
C:\Users\8bit\AppData\Local\Temp\ccbXvclz.s:1063   .data.SrvFileAdapter:00000000 $d

UNDEFINED SYMBOLS
SrvOsCommon
YModem
Storage
__boot_e
__boot_s
__rom_e
memset
memcpy
